Ext.define("OPF.console.directory.model.Directory",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/directory",restSuffixUrl:"directory/directory",editorClassName:"OPF.console.directory.editor.DirectoryEditor",constraintName:"OPF.directory.Directory"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"serverName",type:"string"},{name:"urlPath",type:"string"},{name:"sortPosition",type:"int"},{name:"directoryType",type:"string"},{name:"status",type:"string"},{name:"port",type:"int",useNull:true},{name:"baseDN",type:"string",useNull:true},{name:"rootDN",type:"string",useNull:true},{name:"password",type:"string",useNull:true},{name:"allowEncodedPassword",type:"boolean",useNull:true},{name:"passwordEncodingType",type:"string",useNull:true},{name:"peopleObjectclass",type:"string",useNull:true},{name:"groupsObjectclass",type:"string",useNull:true},{name:"directoryServiceTitle",type:"string"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],hasMany:{model:"OPF.console.domain.model.FieldModel",name:"directoryFields",associationKey:"directoryFields",foreignKey:"parentId"}});Ext.define("OPF.console.directory.model.Group",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/directory",restSuffixUrl:"directory/group",editorClassName:"OPF.console.directory.editor.GroupEditor",constraintName:"OPF.directory.Group"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"distinguishedName",type:"string",useNull:true},{name:"parentId",type:"int"},{name:"directory",type:"auto"}]});Ext.define("OPF.console.directory.model.SecuredEntity",{extend:Ext.data.Model,statics:{restSuffixUrl:"authority/role"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"description",type:"string"},{name:"securedRecordId",type:"int",useNull:true}],belongsTo:"User"});Ext.define("OPF.console.directory.model.SystemUserModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/directory",restSuffixUrl:"directory/system_user",editorClassName:"OPF.console.directory.editor.SystemUserEditor",constraintName:"OPF.directory.SystemUser"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"username",type:"string"},{name:"password",type:"string"},{name:"passwordConfirm",type:"string"},{name:"email",type:"string"},{name:"firstName",type:"string"},{name:"middleName",type:"string"},{name:"lastName",type:"string"},{name:"guest",type:"boolean"},{name:"registryNodeId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"roles",persist:false}],hasMany:[{model:"OPF.console.authority.model.Role",name:"roles"}]});String.prototype.startsWith=function(a){return(this.match("^"+a)==a)};String.prototype.endsWith=function(a){return this.length>=a.length&&this.substr(this.length-a.length)==a};String.prototype.trim=function(){return(this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,""))};Array.prototype.max=function(){var b=this[0];var a=this.length;for(var c=1;c<a;c++){if(this[c]>b){b=this[c]}}return b};Array.prototype.min=function(){var c=this[0];var a=this.length;for(var b=1;b<a;b++){if(this[b]<c){c=this[b]}}return c};Array.prototype.sum=function(){var c=0;var a=this.length;for(var b=0;b<a;b++){c+=this[b]}return c};Array.prototype.remove=function(c,b){var a=this.slice((b||c)+1||this.length);this.length=c<0?this.length+c:c;return this.push.apply(this,a)};Ext.define("OPF.core.utils.Config",{alternateClassName:["OPF.Cfg"],OPF_CONSOLE_URL:null,DEBUG_MODE:null,DEFAULT_LOGIN:null,DEFAULT_PASSWORD:null,CAN_EDIT_RESOURCE:null,PAGE_TYPE:null,PAGE_UID:null,BASE_URL:null,NAVIGATION_LOOKUP:null,PACKAGE_ID:null,PACKAGE_LOOKUP:null,CACHE_VERSION:null,EXTRA_PARAMS:null,DASHBOARD_PREFIX_URL:null,USER_INFO:{id:null,username:null,isLogged:false},fullUrl:function(a,c){var b;if(a.startsWith("http://")){b=a}else{b=c?this.BASE_URL:this.OPF_CONSOLE_URL;if(!a.startsWith("/")){b+="/"}b+=a}if(this.DEBUG_MODE==true){b=this.addParameterToURL(b,"debug","true")}return b},restUrl:function(a,c){var b;if(a.startsWith("http://")){b=a}else{b=b=(c?this.BASE_URL:this.OPF_CONSOLE_URL)+"/rest";if(!a.startsWith("/")){b+="/"}b+=a}return b},getBaseUrl:function(){return OPF.ifBlank(this.BASE_URL,this.OPF_CONSOLE_URL)},randomUUID:function(){var b=[],c="0123456789ABCDEF",a;for(a=0;a<36;a++){b[a]=Math.floor(Math.random()*16)}b[14]=4;b[19]=(b[19]&3)|8;for(a=0;a<36;a++){b[a]=c[b[a]]}b[8]=b[13]=b[18]=b[23]="-";return b.join("")},noCacheLoadScriptInit:function(){if(this.CACHE_VERSION!=undefined&&this.CACHE_VERSION!=null&&this.CACHE_VERSION.length>0){Ext.Loader.loadScriptFile=function(b,k,g,n,a){var j=this,o,f=b.split("/").pop(),c=false,m,d,l;if(this.getConfig("disableCaching")){o=b+"?"+this.getConfig("disableCachingParam")+"="+Ext.Date.now()+"&v="+OPF.Cfg.CACHE_VERSION}else{o=b+"?v="+OPF.Cfg.CACHE_VERSION}n=n||this;this.isLoading=true;if(!a){l=function(){g.call(n,"Failed loading '"+b+"', please verify that the file exists",a)};if(!Ext.isReady&&Ext.onDocumentReady){Ext.onDocumentReady(function(){j.injectScriptElement(o,k,l,n)})}else{this.injectScriptElement(o,k,l,n)}}else{if(typeof XMLHttpRequest!=="undefined"){m=new XMLHttpRequest()}else{m=new ActiveXObject("Microsoft.XMLHTTP")}try{m.open("GET",o,false);m.send(null)}catch(h){c=true}d=(m.status===1223)?204:m.status;if(!c){c=(d===0)}if(c){g.call(this,"Failed loading synchronously via XHR: '"+b+"'; It's likely that the file is either being loaded from a different domain or from the local file system whereby cross origin requests are not allowed due to security reasons. Use asynchronous loading with Ext.require instead.",a)}else{if(d>=200&&d<300){new Function(m.responseText+"\n//@ sourceURL="+f)();k.call(n)}else{g.call(this,"Failed loading synchronously via XHR: '"+b+"'; please verify that the file exists. XHR status code: "+d,a)}}m=null}}}},addParameterToURL:function(b,d,e){var f=d+"="+encodeURIComponent(e);var a="&";if(b.indexOf("?")<0){a="?"}else{var c=b.slice(-1);if(c=="&"){a=""}if(c=="?"){a=""}}b+=a+f;return b}});OPF.Cfg=new OPF.core.utils.Config();OPF.Cfg.PAGE_UID=OPF.Cfg.randomUUID();Ext.define("OPF.console.directory.model.UserModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/directory",restSuffixUrl:OPF.Cfg.restUrl("directory/user",false),editorClassName:"OPF.console.directory.editor.UserEditor",constraintName:"OPF.directory.User"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"username",type:"string",fieldType:"NAME"},{name:"password",type:"string"},{name:"passwordConfirm",type:"string"},{name:"email",type:"string",fieldType:"NAME"},{name:"firstName",type:"string",fieldType:"NAME"},{name:"middleName",type:"string"},{name:"lastName",type:"string",fieldType:"NAME"},{name:"guest",type:"boolean"},{name:"registryNodeId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"roles",persist:false}],associations:[{type:"hasMany",model:"OPF.console.authority.model.Role",name:"userRoles",associatedName:"userRoles",foreignKey:"id"}]});Ext.define("OPF.console.directory.model.UserProfileFieldGroup",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/directory",restSuffixUrl:"directory/user_profile_field_group",constraintName:"OPF.directory.UserProfileFieldGroup"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.directory.model.UserProfileField",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/directory",restSuffixUrl:"directory/user_profile_field",constraintName:"OPF.directory.UserProfileField"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"userProfileFieldGroupId",type:"int"},{name:"fieldType",type:"string"},{name:"fieldTypeName",type:"string",persist:false},{name:"created",type:"int",persist:false},{name:"canUpdate",type:"boolean",persist:false},{name:"canDelete",type:"boolean",persist:false}]});Ext.define("OPF.console.directory.model.UserProfileFieldTree",{extend:Ext.data.Model,idProperty:"nodeId",fields:[{name:"id",type:"string",mapping:"nodeId",persist:false},{name:"realId",type:"int",mapping:"id",persist:false},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"type",type:"string"},{name:"parentId",type:"int"},{name:"userProfileFieldGroupId",type:"int"},{name:"fieldType",type:"string"},{name:"fieldTypeName",type:"string",persist:false},{name:"created",type:"int",persist:false},{name:"canUpdate",type:"boolean",persist:false},{name:"canDelete",type:"boolean",persist:false},{name:"text",type:"string",convert:function(b,a){return ifBlank(b,a.get("name"))}},{name:"icon",type:"string"},{name:"cls",type:"string"},{name:"iconCls",type:"string",convert:function(b,a){return ifBlank(b,"tricon-"+a.get("type").toLowerCase())}},{name:"leaf",type:"boolean"},{name:"allowDrag",type:"boolean"},{name:"allowDrop",type:"boolean"},{name:"expanded",type:"boolean"}]});Ext.define("OPF.console.domain.model.ActionModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/action",editorClassName:"OPF.console.domain.view.action.ActionEditor",constraintName:"OPF.registry.Action"},fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"serverName",type:"string"},{name:"port",type:"int",useNull:true},{name:"urlPath",type:"string"},{name:"protocol",type:"string"},{name:"method",type:"string"},{name:"status",type:"string"},{name:"soapUrlPath",type:"string"},{name:"soapMethod",type:"string"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.ActionParameterModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/action",constraintName:"OPF.registry.ActionParameter"},fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"location",type:"string"},{name:"orderPosition",type:"int"},{name:"fieldType",type:"string"},{name:"typeName",type:"string",useNull:true},{name:"description",type:"string"}]});Ext.define("OPF.console.domain.model.ActivityActionModel",{extend:Ext.data.Model,idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string",fieldType:"NAME"},{name:"description",type:"string"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],associations:[{type:"belongsTo",model:"OPF.console.domain.model.ActivityModel",name:"activityFrom",associatedName:"activityFrom",associatedKey:"activityFrom",foreignKey:"id",displayName:"Activity From",displayDescription:""},{type:"belongsTo",model:"OPF.console.domain.model.ActivityModel",name:"activityTo",associatedName:"activityTo",associatedKey:"activityTo",foreignKey:"id",displayName:"Activity To",displayDescription:""}]});Ext.define("OPF.console.domain.model.ActivityModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"process/activity",constraintName:"OPF.process.Activity"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string",fieldType:"NAME"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"sortPosition",type:"int"},{name:"activityType",type:"string"},{name:"actorId",type:"int"},{name:"actorName",mapping:"string"},{name:"statusId",mapping:"int"},{name:"statusName",mapping:"string"},{name:"notify",type:"boolean"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],associations:[{type:"hasMany",model:"OPF.console.domain.model.ActivityActionModel",name:"activityActions",associatedName:"activityActions",associationKey:"activityActions",foreignKey:"id",displayName:"Activity Actions",displayDescription:"",searchMode:[]},{type:"belongsTo",model:"OPF.console.domain.model.ActorModel",name:"actor",associatedName:"actor",associationKey:"actor",foreignKey:"id",displayName:"Actor",displayDescription:""},{type:"belongsTo",model:"OPF.console.domain.model.StatusModel",name:"status",associatedName:"status",associationKey:"status",foreignKey:"id",displayName:"Status",displayDescription:""}]});Ext.define("OPF.console.domain.model.ActorModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"process/actor",editorClassName:"OPF.console.domain.view.process.ActorEditor",constraintName:"OPF.process.Actor"},idProperty:"id",displayProperty:"name",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"childCount",type:"int"},{name:"userActors",useNull:true},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.AssetFileModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/package"},fields:[{name:"filename",type:"string"},{name:"type",type:"string"},{name:"updated",type:"int"}]});Ext.define("OPF.console.domain.model.BIReportFieldModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/bireport",constraintName:"OPF.registry.BIReportField"},fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"displayName",type:"string"},{name:"count",type:"int"},{name:"enabled",type:"boolean"},{name:"type",type:"string"},{name:"parameters"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],associations:[{type:"hasMany",model:"OPF.console.domain.model.BIReportFieldModel",name:"children",associatedName:"children",associationKey:"children",foreignKey:"id"},{type:"belongsTo",model:"OPF.console.domain.model.BIReportModel",name:"report",associatedName:"report",associatedKey:"report",foreignKey:"id"},{type:"belongsTo",model:"OPF.console.domain.model.EntityModel",name:"entity",associatedName:"entity",associatedKey:"entity",foreignKey:"id"},{type:"belongsTo",model:"OPF.console.domain.model.FieldModel",name:"field",associatedName:"field",associatedKey:"field",foreignKey:"id"}]});Ext.define("OPF.console.domain.model.BIReportFieldTreeModel",{extend:Ext.data.Model,fields:[{name:"id",type:"int"},{name:"entityId",type:"int"},{name:"title",type:"string"},{name:"type",type:"string"},{name:"expanded",type:"boolean"},{name:"alwaysExpanded",type:"boolean"},{name:"enabled",type:"boolean"},{name:"order_position",type:"int"},{name:"leaf",type:"boolean"},{name:"children",useNull:true}]});Ext.define("OPF.console.domain.model.BIReportModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/bi/report",editorClassName:"OPF.console.domain.view.BIReportEditor",constraintName:"OPF.registry.BIReport"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"title",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"securityEnabled",type:"boolean"},{name:"fields",type:"auto"}]});Ext.define("OPF.console.domain.model.BIReportUserFieldModel",{extend:Ext.data.Model,fields:[{name:"id",type:"int",useNull:true},{name:"expanded",type:"boolean"},{name:"order",type:"int"},{name:"created",type:"int"},{name:"location",type:"string"}],associations:[{type:"belongsTo",model:"OPF.console.domain.model.BIReportUserModel",name:"userReport",associatedName:"userReport",associationKey:"userReport",foreignKey:"id",displayName:"User Report",displayDescription:""},{type:"belongsTo",model:"OPF.console.domain.model.BIReportFieldModel",name:"field",associatedName:"field",associationKey:"field",foreignKey:"id",displayName:"Field",displayDescription:""}]});Ext.define("OPF.console.domain.model.BIReportUserFilterModel",{extend:Ext.data.Model,fields:[{name:"id",type:"int",useNull:true},{name:"created",type:"int"},{name:"values",type:"auto"}],associations:[{type:"belongsTo",model:"OPF.console.domain.model.BIReportUserModel",name:"userReport",associatedName:"userReport",associationKey:"userReport",foreignKey:"id",displayName:"User Report",displayDescription:""},{type:"belongsTo",model:"OPF.console.domain.model.BIReportFieldModel",name:"field",associatedName:"field",associationKey:"field",foreignKey:"id",displayName:"Field",displayDescription:""}]});Ext.define("OPF.console.domain.model.BIReportUserModel",{extend:Ext.data.Model,fields:[{name:"id",type:"int",useNull:true},{name:"title",type:"string"},{name:"filter",type:"string"},{name:"fields",type:"auto"},{name:"created",type:"int"}],associations:[{type:"belongsTo",model:"OPF.console.directory.model.UserModel",name:"user",associatedName:"user",associationKey:"user",foreignKey:"id",displayName:"User",displayDescription:""},{type:"belongsTo",model:"OPF.console.domain.model.BIReportModel",name:"report",associatedName:"report",associationKey:"report",foreignKey:"id",displayName:"Report",displayDescription:""}]});Ext.define("OPF.console.domain.model.CaseExplanationModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"process/explanation",constraintName:"OPF.process.CaseExplanation"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"shortDescription",type:"string"},{name:"longDescription",type:"string"}]});Ext.define("OPF.console.domain.model.CaseObjectModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"process/case-object",constraintName:"OPF.process.CaseObject"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"entityId",type:"int"},{name:"entityType",type:"string"},{name:"updateDate",type:"string",convert:OPF.convertDate,useNull:false,persist:true,dateFormat:"time"}],associations:[{type:"belongsTo",model:"OPF.console.inbox.model.TaskModel",name:"task",associatedName:"task",associationKey:"task",foreignKey:"id",displayName:"Task",displayDescription:"",searchMode:[]},{type:"belongsTo",model:"OPF.console.inbox.model.CaseModel",name:"processCase",associatedName:"processCase",associationKey:"processCase",foreignKey:"id",displayName:"Case",displayDescription:"",searchMode:[]},{type:"belongsTo",model:"OPF.console.directory.model.UserModel",name:"createdBy",associatedName:"createdBy",associationKey:"createdBy",foreignKey:"id",displayName:"Created By",displayDescription:"",searchMode:[]},{type:"belongsTo",model:"OPF.console.directory.model.UserModel",name:"updatedBy",associatedName:"updatedBy",associationKey:"updatedBy",foreignKey:"id",displayName:"Updated By",displayDescription:"",searchMode:[]},{type:"belongsTo",model:"OPF.console.domain.model.StatusModel",name:"status",associatedName:"status",associationKey:"status",foreignKey:"id",displayName:"Status",displayDescription:""}]});Ext.define("OPF.console.domain.model.Database",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/database",editorClassName:"OPF.console.domain.view.system.DatabaseEditor",constraintName:"OPF.registry.Database"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"type",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"serverName",type:"string"},{name:"port",type:"int"},{name:"urlPath",type:"string"},{name:"protocol",type:"string"},{name:"username",type:"string"},{name:"password",type:"string"},{name:"status",type:"string"},{name:"rdbms",type:"string"},{name:"parentId",type:"int"},{name:"childCount",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.DomainModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/domain",editorClassName:"OPF.console.domain.view.DomainEditor",constraintName:"OPF.registry.Domain"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.EntityModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/entity",editorClassName:"OPF.console.domain.view.EntityEditor",constraintName:"OPF.registry.Entity"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"typeEntity",type:"string",useNull:true,defaultValue:null},{name:"parentId",type:"int"},{name:"fields"},{name:"extendedEntity",type:"auto",useNull:true,defaultValue:null},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"securityEnabled",type:"boolean"}],associations:[{type:"hasMany",model:"OPF.console.domain.model.FieldModel",name:"fieldModels",associatedName:"fieldModels",associationKey:"fieldModels",foreignKey:"id"},{type:"belongsTo",model:"OPF.console.domain.model.ReferenceObjectModel",name:"referenceObject",associatedName:"referenceObject",associationKey:"referenceObject",foreignKey:"id"}]});Ext.define("OPF.console.domain.model.FieldModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/package",constraintName:"OPF.registry.Field",fieldTypeIsString:function(a){return"UNIQUE_ID"==a||"CODE"==a||"LABEL"==a||"LOOKUP"==a||"NAME"==a||"DESCRIPTION"==a||"PASSWORD"==a||"SECRET_KEY"==a||"TINY_TEXT"==a||"SHORT_TEXT"==a||"MEDIUM_TEXT"==a||"LONG_TEXT"==a||"UNLIMITED_TEXT"==a||"RICH_TEXT"==a||"URL"==a||"SSN"==a||"PHONE_NUMBER"==a||"FILE"==a||"IMAGE_FILE"==a||"AUDIO_FILE"==a||"VIDEO_FILE"==a},fieldTypeIsNumeric:function(a){return"NUMERIC_ID"==a||"LARGE_NUMBER"==a||"INTEGER_NUMBER"==a||"CURRENCY"==a},fieldTypeIsReal:function(a){return"DECIMAL_NUMBER"==a||"CURRENCY"==a},fieldTypeIsDate:function(a){return"DATE"==a||"TIME"==a||"EVENT_TIME"==a||"CREATION_TIME"==a||"UPDATE_TIME"==a},fieldTypeIsBoolean:function(a){return"FLAG"==a},checkType:function(c,b){var a=null;if(OPF.isNotBlank(c)){if(OPF.console.domain.model.FieldModel.fieldTypeIsNumeric(b)){a=Ext.isNumeric(c)?parseInt(c):null}else{if(OPF.console.domain.model.FieldModel.fieldTypeIsReal(b)){a=isFinite(c)?c:null}else{if(OPF.console.domain.model.FieldModel.fieldTypeIsDate(b)){a=Ext.isDate(c)?Ext.Date.parse(c):null}else{if(OPF.console.domain.model.FieldModel.fieldTypeIsBoolean(b)){c=c.toLowerCase();a=c=="true"}else{a=c}}}}}return a}},fields:[{name:"id",type:"int",useNull:true},{name:"inherited",type:"boolean"},{name:"autoGenerated",type:"boolean"},{name:"name",type:"string"},{name:"displayName",type:"string"},{name:"displayDescription",type:"string"},{name:"fieldType",type:"string"},{name:"fieldTypeName",type:"string"},{name:"customFieldType",type:"string"},{name:"required",type:"boolean"},{name:"searchable",type:"boolean"},{name:"defaultValue",type:"string",useNull:true},{name:"description",type:"string",useNull:true},{name:"allowedValues",useNull:true},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],associations:[{type:"belongsTo",model:"OPF.console.directory.model.Directory",primaryKey:"id",foreignKey:"parentId"}]});Ext.define("OPF.console.domain.model.FilestoreModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/filestore",editorClassName:"OPF.console.domain.view.system.FilestoreEditor",constraintName:"OPF.registry.Filestore"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"type",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"serverName",type:"string"},{name:"port",type:"int",defaultValue:8080},{name:"urlPath",type:"string"},{name:"status",type:"string"},{name:"serverDirectory",type:"string"},{name:"parentId",type:"int"},{name:"childCount",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.Package",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/package",editorClassName:"OPF.console.domain.view.PackageEditor",constraintName:"OPF.registry.Package"},idProperty:"id",fields:[{name:"databaseVersion",type:"int"},{name:"deployed",type:"boolean"},{name:"version",type:"int"},{name:"prefix",type:"string"},{name:"urlPath",type:"string"},{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"type",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"childCount",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.PackageVersionModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/package"},fields:[{name:"versionName",type:"string"},{name:"version",type:"int"},{name:"current",type:"boolean"},{name:"updated",type:"int",useNull:true}]});Ext.define("OPF.console.domain.model.ProcessFieldModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"process/custom-fields",constraintName:"OPF.process.ProcessField"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"valueType",type:"string"},{name:"global",type:"boolean"},{name:"fieldId",type:"int"},{name:"format",type:"string"},{name:"registryNodeTypeId",type:"int"},{name:"orderPosition",type:"int"}]});Ext.define("OPF.console.domain.model.ProcessModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"process",editorClassName:"OPF.console.domain.view.process.ProcessEditor",constraintName:"OPF.process.Process"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string",fieldType:"NAME"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"supportMultiActivities",type:"boolean"},{name:"parentId",type:"int"},{name:"childCount",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.ReferenceObjectModel",{extend:Ext.data.Model,idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"heading",type:"string"},{name:"subHeading",type:"string"},{name:"description",type:"string"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.RegistryNodeModel",{extend:Ext.data.Model,idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.RelationshipModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/relationship",editorClassName:"OPF.console.domain.view.RelationshipEditor",constraintName:"OPF.registry.Relationship"},fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"type",type:"string"},{name:"parentId",type:"int"},{name:"relationshipType",type:"string"},{name:"relationshipTypeName",type:"string"},{name:"sourceEntityId",type:"int"},{name:"sourceEntityName",type:"string"},{name:"targetEntityId",type:"int",useNull:true},{name:"targetEntityName",type:"string",useNull:true},{name:"required",type:"boolean"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],associations:[{type:"belongsTo",model:"OPF.console.domain.model.EntityModel",name:"targetEntity",associatedName:"targetEntity",associationKey:"targetEntity",foreignKey:"id"}]});Ext.define("OPF.console.domain.model.ReportFieldModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/report",constraintName:"OPF.registry.ReportField"},fields:[{name:"id",type:"int",useNull:true},{name:"displayName",type:"string"},{name:"visible",type:"boolean"},{name:"searchable",type:"boolean"},{name:"relationships",type:"auto"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],associations:[{type:"belongsTo",model:"OPF.console.domain.model.ReportModel",name:"report",associatedName:"report",associatedKey:"report",foreignKey:"id"},{type:"belongsTo",model:"OPF.console.domain.model.FieldModel",name:"field",associatedName:"field",associatedKey:"field",foreignKey:"id"},{type:"hasMany",model:"OPF.console.domain.model.RelationshipModel",name:"relationships",associatedName:"relationships",associatedKey:"relationships",foreignKey:"id"}]});Ext.define("OPF.console.domain.model.ReportModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/report",editorClassName:"OPF.console.domain.view.ReportEditor",constraintName:"OPF.registry.Report"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"securityEnabled",type:"boolean"}]});Ext.define("OPF.console.domain.model.RootDomain",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/root_domain",editorClassName:"OPF.console.domain.view.RootDomainEditor",constraintName:"OPF.registry.RootDomain"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int",useNull:true},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.Server",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/server",editorClassName:"OPF.console.domain.view.system.ServerEditor",constraintName:"OPF.registry.Server"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"type",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"serverName",type:"string"},{name:"port",type:"int",defaultValue:8080},{name:"protocol",type:"string"},{name:"method",type:"string"},{name:"status",type:"string"},{name:"parentId",type:"int"},{name:"childCount",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.StatusModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"process/status",constraintName:"OPF.process.Status"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"sortPosition",type:"int"},{name:"created",type:"int"}]});Ext.define("OPF.console.domain.model.SystemModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/system",editorClassName:"OPF.console.domain.view.system.SystemEditor",constraintName:"OPF.registry.System"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"type",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"serverName",type:"string"},{name:"port",type:"int",defaultValue:8080},{name:"parentId",type:"int"},{name:"childCount",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.domain.model.UserActorModel",{extend:Ext.data.Model,fields:[{name:"id",type:"int"},{name:"username",type:"string"},{name:"userActorId",type:"int"}]});Ext.define("OPF.console.domain.model.WizardModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/domain",restSuffixUrl:"registry/wizard",editorClassName:"OPF.console.domain.view.WizardEditor",constraintName:"OPF.registry.Wizard"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"lookup",type:"string"},{name:"description",type:"string"},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.inbox.model.CaseActionModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/inbox",restSuffixUrl:"process/action/case"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"type",type:"string"},{name:"user"},{name:"userName",type:"string",useNull:true,convert:function(c,b){var a=b.get("user");return OPF.isEmpty(a)?null:a.username}},{name:"caseNote"},{name:"noteId",type:"int",useNull:true,convert:function(c,a){var b=a.get("caseNote");return OPF.isEmpty(b)?null:b.id}},{name:"note",type:"string",useNull:true,convert:function(c,a){var b=a.get("caseNote");return OPF.isEmpty(b)?null:b.text}},{name:"caseExplanation"},{name:"explanation",type:"string",useNull:true,convert:function(c,b){var a=b.get("caseExplanation");return OPF.isEmpty(a)?null:a.shortDescription}},{name:"processCase",type:"auto"},{name:"assignee",type:"string",useNull:true,convert:function(b,a){var c=a.get("processCase");return OPF.isEmpty(c)||OPF.isEmpty(c.assignee)?"":c.assignee.username}},{name:"description",type:"string"},{name:"performedOn",type:"date",dateFormat:"time"},{name:"created",type:"date",dateFormat:"time"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.inbox.model.CaseAttachmentModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/inbox",restSuffixUrl:"process/attachment",constraintName:"OPF.process.CaseAttachment"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"filename",type:"string"},{name:"name",type:"string"},{name:"description",type:"string"},{name:"processCaseId",type:"int"},{name:"created",type:"date",dateFormat:"time"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});var staticFields=[{name:"id",type:"int",useNull:true},{name:"description",type:"string",flex:1},{name:"process"},{name:"status"},{name:"assignee"},{name:"processName",type:"string",convert:function(b,a){return a.get("process").name}},{name:"assigneeName",type:"string",convert:function(b,a){return a.get("assignee").username}},{name:"statusName",type:"string",convert:function(b,a){return a.get("status").name}},{name:"data",type:"string"},{name:"active",type:"boolean",useNull:true},{name:"startDate",type:"date",dateFormat:"time"},{name:"updateDate",type:"date",dateFormat:"time"},{name:"completeDate",type:"date",dateFormat:"time"},{name:"hasPreviousTask",type:"boolean"},{name:"userCanPerform",type:"boolean"},{name:"created",type:"date",dateFormat:"time"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}];Ext.define("OPF.console.inbox.model.CaseModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/inbox",restSuffixUrl:"process/case"},idProperty:"id",fields:staticFields});OPF.console.inbox.model.CaseModel.configuredFields=staticFields;Ext.define("OPF.console.inbox.model.CaseNoteModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/inbox",restSuffixUrl:"process/note/",constraintName:"OPF.process.CaseNote"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"text",type:"string"},{name:"processCase"},{name:"task"},{name:"user"},{name:"taskId",type:"int"},{name:"processCaseId",type:"int"},{name:"note",type:"string"},{name:"userId",type:"int"},{name:"userName",type:"string"},{name:"created",type:"date",dateFormat:"time"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});var staticFields=[{name:"id",type:"auto",useNull:true},{name:"description",type:"string",flex:1},{name:"processCase"},{name:"activity"},{name:"assignee"},{name:"processName",type:"string",convert:function(c,a){var b=a.get("processCase");return b&&b.process?b.process.name:null}},{name:"activityName",type:"string",convert:function(b,a){var c=a.get("activity");return c?c.name:null}},{name:"assigneeName",type:"string",convert:function(c,b){var a=b.get("assignee");return a?a.username:null}},{name:"statusName",type:"string",convert:function(b,a){var c=a.get("activity");return c&&c.status?c.status.name:null}},{name:"userCanPerform",type:"boolean",fieldType:"FLAG"},{name:"active",type:"boolean",fieldType:"FLAG"},{name:"updateDate",type:"date",dateFormat:"time",fieldType:"DATE"},{name:"closeDate",type:"date",dateFormat:"time",fieldType:"DATE"},{name:"created",type:"date",dateFormat:"time"},{name:"canUpdate",type:"boolean",persist:false},{name:"canDelete",type:"boolean",persist:false}];Ext.define("OPF.console.inbox.model.TaskModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/inbox",restSuffixUrl:"process/task"},idProperty:"id",fields:staticFields,associations:[{type:"belongsTo",model:"OPF.console.domain.model.ProcessModel",name:"processCase",associatedName:"processCase",foreignKey:"id",displayName:"Process Case",displayDescription:"",searchMode:"FIELDS"},{type:"belongsTo",model:"OPF.console.domain.model.ActivityModel",name:"activity",associatedName:"activity",foreignKey:"id",displayName:"Activity",displayDescription:"",searchMode:"FIELDS"},{type:"belongsTo",model:"OPF.console.directory.model.UserModel",name:"assignee",associatedName:"assignee",foreignKey:"id",displayName:"Assignee",displayDescription:"",searchMode:"FIELDS"},{type:"belongsTo",model:"OPF.console.domain.model.CaseObjectModel",name:"caseObject",associatedName:"caseObject",associationKey:"caseObject",foreignKey:"id",displayName:"Case Object",displayDescription:"",searchMode:[]}]});OPF.console.inbox.model.TaskModel.configuredFields=staticFields;Ext.define("OPF.console.inbox.model.UserActorModel",{extend:Ext.data.Model,idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"user",useNull:true},{name:"actor",useNull:true},{name:"process",useNull:true},{name:"processCase",useNull:true},{name:"created",type:"date",dateFormat:"time"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}]});Ext.define("OPF.console.site.model.NavigationElement",{extend:Ext.data.Model,statics:{pageSuffixUrl:"console/site",restSuffixUrl:"site/navigation",editorClassName:"OPF.console.site.editor.NavigationElementEditor",constraintName:"OPF.site.NavigationElement"},idProperty:"id",fields:[{name:"id",type:"int",useNull:true},{name:"name",type:"string"},{name:"path",type:"string"},{name:"description",type:"string"},{name:"lookup",type:"string"},{name:"parentId",type:"int"},{name:"serverName",type:"string"},{name:"port",type:"string"},{name:"parentPath",type:"string"},{name:"urlPath",type:"string"},{name:"protocol",type:"string"},{name:"method",type:"string"},{name:"status",type:"string"},{name:"sortPosition",type:"string"},{name:"elementType",type:"string"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"navigationElements",type:"auto"},{name:"permissions",type:"auto"},{name:"textResourceVersion",type:"auto"},{name:"imageResourceVersion",type:"auto"}],hasMany:[{model:"NavigationElement",name:"navigationElements",foreignKey:"parent_id"}]});Ext.define("OPF.core.component.ErrorContainer",{extend:Ext.container.Container,alias:"widget.error-container",cls:"error-container",hidden:true,form:null,delay:null,activeErrorContainerTpl:['<tpl if="errors && errors.length">','<h4><img src="{errorImageUrl}" border="0"/>Error Message!</h4>','<ul><tpl for="errors"><li class="{level.css} <tpl if="xindex == xcount"> last</tpl>">{msg}</li></tpl></ul>',"</tpl>"],initComponent:function(){var b=this;if(OPF.isNotEmpty(this.delay)){var a=new Ext.util.DelayedTask(function(){b.initErrorContainer()},this);a.delay(this.delay)}else{this.initErrorContainer()}this.items=this.items||[];this.callParent(arguments)},initErrorContainer:function(){var b=this;var a=this.form.getForm().getFields();Ext.each(a.items,function(c){c.on("errorchange",b.showErrors,b)})},showError:function(c,a){var b=[{level:c,msg:a}];this.setActiveErrorContainer(b)},showErrors:function(){var a=this;if(OPF.isNotEmpty(this.task)){this.task.cancel()}this.task=new Ext.util.DelayedTask(function(){a.showLastErrors()},this);this.task.delay(10)},showLastErrors:function(){var b=[];var a=this.form.getForm().getFields();Ext.each(a.items,function(d){var c=d.getActiveErrors();Ext.each(c,function(e){if(OPF.isNotBlank(e)){b.push({level:OPF.core.validation.MessageLevel.ERROR,msg:e})}})});this.setActiveErrorContainer(b)},setActiveErrorContainer:function(b){var a=this.getTpl("activeErrorContainerTpl").apply({errors:b,errorImageUrl:OPF.Cfg.fullUrl("images/error.png")});this.update(a);this.setVisible(OPF.isNotBlank(a))},cleanActiveErrors:function(){this.update("");this.hide()}});Ext.define("OPF.core.component.ExportButton",{extend:Ext.button.Split,alias:"widget.opf-export-button",buttonConfig:{},grid:null,strategies:[],initComponent:function(){var b=this;var a=[];Ext.each(this.strategies,function(d,c){a.push({text:d.title,handler:function(){b.exportData(d.strategy,d.filename)}});if(c==0){b.handler=function(){b.exportData(d.strategy,d.filename)}}});this.menu=new Ext.menu.Menu({bodyCls:"export",items:a});this.callParent(arguments)},getQueryParams:function(){return null},exportData:function(f,h){var e=this;var a=[];if(OPF.isNotEmpty(this.grid)){Ext.each(this.grid.columns,function(j){a.push({xtype:"opf-hidden",name:"columns",value:j.dataIndex})})}var g="";var d=this.getQueryParams();if(OPF.isNotEmpty(d)){var c=0;for(name in d){if(c==0){g+="?"}g+=name+"="+d[name]+"&";c++}}var b=Ext.create("Ext.form.Panel",{url:OPF.Cfg.restUrl("site/export/"+f+"/"+h+g,true),monitorValid:true,standardSubmit:true,items:a});b.getForm().submit()}});Ext.define("CMS.view.FileDownload",{extend:Ext.Component,alias:"widget.opf-file-downloader",autoEl:{tag:"iframe",cls:"x-hidden",src:Ext.SSL_SECURE_URL},load:function(a){var b=this.getEl();b.dom.src=a.url+(a.params?"?"+Ext.urlEncode(a.params):"");b.dom.onload=function(){if(b.dom.contentDocument.body.childNodes[0].wholeText=="404"){Ext.Msg.show({title:"Attachment missing",msg:"The document you are after can not be found on the server.",buttons:Ext.Msg.OK,icon:Ext.MessageBox.ERROR})}}}});Ext.define("OPF.core.component.FileTreePanel",{extend:Ext.tree.Panel,alias:"widget.opf-filetreepanel",layout:"fit",useArrows:true,autoScroll:true,animate:true,collapsible:false,split:true,rootVisible:false,selectedNode:null,managerLayout:null,fileServiceUrl:null,directoryOnly:false,constructor:function(b,c,a){a=a||{};OPF.core.component.FileTreePanel.superclass.constructor.call(this,Ext.apply({managerLayout:b,directoryOnly:c},a))},initComponent:function(){var a=this;this.store=Ext.create("Ext.data.TreeStore",{model:"OPF.core.model.FileTreeModel",proxy:{type:"ajax",url:a.fileServiceUrl,reader:{type:"json",root:"data"}},root:{text:"root",expanded:true,path:""},folderSort:true,sorters:this.SORTER,clearOnLoad:false,listeners:{beforeload:function(c,b,d){c.proxy.url=a.fileServiceUrl+"?path="+b.node.get("path")+"&directoryOnly="+a.directoryOnly}}});this.delayedClick=new Ext.util.DelayedTask(function(c,b){if(c){this.fireDblClick(b)}else{this.fireClick(b)}},this),this.callParent(arguments)},listeners:{itemclick:function(a,b){this.delayedClick.delay(200,null,this,[false,b])},itemdblclick:function(a,b){this.delayedClick.delay(200,null,this,[true,b])},containerclick:function(a){a.getSelectionModel().deselect(this.selectedNode);this.selectedNode=null;this.managerLayout.selectButton.disable()}},fireClick:function(a){this.selectedNode=a;this.managerLayout.selectButton.enable()},fireDblClick:function(a){this.managerLayout.chooseFile(a)}});Ext.define("OPF.core.component.FileManagerDialog",{extend:Ext.window.Window,alias:"widget.opf-filemanager-dlg",id:"fileManagerDialog",title:"File Explorer",modal:true,closable:true,closeAction:"hide",layout:"fit",resizable:false,width:300,height:400,directoryOnly:null,selectFileField:null,constructor:function(b,a){a=a||{};OPF.core.component.FileManagerDialog.superclass.constructor.call(this,Ext.apply({directoryOnly:b},a))},initComponent:function(){var a=this;this.fileTreePanel=Ext.create("OPF.core.component.FileTreePanel",this,this.directoryOnly,{fileServiceUrl:OPF.Cfg.restUrl("/registry/filemanager/directory")});this.selectButton=new Ext.Button({text:"Select",disabled:true,handler:function(){a.chooseFile(a.fileTreePanel.selectedNode)}});this.closeButton=new Ext.Button({text:"Cancel",handler:function(){a.close()}});this.items=[this.fileTreePanel];this.fbar=[this.selectButton,this.closeButton];this.callParent(arguments)},chooseFile:function(a){this.selectFileField.setValue(a.get("path"));this.close()},setSelectFileField:function(a){this.selectFileField=a}});OPF.core.component.FileManagerDialog.init=function(c,b){var a=Ext.WindowMgr.get("fileManagerDialog");if(isEmpty(a)){a=Ext.create("OPF.core.component.FileManagerDialog",b);Ext.WindowMgr.register(a)}a.setSelectFileField(c);return a};Ext.define("OPF.core.component.HrefClick",{extend:Ext.Component,alias:"widget.hrefclick",autoEl:"a",onClick:Ext.emptyFn,initComponent:function(){this.addEvents("click");this.callParent(arguments)},onRender:function(){this.callParent(arguments);this.mon(this.el,"click",this.onClick,this)}});Ext.define("OPF.core.component.ImageContainer",{extend:Ext.container.Container,alias:"widget.opf-image",fieldLabel:null,subFieldLabel:null,layout:"anchor",imageWidth:null,imageHeight:null,isDelete:false,imageWidthField:null,imageHeightField:null,resourceFileTemporaryName:null,resourceFileOriginalName:null,allowDelete:true,initComponent:function(){var a=this;this.resourceLookupField=Ext.ComponentMgr.create({xtype:"opf-hidden",name:this.name,listeners:{errorchange:function(c,b){if(a.imageContainer.el){if(OPF.isNotBlank(b)){a.imageContainer.addCls("opf-image-invalid");a.imageContainer.addCls("x-form-invalid-field");a.imageContainer.el.dom.setAttribute("data-errorqtip",b||"")}else{a.imageContainer.removeCls("opf-image-invalid");a.imageContainer.removeCls("x-form-invalid-field");a.imageContainer.el.dom.removeAttribute("data-errorqtip")}}}}});this.imageContainer=Ext.ComponentMgr.create({xtype:"container",html:"Loading...",cls:"opf-image",width:this.imageWidth,height:this.imageHeight,listeners:{render:function(b){b.getEl().on("click",function(){a.resourceLookupField.validate()})}}});this.uploadFileDialog=new OPF.core.component.UploadFileDialog(this,{title:"Upload new image",ui:"wizards",width:540,frame:false,fileTypes:["jpg","jpeg","png","gif"],uploadUrl:OPF.Cfg.restUrl("content/resource/upload/image"),configs:{fileUploadFieldConfigs:{padding:10,buttonText:"",buttonConfig:{ui:"upload",width:60,height:60,iconCls:"upload-icon"}},uploadButtonConfigs:{ui:"blue",width:250,height:60},cancelButtonConfigs:{ui:"blue",width:250,height:60}},successUploaded:function(c){var d=c.data[0];a.isDelete=false;a.resourceFileOriginalName=d.orgFilename;a.resourceFileTemporaryName=d.filename;a.resourceLookupField.setValue(d.filename);var b=OPF.Cfg.restUrl("content/resource/tmp/"+d.filename);a.imageWidthField=d.width;a.imageHeightField=d.height;a.loadImageContainer(b,d.width,d.height)}});this.uploadButton=new Ext.Button({text:"Upload new image",handler:function(){a.uploadFileDialog.show()}});this.deleteButton=new Ext.Button({text:"Delete",hidden:!this.allowDelete,handler:function(){a.onDelete()}});this.label=Ext.ComponentMgr.create({xtype:"container",html:'<label class="x-form-item-label x-form-item-label-top"><span class="main-label">'+this.fieldLabel+':</span><span class="sub-label ">'+this.subFieldLabel+"</span></label>"});this.items=[this.label,this.resourceLookupField,this.imageContainer,{xtype:"container",layout:"hbox",items:[this.uploadButton,{xtype:"tbspacer",width:10},this.deleteButton]}];this.callParent(arguments)},loadImageContainer:function(a,d,c){var b=OPF.core.component.resource.ResourceControl.getImgHtmlWrapper(a,d,c,"",this.imageWidth-4,this.imageHeight-4);this.imageContainer.update(b)},getJsonData:function(){return{width:this.imageWidthField,height:this.imageHeightField,resourceFileTemporaryName:this.resourceFileTemporaryName,resourceFileOriginalName:this.resourceFileOriginalName}},onDelete:function(){this.imageContainer.update("Image not defined");this.resourceLookupField.setValue(null);this.isDelete=true},clean:function(){this.isDelete=false;this.imageWidthField=null;this.imageHeightField=null;this.resourceFileTemporaryName=null;this.resourceFileOriginalName=null;this.imageContainer.update("Image not defined");this.idData.lookup=null;this.resourceLookupField.setValue(null);this.idData.version=null},load:function(b){var a=this;this.clean();if(OPF.isNotBlank(b)){Ext.Ajax.request({url:OPF.Cfg.restUrl("content/resource/image/by-lookup/"+b),method:"GET",success:function(c){var d=Ext.decode(c.responseText);if(d.success){var e=d.data[0].resourceVersion;a.showImage(e)}},failure:function(c){var d=Ext.decode(c.responseText);OPF.Msg.setAlert(false,d.message)}})}},process:function(){var a;if(this.isDelete){a=this.remove()}else{a=this.save()}return a},save:function(){var c=this;var b=this.getJsonData();if(OPF.isBlank(b.resourceFileTemporaryName)){return this.idData.lookup}var a;var d;if(this.idData.lookup){b.resourceLookup=this.idData.lookup;b.version=this.idData.version;a=OPF.Cfg.restUrl("content/resource/image/version/by-lookup/"+this.idData.lookup);d="PUT"}else{a=OPF.Cfg.restUrl("content/resource/image/version/new-by-path/"+this.idData.path);d="POST"}b.culture="AMERICAN";Ext.Ajax.request({url:a,method:d,jsonData:{data:b},async:false,success:function(e,h){var f=Ext.decode(e.responseText);if(f.success){var g=f.data[0];c.showImage(g)}},failure:function(e){OPF.Msg.setAlert(false,"Error occurred while saving image.")}});return this.idData.lookup},remove:function(){var a=this;if(this.idData.lookup){Ext.Ajax.request({url:OPF.Cfg.restUrl("content/resource/image/by-lookup/"+this.idData.lookup),method:"DELETE",async:false,success:function(b,d){var c=Ext.decode(b.responseText);OPF.Msg.setAlert(c.success,c.message);a.clean()},failure:function(b){OPF.Msg.setAlert(false,"Error occurred while saving image.")}})}return null},showImage:function(c){var a="content/resource/image/by-filename/"+c.resourceId+"/"+c.storedFilename+"?_dc="+new Date().getTime();var b=OPF.Cfg.restUrl(a);this.loadImageContainer(b,c.width,c.height);this.idData.lookup=c.resourceLookup;this.resourceLookupField.setValue(c.resourceLookup);this.idData.version=c.version;this.imageWidthField=c.width;this.imageHeightField=c.height;this.resourceFileTemporaryName=null;this.resourceFileOriginalName=c.resourceFileOriginalName}});Ext.define("OPF.core.component.LabelContainer",{extend:Ext.container.Container,alias:"widget.label-container",cls:"fieldset-top-margin",labelCls:"container-label-block",labelMargin:"5 0 15 0",fieldLabel:null,subFieldLabel:null,initComponent:function(){var a=this;var c=this.layout;this.layout="anchor";this.label=Ext.ComponentMgr.create({xtype:"container",html:'<label class="'+this.labelCls+'"><span class="main-label">'+this.fieldLabel+':</span><span class="sub-label ">'+this.subFieldLabel+"</span></label>",margin:this.labelMargin});var b=this.items;this.items=[this.label,{xtype:"fieldcontainer",layout:c,items:b}];this.callParent(arguments)},findById:function(e){var d=this;var a=d.items.items.slice();var c=null;for(var b=0;b<a.length;b++){if(a[b].id==e||a[b].itemId==e){c=a[b];break}}return c}});Ext.define("OPF.core.component.LinkButton",{extend:Ext.Component,alias:"widget.linkbutton",autoEl:"a",renderTpl:'<a href="javascript:;" id="{id}-btnEl">{text}</a>',config:{text:"",handler:function(){}},initComponent:function(){var a=this;a.callParent(arguments);this.renderData={text:this.getText()}},onRender:function(c,a){var d=this,b;d.addChildEls("btnEl");d.callParent(arguments);b=d.btnEl;d.mon(b,"click",d.onClick,d)},onClick:function(b){var a=this;if(a.preventDefault||(a.disabled&&a.getHref())&&b){b.preventDefault()}if(b.button!==0){return}if(!a.disabled){a.fireHandler(b)}},fireHandler:function(c){var b=this,a=b.handler;b.fireEvent("click",b,c);if(a){a.call(b.scope||b,b,c)}}});Ext.define("OPF.core.component.MenuItem",{extend:Ext.menu.Item,alias:"widget.opf-menuitem",renderTpl:['<tpl if="plain">',"{text}","<tpl else>",'<a id="{id}-itemEl" class="'+Ext.baseCSSPrefix+'menu-item-link" href="{href}" <tpl if="hrefTarget">target="{hrefTarget}"</tpl> hidefocus="true" unselectable="on">','<span id="{id}-textEl" class="'+Ext.baseCSSPrefix+'menu-item-text header" <tpl if="arrowCls"></tpl> ><b>{text}</b></span><br/>','<span id="{id}-descriptionEl" class="'+Ext.baseCSSPrefix+'menu-item-text" <tpl if="arrowCls"></tpl> >{description}</span>',"</a>","</tpl>"],beforeRender:function(){var a=this;a.callParent();Ext.applyIf(a.renderData,{description:a.description})}});Ext.ns("OPF.core.component");Ext.define("OPF.core.component.NavigationMenu",{extend:Ext.toolbar.Toolbar,cls:"header",height:39,alias:"widget.navigation-menu",lookup:"",activeButtonLookup:null,navigationElements:null,initComponent:function(){this.addNavigationButtons();var b=Ext.ComponentMgr.create({xtype:"textfield",cls:"search",emptyText:"Search",enableKeyEvents:true,listeners:{keyup:function(d,c){if(c.keyCode==13){document.location=OPF.Cfg.OPF_CONSOLE_URL+"/console/search?term="+d.value}}}});if(OPF.Cfg.PAGE_TYPE=="SEARCH"&&isNotBlank(SEARCH_PHRASE)){b.setValue(SEARCH_PHRASE)}var a=Ext.ComponentMgr.create({xtype:"button",ui:"logout",text:"",tooltip:"Logout",width:12,height:15,iconCls:"logout-ico",handler:function(){document.location=OPF.Cfg.fullUrl("console/logout")}});this.items=[{xtype:"component",html:'<a class="logo" href="http://www.firejack.net" title="Firejack Platform"><span class="logo-img_w32"></span></a>'},"->",b,{xtype:"component",cls:"user-name",width:100,html:OPF.Cfg.USER_INFO.username},a];this.callParent(arguments)},addNavigationButtons:function(){var a=this;Ext.Ajax.request({url:OPF.Cfg.restUrl("site/navigation/tree-by-lookup/"+this.lookup),method:"GET",jsonData:"[]",success:function(b,d){var c=null;var e=[];a.navigationElements=Ext.decode(b.responseText).data;Ext.each(a.navigationElements,function(f,h){OPF.NavigationMenuRegister.add(f);var l=f.navigationElements;var j=l.length>0?"splitbutton":"button";var g=OPF.isNotEmpty(f.textResourceVersion)?f.textResourceVersion.text:f.name;var k=Ext.ComponentMgr.create({xtype:j,ui:"main-menu",margin:"0 0 0 0",text:g,width:a.buttonWidth,height:a.buttonHeight,scale:a.buttonScale,iconAlign:a.buttonIconAlign,iconCls:a.buttonIconCls,enableToggle:true,toggleGroup:"cs-nav",handler:function(){document.location=a.generateUrl(f)}});a.navigationElements.push(f);a.addSubNavigationButtons(l,k);e.push(k);if(f.lookup==a.activeButtonLookup){c=k;c.pressed=true}});e.push({xtype:"button",text:"Knowledge Center",ui:"main-menu",scale:a.buttonScale,href:"http://documents.firejack.net",target:"_blank"});a.add(1,e)},failure:function(b){var c=Ext.decode(b.responseText);OPF.Msg.setAlert(false,c.message)}})},addSubNavigationButtons:function(c,b){var a=this;var d=[];Ext.each(c,function(e,f){OPF.NavigationMenuRegister.add(e);var g=Ext.ComponentMgr.create({xtype:"menuitem",text:e.name,handler:function(){document.location=a.generateUrl(e)}});d.push(g);a.addSubNavigationButtons(e.navigationElements,g)});if(d.length>0){b.menu=Ext.menu.MenuMgr.get(d)}},generateUrl:function(b){var a=OPF.Cfg.getBaseUrl();if(OPF.isNotBlank(b.serverName)&&OPF.isNotEmpty(b.port)&&OPF.isNotBlank(b.parentPath)){a="http://"+b.serverName+":"+b.port+b.parentPath}a+=b.urlPath;return a}});Ext.define("OPF.core.component.PrintButton",{extend:Ext.button.Button,alias:"widget.opf-print-button",buttonConfig:{},printCSS:null,printTitle:null,printData:null,printTpl:null,initComponent:function(){var a=this;this.handler=function(){a.print()};this.callParent(arguments)},print:function(){var b=this;if(OPF.isNotEmpty(this.printData)&&OPF.isNotEmpty(this.printTpl)){var a=this.printTpl.applyTemplate(this.printData);var c=window.open("","","width=600,height=800");c.document.write("<html><head>");c.document.write("<title>"+this.printTitle+"</title>");c.document.write("</head><body>");c.document.write(a);c.document.write("</body></html>");c.print()}}});Ext.define("OPF.core.component.SelectFileField",{extend:OPF.core.component.TextField,alias:"widget.opf-selectfilefield",cls:"x-form-field-filepath",buttonOnly:false,buttonMargin:3,componentLayout:"filefield",onRender:function(){var a=this,b;a.callParent(arguments);a.createButton();if(a.disabled){a.disableItems()}b=a.inputEl;if(a.buttonOnly){b.setDisplayed(false)}},createButton:function(){var a=this;a.button=Ext.ComponentMgr.create({xtype:"button",cls:"x-form-select-file",style:a.buttonOnly?"":"margin-left:"+a.buttonMargin+"px",renderTo:a.bodyEl,buttonConfig:a.buttonConfig,handler:function(){a.onSelectFileClick()}})},onFileChange:function(){this.lastValue=null;Ext.form.field.SelectFileField.superclass.setValue.call(this,this.fileInputEl.dom.value)},reset:function(){var a=this;if(a.rendered){if(a.fileInputEl){a.fileInputEl.remove();a.createFileInput()}a.inputEl.dom.value=""}a.callParent()},onDisable:function(){this.callParent();this.disableItems()},disableItems:function(){var b=this.fileInputEl,a=this.button;if(b){b.dom.disabled=true}if(a){a.disable()}},onEnable:function(){var a=this;a.callParent();a.fileInputEl.dom.disabled=false;a.button.enable()},isFileUpload:function(){return true},extractFileInput:function(){var a=this.fileInputEl.dom;this.reset();return a},onDestroy:function(){Ext.destroyMembers(this,"fileInputEl","button");this.callParent()},onSelectFileClick:function(){var a=OPF.core.component.FileManagerDialog.init(this,true);a.show()},getErrors:function(a){return getSQErrors(this,a)},getSubmitData:function(){var a=this,b=null,c;if(!a.disabled){c=a.getSubmitValue();if(c!==null){b={};b[a.getName()]=c}}return b}});Ext.define("OPF.core.component.ToolTipOnClick",{extend:Ext.tip.ToolTip,alias:"widget.tooltip-onclick",showDelay:0,setTarget:function(d){var b=this,a=Ext.get(d),c;if(b.target){c=Ext.get(b.target);b.mun(c,"click",b.onTargetOver,b);b.mun(c,"mouseout",b.onTargetOut,b);b.mun(c,"mousemove",b.onMouseMove,b)}b.target=a;if(a){b.mon(a,{freezeEvent:true,click:b.onTargetOver,mouseout:b.onTargetOut,mousemove:b.onMouseMove,scope:b})}if(b.anchor){b.anchorTarget=b.target}}});Ext.define("OPF.core.component.UploadFileDialog",{extend:Ext.window.Window,modal:true,closable:true,closeAction:"hide",hideMode:"display",resizable:false,width:400,packageId:null,fileTypes:[],editPanel:null,additionalFields:[],fileLabelAlign:"top",fileLabelWidth:100,uploadUrl:null,configs:null,constructor:function(b,a){a=a||{};a.configs=a.configs||{};a.configs=Ext.apply(a.configs,a.configs,this.configs);OPF.core.component.UploadFileDialog.superclass.constructor.call(this,Ext.apply({editPanel:b},a))},initComponent:function(){var a=this;this.uploadButton=Ext.ComponentMgr.create(Ext.apply({xtype:"button",text:"Upload",formBind:true,handler:function(){a.uploadFile()}},this.configs.uploadButtonConfigs));this.cancelButton=Ext.ComponentMgr.create(Ext.apply({xtype:"button",text:"Cancel",handler:function(){Ext.MessageBox.confirm("Cancel Action","All changes will be lost, are you sure?",function(c){if(c[0]=="y"){a.hide()}})}},this.configs.cancelButtonConfigs));this.fileUploadField=Ext.ComponentMgr.create(Ext.apply({xtype:"opf-file",labelAlign:this.fileLabelAlign,fieldLabel:"File",labelWidth:this.fileLabelWidth,subFieldLabel:"",name:"file",anchor:"100%",fileTypes:this.fileTypes},this.configs.fileUploadFieldConfigs));var b=[];Ext.each(this.additionalFields,function(c,d){b.push(c)});b.push(this.fileUploadField);this.form=Ext.create("Ext.form.Panel",{url:this.uploadUrl,layout:"anchor",padding:5,border:false,monitorValid:true,header:false,items:b,ui:"upload-form-ui",dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",items:["->",this.uploadButton,this.cancelButton]}]});this.items=[this.form];this.callParent(arguments)},listeners:{show:function(a){a.form.getForm().checkValidity()}},uploadFile:function(){var a=this;this.form.getEl().mask();this.form.getForm().submit({method:"POST",success:function(b,d){var c=Ext.JSON.decode(d.response.responseText);OPF.Msg.setAlert(OPF.Msg.STATUS_OK,c.message);a.form.getEl().unmask();a.successUploaded(c,d);a.hide()},failure:function(b,c){OPF.Msg.setAlert(OPF.Msg.STATUS_ERROR,"Processed file on the server failure.");a.form.getEl().unmask();a.failureUploaded(c)}})},successUploaded:function(a,b){},failureUploaded:function(a){}});Ext.define("OPF.core.component.calendar.CalendarEvent",{extend:Ext.container.Container,alias:"widget.calendar-event",cls:"cal-event",hourHeight:null,dateOffSet:null,dayColumn:null,calendarEventModel:null,scaleOfEvent:1,indentOfEvent:0,initComponent:function(){var a=this;this.startTime=this.calendarEventModel.get("startTime");this.endTime=this.calendarEventModel.get("endTime");this.height=((this.endTime.getTime()-this.startTime.getTime())/(60*60*1000))*this.hourHeight;this.data=this.calendarEventModel.data;this.callParent(arguments)},doResize:function(){var b=this.dateOffSet;var c=((this.startTime.getTime()-b.getTime())/(60*60*1000))*this.hourHeight;this.el.setTop(c);var a=this.dayColumn.getWidth()/this.scaleOfEvent;this.el.setLeft(a*this.indentOfEvent);this.setWidth(a)},getStartTime:function(){return this.calendarEventModel.get("startTime")},getEndTime:function(){return this.calendarEventModel.get("endTime")}});Ext.define("OPF.core.component.calendar.model.CalendarEventModel",{extend:Ext.data.Model,fields:[{name:"object",type:"auto",useNull:false},{name:"date",type:"string",convert:OPF.convertDate,useNull:false,dateFormat:"time"},{name:"startTime",type:"string",convert:OPF.convertTime,useNull:false,dateFormat:"time"},{name:"endTime",type:"string",convert:OPF.convertTime,useNull:false,dateFormat:"time"}]});Ext.define("OPF.core.component.calendar.store.CalendarStore",{extend:Ext.data.Store,model:"OPF.core.component.calendar.model.CalendarEventModel",proxy:{type:"ajax",reader:{type:"json",root:"data"},writer:{type:"json"}},constructor:function(a){a=a||{};a.listeners=a.listeners||{};a.listeners=Ext.apply(a.listeners,a.listeners,this.listeners);this.addEvents("preload");this.superclass.constructor.call(this,a)},load:function(b){var a=this.callParent(arguments);if(this.loading){this.fireEvent("preload",this)}return a}});Ext.define("OPF.core.component.calendar.CalendarPanel",{extend:Ext.panel.Panel,alias:"widget.calendar-panel",layout:{type:"vbox",align:"stretch",pack:"start"},calendarEvents:[],headerHeight:30,hourHeight:40,year:null,week:null,tpl:new Ext.XTemplate("<h2>{object.name}</h2>","<p>{startTime} - {endTime}</p>"),interval:30,startTimeRange:"12:00 AM",endTimeRange:"11:30 PM",startHoursFromTheBeginningOfTheDay:null,endHoursFromTheBeginningOfTheDay:null,dateOffSet:null,store:null,initComponent:function(){var o=this;var n,e;this.year=new Date().getFullYear();this.week=new Date().getWeek();var h=this.getDateRangeOfWeek();var q=this.calculateDays(h.startDate);var p=[{cls:"cal-cell-time-header",html:"Time",width:100}];Ext.each(q,function(r,s){var m=Ext.Date.format(r,"l");var d={cls:"cal-cell-day-header",html:m,columnWidth:0.2};p.push(d)});p.push({cls:"cal-last-cell-time-header",width:18});this.calendarHeader=Ext.create("Ext.container.Container",{layout:"column",height:this.headerHeight,defaults:{xtype:"container",height:this.headerHeight},items:p});var b=this.calculateStartAndEndThresholds();var f=b[0],a=b[1];var k=Ext.Date.clearTime(new Date());var j=[];for(e=f;e<a;e++){var c=Ext.Date.add(k,Ext.Date.MINUTE,e*o.interval);var g=Ext.Date.format(c,"g:i a");var l={xtype:"container",height:this.hourHeight/2,cls:"cal-cell-time-legend",padding:((this.hourHeight/2)-20)/2+" 0 0 0",html:g};j.push(l)}this.schedulerDayColumns=[];Ext.each(q,function(m,r){var v=[];for(e=f;e<a;e++){var u=e%2==1?"cal-cell-day-fullhour":"cal-cell-day-halfhour";var s={xtype:"container",height:o.hourHeight/2,cls:u};v.push(s)}var d=Ext.create("Ext.container.Container",{columnWidth:0.2,cls:"cal-day-column",day:m,items:v,dayEvents:[],starTimeThreshold:f,endTimeThreshold:a});o.schedulerDayColumns.push(d)});this.store.on("preload",this.showCalendarSchedulerMask,this);this.store.on("load",this.addCalendarEvents,this);this.calendarScheduler=Ext.create("Ext.container.Container",{xtype:"container",flex:1,autoScroll:true,items:[{xtype:"container",layout:"column",height:this.hourHeight*(this.endHoursFromTheBeginningOfTheDay-this.startHoursFromTheBeginningOfTheDay+0.5),defaults:{xtype:"container"},items:[{width:100,defaults:{xtype:"container",style:{position:"relative"}},items:j},this.schedulerDayColumns]}]});this.items=[this.calendarHeader,this.calendarScheduler];this.weekTitleText=Ext.create("Ext.toolbar.TextItem",{cls:"cal-date-interval"});this.getWeekTitle(h);this.dockedItems=[{xtype:"toolbar",dock:"top",items:["->",{xtype:"button",cls:"cal-btn cal-prev-btn",text:"<< Prev Week",handler:this.previousWeek,scope:this},this.weekTitleText,{xtype:"button",cls:"cal-btn cal-next-btn",text:"Next Week >>",handler:this.nextWeek,scope:this},"->"]}];this.callParent(arguments)},listeners:{resize:function(b,c,a){Ext.each(this.calendarEvents,function(d){d.doResize()})}},getWeekTitle:function(b){var a=b.startDate;var c=Ext.Date.clearTime(a,true);c.setDate(c.getDate()+4);this.weekTitleText.setText(Ext.Date.format(a,"F d, Y")+" - "+Ext.Date.format(c,"F d, Y"))},getYear:function(){return this.year},getWeek:function(){return this.week},setDate:function(b,a){this.year=b;this.week=a;this.refreshCalendarEvents()},getDateRangeOfWeek:function(){var b=new Date();b.setYear(this.year);var f=b.getDay()-1;b.setDate(b.getDate()-f);var c=b.getWeek();var d=this.week-c;var a=Ext.Date.clearTime(b,true);a.setDate(b.getDate()+7*d);var e=Ext.Date.clearTime(a,true);e.setDate(a.getDate()+6);return{startDate:a,endDate:e}},calculateDays:function(b){var e=[];for(var c=0;c<5;c++){var a=Ext.Date.add(b,Ext.Date.DAY,c);e.push(a)}return e},refreshCalendarEvents:function(){var a=this.getDateRangeOfWeek();var b=Ext.Date.clearTime(a.startDate);var c=this.calculateDays(b);Ext.each(this.schedulerDayColumns,function(d,e){d.day=c[e];Ext.each(d.dayEvents,function(f){d.remove(f)});d.dayEvents=[]});this.calendarEvents=[];this.store.load();this.getWeekTitle(a)},showCalendarSchedulerMask:function(){this.calendarSchedulerMask=new Ext.LoadMask(this.calendarScheduler.getEl(),{msg:"Loading..."});this.calendarSchedulerMask.show()},addCalendarEvents:function(){var a=this;this.calendarSchedulerMask.hide();this.store.sort([{property:"startTime",direction:"ASC"}]);var b=this.store.getRange();Ext.each(b,function(d){var g=Ext.Date.parse(d.get("startTime"),"H:i:s");var e=Ext.Date.parse(d.get("endTime"),"H:i:s");if(!a.isValidCalendarEventDate(g,e)){return}d.set("startTime",g);d.set("endTime",e);d.set("date",Ext.Date.parse(d.get("date"),"Y-m-d"));var f=d.get("date");var c=a.findSchedulerDayColumn(f);if(OPF.isNotEmpty(c)){var h=Ext.create("OPF.core.component.calendar.CalendarEvent",{tpl:a.tpl,hourHeight:a.hourHeight,calendarEventModel:d,dayColumn:c,dateOffSet:a.dateOffSet});c.dayEvents.push(h);a.calendarEvents.push(h)}});Ext.each(this.schedulerDayColumns,function(c){a.renderCalendarEvents(c)})},findSchedulerDayColumn:function(a){var b=null;Ext.each(this.schedulerDayColumns,function(c){if(a.getTime()==c.day.getTime()){b=c}});return b},previousWeek:function(){var a=this.getDateRangeOfWeek();var b=a.startDate;b.setDate(b.getDate()-7);this.setDate(b.getFullYear(),b.getWeek())},nextWeek:function(){var a=this.getDateRangeOfWeek();var b=a.startDate;b.setDate(b.getDate()+7);this.setDate(b.getFullYear(),b.getWeek())},calculateFullMinutesFromTheBeginningOfTheDay:function(a){if(OPF.isNotEmpty(a)){return(a.getHours()*60)+a.getMinutes()}else{return null}},calculateFullHoursFromTheBeginningOfTheDay:function(a){if(OPF.isNotEmpty(a)){return this.calculateFullMinutesFromTheBeginningOfTheDay(a)/60}else{return null}},isValidCalendarEventDate:function(b,a){if(OPF.isEmpty(b)||OPF.isEmpty(a)){return false}var d=this.calculateFullHoursFromTheBeginningOfTheDay(b);var c=this.calculateFullHoursFromTheBeginningOfTheDay(a);return d>=this.startHoursFromTheBeginningOfTheDay&&c<=this.endHoursFromTheBeginningOfTheDay},calculateStartAndEndThresholds:function(){var a=Ext.Date.parse(this.startTimeRange,"g:i A");var b=Ext.Date.parse(this.endTimeRange,"g:i A");if(OPF.isEmpty(a)){throw new Error("startTime parameter is not valid ")}else{if(OPF.isEmpty(b)){throw new Error("endTime parameter is not valid ")}else{if(a.getMinutes()!=0&&a.getMinutes()!=30){throw new Error("startTime minutes should be 00 or 30")}else{if(b.getMinutes()!=0&&b.getMinutes()!=30){throw new Error("endTime minutes should be 00 or 30")}}}}this.dateOffSet=a;this.startHoursFromTheBeginningOfTheDay=this.calculateFullHoursFromTheBeginningOfTheDay(a);this.endHoursFromTheBeginningOfTheDay=this.calculateFullHoursFromTheBeginningOfTheDay(b);return[(this.startHoursFromTheBeginningOfTheDay*2),(this.endHoursFromTheBeginningOfTheDay*2+1)]},renderCalendarEvents:function(a){var b=this;if(a.dayEvents.length>0){var c=a.getWidth();var d=this.calculateCalendarEventGroup(a.dayEvents);Ext.each(d,function(j){var f=b.calculateFullMinutesFromTheBeginningOfTheDay(j.startTime);var g=b.calculateFullMinutesFromTheBeginningOfTheDay(j.endTime);var h=[];for(var k=f;k<g;k++){var l=k-f;h[l]=[];Ext.each(j.calendarEvents,function(o,q){h[l][q]=0;var p=b.calculateFullMinutesFromTheBeginningOfTheDay(o.getStartTime());var n=b.calculateFullMinutesFromTheBeginningOfTheDay(o.getEndTime());if(p<=k&&k<=n){if(q>0){var m=h[l].slice(0,q).max();h[l][q]=Math.max(1,o.indentOfEvent,m+1);o.indentOfEvent=Math.max(1,h[l][q])}else{h[l][q]=1}}})}var e=1;Ext.each(j.calendarEvents,function(n,r){var q=b.calculateFullMinutesFromTheBeginningOfTheDay(n.getStartTime());var m=b.calculateFullMinutesFromTheBeginningOfTheDay(n.getEndTime());var p=[];for(var o=q;o<m;o++){p[o-q]=h[o-f].slice(r,r+1)}e=Math.max(e,p.max());n.indentOfEvent=p.max()-1});a.add(j.calendarEvents);Ext.each(j.calendarEvents,function(m,n){m.scaleOfEvent=e;m.doResize()})})}},calculateCalendarEventGroup:function(a){var b=[];Ext.each(a,function(f,d){var c=null;Ext.each(b,function(g){var k=g.startTime.getTime();var l=g.endTime.getTime();var h=f.getStartTime().getTime();var j=f.getEndTime().getTime();if((h<k&&k<j)||(k<h&&h<l)||k==h){c=g}});if(c!=null){c.startTime=new Date(Math.min.apply(null,[c.startTime,f.getStartTime()]));c.endTime=new Date(Math.max.apply(null,[c.endTime,f.getEndTime()]));c.calendarEvents.push(f)}else{var e={startTime:f.getStartTime(),endTime:f.getEndTime(),calendarEvents:[f]};b.push(e)}});return b}});Ext.define("OPF.core.component.form.SubLabelable",{initSubLabelable:function(){var a="";this.fieldOrgLabel=this.fieldLabel;if(OPF.isNotBlank(this.fieldLabel)){a+='<span class="main-label">'+this.fieldLabel+this.labelSeparator+"</span>"}if(OPF.isNotBlank(this.subFieldLabel)){a+='<span class="sub-label">'+this.subFieldLabel+"</span>"}this.fieldLabel=a;this.labelSeparator=""}});Ext.define("OPF.core.component.form.ErrorHandler",{getValidatorErrors:function(n){var h=this,m=[],a=h.validator,b=h.customValidator,d=h.emptyText,c=h.allowBlank,f=h.vtype,j=Ext.form.field.VTypes,k=h.regex,l=Ext.String.format,e,g;n=n||h.processRawValue(h.getRawValue());if(Ext.isFunction(b)){e=b.call(h,n);Ext.each(e,function(o){if(o){m.push(o)}})}if(Ext.isFunction(a)){e=a.call(h,n);Ext.each(e,function(o){m.push(o)})}g=h.allowOnlyWhitespace?n:Ext.String.trim(n.toString());if(g.length<1||(n===h.emptyText&&h.valueContainsPlaceholder)){if(!c){m.push(h.blankText)}return m}if(n.length<h.minLength){m.push(l(h.minLengthText,h.minLength))}if(n.length>h.maxLength){m.push(l(h.maxLengthText,h.maxLength))}if(f){if(!j[f](n,h)){m.push(h.vtypeText||j[f+"Text"])}}if(k&&!k.test(n)){m.push(h.regexText||h.invalidText)}return m}});Ext.define("Ext.ux.form.field.BoxSelect",{extend:Ext.form.field.ComboBox,alias:["widget.comboboxselect","widget.boxselect"],multiSelect:true,forceSelection:true,createNewOnEnter:false,createNewOnBlur:false,encodeSubmitValue:false,triggerOnClick:true,stacked:false,pinList:true,filterPickList:false,selectOnFocus:true,grow:true,growMin:false,growMax:false,fieldSubTpl:['<div id="{cmpId}-listWrapper" class="x-boxselect {fieldCls} {typeCls}">','<ul id="{cmpId}-itemList" class="x-boxselect-list">','<li id="{cmpId}-inputElCt" class="x-boxselect-input">','<input id="{cmpId}-inputEl" type="{type}" ','<tpl if="name">name="{name}" </tpl>','<tpl if="value"> value="{[Ext.util.Format.htmlEncode(values.value)]}"</tpl>','<tpl if="size">size="{size}" </tpl>','<tpl if="tabIdx">tabIndex="{tabIdx}" </tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','class="x-boxselect-input-field {inputElCls}" autocomplete="off">',"</li>","</ul>","</div>",{compiled:true,disableFormats:true}],childEls:["listWrapper","itemList","inputEl","inputElCt"],componentLayout:"boxselectfield",initComponent:function(){var b=this,a=b.typeAhead;if(a&&!b.editable){Ext.Error.raise("If typeAhead is enabled the combo must be editable: true -- please change one of those settings.")}Ext.apply(b,{typeAhead:false});b.callParent();b.typeAhead=a;b.selectionModel=new Ext.selection.Model({store:b.valueStore,mode:"MULTI",lastFocused:null,onSelectChange:function(c,e,d,f){f()}});if(!Ext.isEmpty(b.delimiter)&&b.multiSelect){b.delimiterRegexp=new RegExp(String(b.delimiter).replace(/[$%()*+.?\[\\\]{|}]/g,"\\$&"))}},initEvents:function(){var a=this;a.callParent(arguments);if(!a.enableKeyEvents){a.mon(a.inputEl,"keydown",a.onKeyDown,a)}a.mon(a.inputEl,"paste",a.onPaste,a);a.mon(a.listWrapper,"click",a.onItemListClick,a);a.mon(a.selectionModel,{selectionchange:function(b,c){a.applyMultiselectItemMarkup();a.fireEvent("valueselectionchange",a,c)},focuschange:function(b,d,c){a.fireEvent("valuefocuschange",a,d,c)},scope:a})},onBindStore:function(a,b){var c=this;if(a){c.valueStore=new Ext.data.Store({model:a.model,proxy:{type:"memory"}});c.mon(c.valueStore,"datachanged",c.applyMultiselectItemMarkup,c);if(c.selectionModel){c.selectionModel.bindStore(c.valueStore)}}},onUnbindStore:function(a){var b=this,c=b.valueStore;if(c){if(b.selectionModel){b.selectionModel.setLastFocused(null);b.selectionModel.deselectAll();b.selectionModel.bindStore(null)}b.mun(c,"datachanged",b.applyMultiselectItemMarkup,b);c.destroy();b.valueStore=null}b.callParent(arguments)},createPicker:function(){var b=this,a=b.callParent(arguments);b.mon(a,{beforerefresh:b.onBeforeListRefresh,scope:b});if(b.filterPickList){a.addCls("x-boxselect-hideselections")}return a},onDestroy:function(){var a=this;Ext.destroyMembers(a,"valueStore","selectionModel");a.callParent(arguments)},getSubTplData:function(){var a=this,b=a.callParent(),c=a.emptyText&&b.value.length<1;if(c){b.value=a.emptyText}else{b.value=""}b.inputElCls=b.fieldCls.match(a.emptyCls)?a.emptyCls:"";return b},afterRender:function(){var a=this;if(Ext.supports.Placeholder&&a.inputEl&&a.emptyText){delete a.inputEl.dom.placeholder}a.bodyEl.applyStyles("vertical-align:top");if(a.grow){if(Ext.isNumber(a.growMin)&&(a.growMin>0)){a.listWrapper.applyStyles("min-height:"+a.growMin+"px")}if(Ext.isNumber(a.growMax)&&(a.growMax>0)){a.listWrapper.applyStyles("max-height:"+a.growMax+"px")}}if(a.stacked===true){a.itemList.addCls("x-boxselect-stacked")}if(!a.multiSelect){a.itemList.addCls("x-boxselect-singleselect")}a.applyMultiselectItemMarkup();a.callParent(arguments)},findRecord:function(d,c){var b=this.store,a;if(!b){return false}a=b.queryBy(function(e,f){return e.isEqual(e.get(d),c)});return(a.getCount()>0)?a.first():false},onLoad:function(){var b=this,a=b.valueField,c=b.valueStore,d=false;if(c){if(!Ext.isEmpty(b.value)&&(c.getCount()==0)){b.setValue(b.value,false,true)}c.suspendEvents();c.each(function(g){var f=b.findRecord(a,g.get(a)),e=f?c.indexOf(g):-1;if(e>=0){c.removeAt(e);c.insert(e,f);d=true}});c.resumeEvents();if(d){c.fireEvent("datachanged",c)}}b.callParent(arguments)},isFilteredRecord:function(a){var f=this,b=f.store,d=f.valueField,e,c=false;e=b.findExact(d,a.get(d));c=((e===-1)&&(!b.snapshot||(f.findRecord(d,a.get(d))!==false)));c=c||(!c&&(e===-1)&&(f.forceSelection!==true)&&(f.valueStore.findExact(d,a.get(d))>=0));return c},doRawQuery:function(){var a=this,b=a.inputEl.dom.value;if(a.multiSelect){b=b.split(a.delimiter).pop()}this.doQuery(b,false,true)},onBeforeListRefresh:function(){this.ignoreSelection++},onListRefresh:function(){this.callParent(arguments);if(this.ignoreSelection>0){--this.ignoreSelection}},onListSelectionChange:function(c,f){var b=this,d=b.valueStore,e=[],a;if((b.ignoreSelection<=0)&&b.isExpanded){d.each(function(g){if(Ext.Array.contains(f,g)||b.isFilteredRecord(g)){e.push(g)}});e=Ext.Array.merge(e,f);a=Ext.Array.intersect(e,d.getRange()).length;if((a!=e.length)||(a!=b.valueStore.getCount())){b.setValue(e,false);if(!b.multiSelect||!b.pinList){Ext.defer(b.collapse,1,b)}if(d.getCount()>0){b.fireEvent("select",b,d.getRange())}}b.inputEl.focus();if(!b.pinList){b.inputEl.dom.value=""}if(b.selectOnFocus){b.inputEl.dom.select()}}},syncSelection:function(){var f=this,d=f.picker,c=f.valueField,a,e,b;if(d){a=d.store;e=[];if(f.valueStore){f.valueStore.each(function(h){var g=a.findExact(c,h.get(c));if(g>=0){e.push(a.getAt(g))}})}f.ignoreSelection++;b=d.getSelectionModel();b.deselectAll();if(e.length>0){b.select(e)}if(f.ignoreSelection>0){--f.ignoreSelection}}},doAlign:function(){var d=this,c=d.picker,a="-above",b;d.picker.alignTo(d.listWrapper,d.pickerAlign,d.pickerOffset);b=c.el.getY()<d.inputEl.getY();d.bodyEl[b?"addCls":"removeCls"](d.openCls+a);c[b?"addCls":"removeCls"](c.baseCls+a)},alignPicker:function(){var c=this,b=c.picker,a=b.getTargetEl().dom.scrollTop;c.callParent(arguments);if(c.isExpanded){if(c.matchFieldWidth){b.setWidth(c.listWrapper.getWidth())}b.getTargetEl().dom.scrollTop=a}},getCursorPosition:function(){var a;if(Ext.isIE){a=document.selection.createRange();a.collapse(true);a.moveStart("character",-this.inputEl.dom.value.length);a=a.text.length}else{a=this.inputEl.dom.selectionStart}return a},hasSelectedText:function(){var b,a;if(Ext.isIE){b=document.selection;a=b.createRange();return(a.parentElement()==this.inputEl.dom)}else{return this.inputEl.dom.selectionStart!=this.inputEl.dom.selectionEnd}},onKeyDown:function(d,j){var f=this,h=d.getKey(),b=f.inputEl.dom.value,k=f.valueStore,c=f.selectionModel,a=false;if(f.readOnly||f.disabled||!f.editable){return}if(f.isExpanded&&(h==d.A&&d.ctrlKey)){f.select(f.getStore().getRange());c.setLastFocused(null);c.deselectAll();f.collapse();f.inputEl.focus();a=true}else{if((k.getCount()>0)&&((b=="")||((f.getCursorPosition()===0)&&!f.hasSelectedText()))){var g=(c.getCount()>0)?k.indexOf(c.getLastSelected()||c.getLastFocused()):-1;if((h==d.BACKSPACE)||(h==d.DELETE)){if(g>-1){if(c.getCount()>1){g=-1}f.valueStore.remove(c.getSelection())}else{f.valueStore.remove(f.valueStore.last())}c.clearSelections();f.setValue(f.valueStore.getRange());if(g>0){c.select(g-1)}a=true}else{if((h==d.RIGHT)||(h==d.LEFT)){if((g==-1)&&(h==d.LEFT)){c.select(k.last());a=true}else{if(g>-1){if(h==d.RIGHT){if(g<(k.getCount()-1)){c.select(g+1,d.shiftKey);a=true}else{if(!d.shiftKey){c.setLastFocused(null);c.deselectAll();a=true}}}else{if((h==d.LEFT)&&(g>0)){c.select(g-1,d.shiftKey);a=true}}}}}else{if(h==d.A&&d.ctrlKey){c.selectAll();a=d.A}}}f.inputEl.focus()}}if(a){f.preventKeyUpEvent=a;d.stopEvent();return}if(f.isExpanded&&(h==d.ENTER)&&f.picker.highlightedItem){f.preventKeyUpEvent=true}if(f.enableKeyEvents){f.callParent(arguments)}if(!d.isSpecialKey()&&!d.hasModifier()){f.selectionModel.setLastFocused(null);f.selectionModel.deselectAll();f.inputEl.focus()}},onKeyUp:function(d,a){var b=this,c=b.inputEl.dom.value;if(b.preventKeyUpEvent){d.stopEvent();if((b.preventKeyUpEvent===true)||(d.getKey()===b.preventKeyUpEvent)){delete b.preventKeyUpEvent}return}if(b.multiSelect&&(b.delimiterRegexp&&b.delimiterRegexp.test(c))||((b.createNewOnEnter===true)&&d.getKey()==d.ENTER)){c=Ext.Array.clean(c.split(b.delimiterRegexp));b.inputEl.dom.value="";b.setValue(b.valueStore.getRange().concat(c));b.inputEl.focus()}b.callParent([d,a])},onPaste:function(f,a){var b=this,d=b.inputEl.dom.value,c=(f&&f.browserEvent&&f.browserEvent.clipboardData)?f.browserEvent.clipboardData:false;if(b.multiSelect&&(b.delimiterRegexp&&b.delimiterRegexp.test(d))){if(c&&c.getData){if(/text\/plain/.test(c.types)){d=c.getData("text/plain")}else{if(/text\/html/.test(c.types)){d=c.getData("text/html")}}}d=Ext.Array.clean(d.split(b.delimiterRegexp));b.inputEl.dom.value="";b.setValue(b.valueStore.getRange().concat(d));b.inputEl.focus()}},onExpand:function(){var b=this,a=b.listKeyNav;b.callParent(arguments);if(a||!b.filterPickList){return}a=b.listKeyNav;a.highlightAt=function(e){var d=this.boundList,f=d.all.item(e),c=d.all.getCount(),g;if(f&&f.hasCls("x-boundlist-selected")){if((e==0)||!d.highlightedItem||(d.indexOf(d.highlightedItem)<e)){g=1}else{g=-1}do{e=e+g;f=d.all.item(e)}while((e>0)&&(e<c)&&f.hasCls("x-boundlist-selected"));if(f.hasCls("x-boundlist-selected")){return}}if(f){f=f.dom;d.highlightItem(f);d.getTargetEl().scrollChildIntoView(f,false)}}},onTypeAhead:function(){var f=this,e=f.displayField,h=f.inputEl.dom,k=f.valueStore,j=f.getPicker(),c,a,d,b;if(f.filterPickList){var g=this.createFilterFn(e,h.value);c=f.store.findBy(function(l){return((k.indexOfId(l.getId())===-1)&&g(l))});c=(c===-1)?false:f.store.getAt(c)}else{c=f.store.findRecord(e,h.value)}if(c){a=c.get(e);d=a.length;b=h.value.length;j.highlightItem(j.getNode(c));if(b!==0&&b!==d){h.value=a;f.selectText(b,a.length)}}},onItemListClick:function(a,c,e){var d=this,b=a.getTarget(".x-boxselect-item"),f=b?a.getTarget(".x-boxselect-item-close"):false;if(d.readOnly||d.disabled){return}a.stopPropagation();if(b){if(f){d.removeByListItemNode(b);if(d.valueStore.getCount()>0){d.fireEvent("select",d,d.valueStore.getRange())}}else{d.toggleSelectionByListItemNode(b,a.shiftKey)}d.inputEl.focus()}else{if(d.selectionModel.getCount()>0){d.selectionModel.setLastFocused(null);d.selectionModel.deselectAll()}if(d.triggerOnClick){d.onTriggerClick()}}},getMultiSelectItemMarkup:function(){var a=this;if(!a.multiSelectItemTpl){if(!a.labelTpl){a.labelTpl=Ext.create("Ext.XTemplate","{[values."+a.displayField+"]}")}else{if(Ext.isString(a.labelTpl)||Ext.isArray(a.labelTpl)){a.labelTpl=Ext.create("Ext.XTemplate",a.labelTpl)}}a.multiSelectItemTpl=['<tpl for=".">','<li class="x-boxselect-item ','<tpl if="this.isSelected(values.'+a.valueField+')">'," selected","</tpl>",'" qtip="{[typeof values === "string" ? values : values.'+a.displayField+']}">','<div class="x-boxselect-item-text">{[typeof values === "string" ? values : this.getItemLabel(values)]}</div>','<div class="x-tab-close-btn x-boxselect-item-close"></div>',"</li>","</tpl>",{compile:true,disableFormats:true,isSelected:function(c){var b=a.valueStore.findExact(a.valueField,c);if(b>=0){return a.selectionModel.isSelected(a.valueStore.getAt(b))}return false},getItemLabel:function(b){return a.getTpl("labelTpl").apply(b)}}]}return this.getTpl("multiSelectItemTpl").apply(Ext.Array.pluck(this.valueStore.getRange(),"data"))},applyMultiselectItemMarkup:function(){var c=this,a=c.itemList,b;if(a){while((b=c.inputElCt.prev())!=null){b.remove()}c.inputElCt.insertHtml("beforeBegin",c.getMultiSelectItemMarkup())}Ext.Function.defer(function(){if(c.picker&&c.isExpanded){c.alignPicker()}if(c.hasFocus){c.inputElCt.scrollIntoView(c.listWrapper)}},15)},getRecordByListItemNode:function(b){var d=this,c=0,a=d.itemList.dom.firstChild;while(a&&a.nextSibling){if(a==b){break}c++;a=a.nextSibling}c=(a==b)?c:false;if(c===false){return false}return d.valueStore.getAt(c)},toggleSelectionByListItemNode:function(b,d){var c=this,e=c.getRecordByListItemNode(b),a=c.selectionModel;if(e){if(a.isSelected(e)){if(a.isFocused(e)){a.setLastFocused(null)}a.deselect(e)}else{a.select(e,d)}}},removeByListItemNode:function(a){var b=this,c=b.getRecordByListItemNode(a);if(c){b.valueStore.remove(c);b.setValue(b.valueStore.getRange())}},getRawValue:function(){var b=this,c=b.inputEl,a;b.inputEl=false;a=b.callParent(arguments);b.inputEl=c;return a},setRawValue:function(c){var b=this,d=b.inputEl,a;b.inputEl=false;a=b.callParent([c]);b.inputEl=d;return a},addValue:function(b){var a=this;if(b){a.setValue(Ext.Array.merge(a.value,Ext.Array.from(b)))}},removeValue:function(b){var a=this;if(b){a.setValue(Ext.Array.difference(a.value,Ext.Array.from(b)))}},setValue:function(l,b,m){var k=this,o=k.valueStore,n=k.valueField,f,g,d,a,e,j=[];if(Ext.isEmpty(l)){l=null}if(Ext.isString(l)&&k.multiSelect){l=l.split(k.delimiter)}l=Ext.Array.from(l,true);for(d=0,g=l.length;d<g;d++){f=l[d];if(!f||!f.isModel){a=o.findExact(n,f);if(a>=0){l[d]=o.getAt(a)}else{a=k.findRecord(n,f);if(!a){if(k.forceSelection){j.push(f)}else{a={};a[k.valueField]=f;a[k.displayField]=f;a=new k.valueStore.model(a)}}if(a){l[d]=a}}}}if((m!==true)&&(j.length>0)&&(k.queryMode==="remote")){var c={};c[k.valueField]=j.join(k.delimiter);k.store.load({params:c,callback:function(){if(k.itemList){k.itemList.unmask()}k.setValue(l,b,true);k.autoSize()}});return false}if(!k.multiSelect&&(l.length>0)){for(d=l.length-1;d>=0;d--){if(l[d].isModel){l=l[d];break}}if(Ext.isArray(l)){l=l[l.length-1]}}return k.callParent([l,b])},getValueRecords:function(){return this.valueStore.getRange()},getSubmitData:function(){var a=this,b=a.callParent(arguments);if(a.multiSelect&&a.encodeSubmitValue&&b&&b[a.name]){b[a.name]=Ext.encode(b[a.name])}return b},mimicBlur:function(){var a=this;if(a.selectOnTab&&a.picker&&a.picker.highlightedItem){a.inputEl.dom.value=""}a.callParent(arguments)},assertValue:function(){var a=this,c=a.inputEl.dom.value,d=!Ext.isEmpty(c)?a.findRecordByDisplay(c):false,b=false;if(!d&&!a.forceSelection&&a.createNewOnBlur&&!Ext.isEmpty(c)){b=c}else{if(d){b=d}}if(b){a.addValue(b)}a.inputEl.dom.value="";a.collapse()},checkChange:function(){if(!this.suspendCheckChange&&!this.isDestroyed){var c=this,f=c.valueStore,b=c.lastValue,a=c.valueField,e=Ext.Array.map(Ext.Array.from(c.value),function(g){if(g.isModel){return g.get(a)}return g},this).join(this.delimiter),d=c.isEqual(e,b);if(!d||((e.length>0&&f.getCount()<e.length))){f.suspendEvents();f.removeAll();if(Ext.isArray(c.valueModels)){f.add(c.valueModels)}f.resumeEvents();f.fireEvent("datachanged",f);if(!d){c.lastValue=e;c.fireEvent("change",c,e,b);c.onChange(e,b)}}}},isEqual:function(h,g){var b=Ext.Array.from,c=this.valueField,d,a,f,e;h=b(h);g=b(g);a=h.length;if(a!==g.length){return false}for(d=0;d<a;d++){f=h[d].isModel?h[d].get(c):h[d];e=g[d].isModel?g[d].get(c):g[d];if(f!==e){return false}}return true},applyEmptyText:function(){var b=this,a=b.emptyText,c,d;if(b.rendered&&a){d=Ext.isEmpty(b.value)&&!b.hasFocus;c=b.inputEl;if(d){c.dom.value=a;c.addCls(b.emptyCls);b.listWrapper.addCls(b.emptyCls)}else{if(c.dom.value===a){c.dom.value=""}b.listWrapper.removeCls(b.emptyCls);c.removeCls(b.emptyCls)}b.autoSize()}},preFocus:function(){var b=this,c=b.inputEl,a=b.emptyText,d;if(a&&c.dom.value===a){c.dom.value="";d=true;c.removeCls(b.emptyCls);b.listWrapper.removeCls(b.emptyCls)}if(b.selectOnFocus||d){c.dom.select()}},onFocus:function(){var c=this,b=c.focusCls,a=c.itemList;if(b&&a){a.addCls(b)}c.callParent(arguments)},onBlur:function(){var c=this,b=c.focusCls,a=c.itemList;if(b&&a){a.removeCls(b)}c.callParent(arguments)},renderActiveError:function(){var d=this,c=d.invalidCls,b=d.itemList,a=d.hasActiveError();if(c&&b){b[a?"addCls":"removeCls"](d.invalidCls+"-field")}d.callParent(arguments)},autoSize:function(){var b=this,a;if(b.grow&&b.rendered){b.autoSizing=true;b.updateLayout()}return b},afterComponentLayout:function(){var b=this,a;if(b.autoSizing){height=b.getHeight();if(height!==b.lastInputHeight){if(b.isExpanded){b.alignPicker()}b.fireEvent("autosize",b,height);b.lastInputHeight=height;delete b.autoSizing}}}});Ext.define("Ext.ux.layout.component.field.BoxSelectField",{alias:["layout.boxselectfield"],extend:Ext.layout.component.field.Trigger,type:"boxselectfield",waitForOuterWidthInDom:true,beginLayout:function(c){var b=this,a=b.owner;b.callParent(arguments);c.inputElCtContext=c.getEl("inputElCt");a.inputElCt.setStyle("width","");b.skipInputGrowth=!a.grow||!a.multiSelect},beginLayoutFixed:function(d,b,e){var c=this,a=d.target;a.triggerEl.setStyle("height","24px");c.callParent(arguments);if(d.heightModel.fixed&&d.lastBox){a.listWrapper.setStyle("height",d.lastBox.height+"px");a.itemList.setStyle("height","100%")}},publishInnerWidth:function(e){var d=this,a=d.owner,c=a.itemList.getWidth(true)-10,b=a.inputElCt.prev(null,true);if(b&&!a.stacked){b=Ext.fly(b);c=c-b.getOffsetsTo(b.up(""))[0]-b.getWidth()}if(!d.skipInputGrowth&&(c<35)){c=c-10}else{if(c<1){c=1}}e.inputElCtContext.setWidth(c)}});Ext.define("OPF.core.component.form.BoxSelect",{extend:Ext.ux.form.field.BoxSelect,alias:["widget.opf-boxselect"],cls:"opf-boxselect-field",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(a){return this.getValidatorErrors(a)}});Ext.define("OPF.core.component.form.Checkbox",{extend:Ext.form.field.Checkbox,alias:["widget.opf-form-checkbox","widget.opf-checkbox"],cls:"opf-check-box",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(a){return this.getValidatorErrors(a)}});Ext.define("OPF.core.component.form.ComboBox",{extend:Ext.form.field.ComboBox,alias:["widget.opf-form-combo","widget.opf-combo"],cls:"opf-combo-field",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(a){return this.getValidatorErrors(a)},onListSelectionChange:function(b,d){var a=this,e=a.multiSelect,c=d.length>0;if(!a.ignoreSelection&&a.isExpanded){if(!e&&c){Ext.defer(a.collapse,1,a)}if(e||(c&&a.picker)){a.setValue(d,false)}if(c){a.fireEvent("select",a,d)}a.inputEl.focus()}},onExpand:function(){this.callParent();var a=this.getPicker();if(a&&a.pagingToolbar){a.pagingToolbar.doLayout()}},setDisplayField:function(a){this.displayField=a;this.displayTpl=new Ext.XTemplate('<tpl for=".">','{[typeof values === "string" ? values : values["'+this.displayField+'"]]}','<tpl if="xindex < xcount">'+this.delimiter+"</tpl>","</tpl>")}});Ext.define("OPF.core.component.form.Date",{extend:Ext.form.field.Date,alias:["widget.opf-form-date","widget.opf-date"],cls:"opf-date-field",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(p){var h=this,o=Ext.String.format,j=Ext.Date.clearTime,n=this.getValidatorErrors(p),m=h.disabledDays,d=h.disabledDatesRE,l=h.minValue,g=h.maxValue,f=m?m.length:0,e=0,a,b,k,c;p=h.formatDate(p||h.processRawValue(h.getRawValue()));if(p===null||p.length<1){return n}a=p;p=h.parseDate(p);if(!p){n.push(o(h.invalidText,a,h.format));return n}c=p.getTime();if(l&&c<j(l).getTime()){n.push(o(h.minText,h.formatDate(l)))}if(g&&c>j(g).getTime()){n.push(o(h.maxText,h.formatDate(g)))}if(m){k=p.getDay();for(;e<f;e++){if(k===m[e]){n.push(h.disabledDaysText);break}}}b=h.formatDate(p);if(d&&d.test(b)){n.push(o(h.disabledDatesText,b))}return n},notNullValidatorProcessor:function(c,b,e,a,f){if(!OPF.isNotBlank(b)){var d=OPF.isNotBlank(a)?a:"'"+c.getName()+"' should not be null";f.push(d)}}});Ext.define("OPF.core.component.form.FieldContainer",{extend:Ext.form.FieldContainer,alias:["widget.opf-form-fieldcontainer","widget.opf-fieldcontainer"],cls:"opf-field-container",mixins:{field:Ext.form.field.Field,subLabelable:OPF.core.component.form.SubLabelable},combineErrors:true,layout:"hbox",readOnly:false,validateOnBlur:true,findById:function(e){var d=this;var a=d.items.items.slice();var c=null;for(var b=0;b<a.length;b++){if(a[b].id==e||a[b].itemId==e){c=a[b];break}}return c}});Ext.define("OPF.core.component.form.DateTime",{extend:OPF.core.component.form.FieldContainer,alias:["widget.opf-form-datetime","widget.opf-datetime"],dateFormat:"Y-m-d",timeFormat:"H:i:s",dateTimeFormat:"Y-m-d H:i:s",dateConfig:{},timeConfig:{},dateValue:null,dateField:null,timeField:null,initComponent:function(){var b=this;b.items=b.items||[];b.dateField=Ext.create("Ext.form.field.Date",Ext.apply({format:b.dateFormat,flex:1,submitValue:false,margin:"0 5 0 0"},b.dateConfig));b.items.push(b.dateField);b.timeField=Ext.create("Ext.form.field.Time",Ext.apply({format:b.timeFormat,flex:1,submitValue:false},b.timeConfig));b.items.push(b.timeField);for(var a=0;a<b.items.length;a++){b.items[a].on("change",Ext.bind(b.validateOnChange,b));b.items[a].on("focus",Ext.bind(b.onItemFocus,b));b.items[a].on("blur",Ext.bind(b.onItemBlur,b));b.items[a].on("specialkey",function(f,e){var c=e.getKey(),d=c==e.TAB;if(d&&b.focussedItem==b.dateField){e.stopEvent();b.timeField.focus();return}b.fireEvent("specialkey",f,e)})}b.callParent()},focus:function(){this.callParent();this.dateField.focus()},onBlur:function(){this.validateOnChange()},onItemFocus:function(a){if(this.blurTask){this.blurTask.cancel()}this.focussedItem=a},onItemBlur:function(b){var a=this;if(b!=a.focussedItem){return}a.blurTask=new Ext.util.DelayedTask(function(){a.fireEvent("blur",a);a.onBlur()});a.blurTask.delay(100)},validateOnChange:function(){if(this.validateOnBlur){this.validate()}},getValue:function(){var b=null,a=this.dateField.getSubmitValue(),d=this.timeField.getSubmitValue();if(a){if(d){var c=this.getFormat();b=Ext.Date.parse(a+" "+d,c)}else{b=this.dateField.getValue()}}return b},getSubmitValue:function(){var a=this.getValue();return a?Ext.Date.format(a,this.dateTimeFormat):null},setValue:function(a){if(Ext.isString(a)){a=Ext.Date.parse(a,this.dateTimeFormat)}if(OPF.isNotEmpty(a)&&!isNaN(a.getTime())){this.dateField.setValue(a);this.timeField.setValue(a)}},getFormat:function(){return(this.dateField.submitFormat||this.dateField.format)+" "+(this.timeField.submitFormat||this.timeField.format)},getSubmitData:function(){var a=this,b=null;if(!a.disabled&&a.submitValue&&!a.isFileUpload()){b={};b[a.getName()]=""+a.getSubmitValue()}return b},getRawValue:function(){return this.getValue()},processRawValue:function(a){return a},getErrors:function(a){var c=[];a=a||this.getValue();if(Ext.isFunction(this.validator)){var b=this.validator(a);if(OPF.isNotBlank(b)){c.push(b)}}return c},isValid:function(){var a=this;return a.disabled||a.validateValue(a.processRawValue(a.getRawValue()))},validateValue:function(b){var a=this,d=a.getErrors(b),c=Ext.isEmpty(d);if(!a.preventMark){if(c){a.clearInvalid()}else{a.markInvalid(d)}}return c},markInvalid:function(c){var b=this,a=b.getActiveError();b.setActiveErrors(Ext.Array.from(c));if(a!==b.getActiveError()){b.doComponentLayout()}},clearInvalid:function(){var b=this,a=b.hasActiveError();b.unsetActiveError();if(a){b.doComponentLayout()}}});Ext.define("OPF.core.component.form.Display",{extend:Ext.form.field.Display,alias:["widget.opf-form-display","widget.opf-display"],cls:"opf-display",mixins:{subLabelable:OPF.core.component.form.SubLabelable},initComponent:function(){this.initSubLabelable();this.callParent()}});Ext.define("OPF.core.component.form.File",{extend:Ext.form.field.File,alias:["widget.opf-form-file","widget.opf-file"],cls:"opf-text-field",allowBlank:false,msgTarget:"side",emptyText:"Select a file to upload",buttonConfig:{text:"",iconCls:"upload-icon",cls:"upload-btn",height:28,width:28},mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.regex=new RegExp(".*?\\.("+this.fileTypes.join("|")+")","i");this.regexText="Uploaded file has wrong extension.";this.initSubLabelable();this.callParent()},getErrors:function(a){return this.getValidatorErrors(a)}});Ext.define("OPF.core.component.form.Text",{extend:Ext.form.field.Text,alias:["widget.opf-form-text","widget.opf-text","widget.opf-textfield"],cls:"opf-text-field",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(a){return this.getValidatorErrors(a)}});Ext.define("OPF.core.component.form.Hidden",{extend:OPF.core.component.form.Text,alias:["widget.opf-form-hidden","widget.opf-hidden"],inputType:"hidden",hideLabel:true,initComponent:function(){this.formItemCls+="-hidden";this.callParent()},isEqual:function(b,a){return this.isEqualAsString(b,a)},setSize:Ext.emptyFn,setWidth:Ext.emptyFn,setHeight:Ext.emptyFn,setPosition:Ext.emptyFn,setPagePosition:Ext.emptyFn});Ext.define("OPF.core.component.form.HtmlEditor",{extend:Ext.form.field.HtmlEditor,alias:["widget.opf-form-htmleditor","widget.opf-htmleditor"],mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(a){return this.getValidatorErrors(a)},processRawValue:function(a){return a||""},getRawValue:function(){return this.getValue()}});Ext.define("OPF.core.component.form.Number",{extend:Ext.form.field.Number,alias:["widget.opf-form-number","widget.opf-number"],currencySymbol:null,useThousandSeparator:true,thousandSeparator:",",alwaysDisplayDecimals:false,cls:"opf-number-field",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){if(this.useThousandSeparator&&this.decimalSeparator==","&&this.thousandSeparator==","){this.thousandSeparator="."}else{if(this.allowDecimals&&this.thousandSeparator=="."&&this.decimalSeparator=="."){this.decimalSeparator=","}}this.initSubLabelable();this.callParent(arguments)},getErrors:function(b){var a=this.removeFormat(b);return this.getValidatorErrors(a)},setValue:function(a){OPF.core.component.form.Number.superclass.setValue.call(this,a!=null?a.toString().replace(".",this.decimalSeparator):a);this.setRawValue(this.getFormattedValue(this.getValue()))},getFormattedValue:function(a){return OPF.core.component.form.Number.formattedValue(a,this)},parseValue:function(a){return OPF.core.component.form.Number.superclass.parseValue.call(this,this.removeFormat(a))},removeFormat:function(a){if(Ext.isEmpty(a)){return null}else{if(!this.hasFormat()){return a}else{a=a.toString().replace(this.currencySymbol+" ","");a=this.useThousandSeparator?a.replace(new RegExp("["+this.thousandSeparator+"]","g"),""):a;return a}}},hasFormat:function(){return OPF.core.component.form.Number.hasFormat(this.getRawValue(),this)},onFocus:function(){this.setRawValue(this.removeFormat(this.getRawValue()));this.callParent(arguments)},notNullValidatorProcessor:function(c,b,e,a,f){if(!OPF.isNotBlank(b)){var d=OPF.isNotBlank(a)?a:"'"+c.getName()+"' should not be null";f.push(d)}}});OPF.core.component.form.Number.formattedValue=function(e,a){if(Ext.isEmpty(e)||!OPF.core.component.form.Number.hasFormat(e,a)){return e}else{var g=null;e=(g=e<0)?e*-1:e;e=a.allowDecimals&&a.alwaysDisplayDecimals?e.toFixed(a.decimalPrecision):e;if(a.useThousandSeparator){if(a.useThousandSeparator&&Ext.isEmpty(a.thousandSeparator)){throw ("NumberFormatException: invalid thousandSeparator, property must has a valid character.")}if(a.thousandSeparator==a.decimalSeparator){throw ("NumberFormatException: invalid thousandSeparator, thousand separator must be different from decimalSeparator.")}e=e.toString();var f=e.split(".");f[1]=f[1]?f[1]:null;var d=f[0];var c=/(\d+)(\d{3})/;var b=a.thousandSeparator;while(c.test(d)){d=d.replace(c,"$1"+b+"$2")}e=d+(f[1]?a.decimalSeparator+f[1]:"")}return Ext.String.format("{0}{1}{2}",(g?"-":""),(Ext.isEmpty(a.currencySymbol)?"":a.currencySymbol+" "),e)}};OPF.core.component.form.Number.hasFormat=function(b,a){return a.decimalSeparator!="."||(a.useThousandSeparator&&b!=null)||!Ext.isEmpty(a.currencySymbol)||a.alwaysDisplayDecimals};Ext.define("OPF.core.component.form.Rating",{extend:Ext.form.field.Base,alias:["widget.opf-form-rating","widget.opf-rating"],cls:"opf-rating-field",ratingPoints:10,ratingImageUrl:null,ratingImageHeight:32,ratingImageWidth:32,ratingImagePadding:{top:0,left:0,right:0,bottom:0},fieldSubTpl:['<input id="{id}" type="hidden" {inputAttrTpl}','<tpl if="name"> name="{name}"</tpl>','<tpl if="value"> value="{[Ext.util.Format.htmlEncode(values.value)]}"</tpl>',"/>",'<div class="rating-column" style="position: relative">','<div class="rating-points" style="height: {ratingHeight}px; width: {ratingWidth}px; background: url({ratingImageUrl}) repeat-x 0 0;"></div>','<div class="rating-active" style="position: absolute; top: 0; left: 0; height: {ratingHeight}px; width: {ratingActiveWidth}px; background: url({ratingImageUrl}) repeat scroll left ','<tpl if="isSelectedRating">center<tpl else>bottom</tpl>',' transparent;"></div>',"</div>",{disableFormats:true}],mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},selectedRating:null,isSelectedRating:null,initComponent:function(){this.addEvents("ratingclick");this.initSubLabelable();this.callParent();this.resetTask=new Ext.util.DelayedTask(function(){this.resetSelectedRating(false)},this)},getSubTplData:function(){var c=this.callParent();this.isSelectedRating=true;var b=Ext.isNumeric(this.getSelectedRating())?parseFloat(this.getSelectedRating()):null;if(!b){b=Ext.isNumeric(this.getValue())?parseFloat(this.getValue()):0;this.isSelectedRating=false}var d=this.calculateWidth(b);var a={isSelectedRating:this.isSelectedRating,ratingHeight:this.ratingImageHeight,ratingWidth:this.ratingImageWidth*this.ratingPoints,ratingImageUrl:this.ratingImageUrl,ratingActiveWidth:d,tooltip:"Rating: "+Math.round(b*100)/100};return Ext.apply(c,a)},getErrors:function(a){return this.getValidatorErrors(a)},afterRender:function(a){this.callParent(arguments);this.initRatingMouseEvents()},initRatingMouseEvents:function(){this.ratingPointsEl=this.getEl().down(".rating-points");this.ratingActiveEl=this.getEl().down(".rating-active");if(!this.isSelectedRating&&!this.readOnly){this.ratingPointsEl.on({mouseover:this.onMouseOver,mousemove:this.onMouseOver,mouseout:this.onMouseOut,click:this.onClick,scope:this});this.ratingActiveEl.on({mouseover:this.onMouseOver,mousemove:this.onMouseOver,mouseout:this.onMouseOut,click:this.onClick,scope:this})}},onClick:function(){if(this.fireEvent("ratingclick",this,this.getValue(),this.selectedRating)!==false){this.oldValue=this.getValue();this.setValue(this.selectedRating);this.isSelectedRating=true;this.ratingPointsEl.un({mouseover:this.onMouseOver,mousemove:this.onMouseOver,mouseout:this.onMouseOut,click:this.onClick,scope:this});this.ratingActiveEl.un({mouseover:this.onMouseOver,mousemove:this.onMouseOver,mouseout:this.onMouseOut,click:this.onClick,scope:this})}},onMouseOver:function(d,a){this.resetTask.cancel();var b=Ext.fly(a).getXY();var e=[d.browserEvent.clientX,d.browserEvent.clientY];var c=(e[0]-b[0]);this.selectedRating=this.calculateValue(c)},onMouseOut:function(){this.resetTask.delay(100)},getSelectedRating:function(){return this.selectedRating},setSelectedRating:function(a){this.selectedRating=a;this.isSelectedRating=true;var b=this.calculateWidth(a);this.ratingActiveEl.setWidth(b);this.ratingActiveEl.setStyle({"background-position":"left center"})},refreshRating:function(){var a=Ext.isNumeric(this.getValue())?parseFloat(this.getValue()):0;var b=this.calculateWidth(a);this.ratingActiveEl.setWidth(b);this.ratingActiveEl.setStyle({"background-position":"left bottom"})},calculateValue:function(c){var b=this.ratingImageWidth*this.ratingPoints;var f=this.ratingImageWidth-(this.ratingImagePadding.left+this.ratingImagePadding.right);var e=Math.ceil(c/this.ratingImageWidth);var a=e*this.ratingImageWidth;var d=c-a;if(d>this.ratingImagePadding.left){a+=this.ratingImageWidth;e++}this.ratingActiveEl.setWidth(a);this.ratingActiveEl.setStyle({"background-position":"left center"});return e},calculateWidth:function(b){var a=Math.floor(b);var d=b-Math.floor(b);var c=this.ratingImageWidth-(this.ratingImagePadding.left+this.ratingImagePadding.right);return Math.round(this.ratingImageWidth*a+this.ratingImagePadding.left+c*d)},resetSelectedRating:function(a){if(!this.isSelectedRating||a){this.isSelectedRating=false;this.refreshRating()}},reset:function(){this.setValue(this.oldValue);this.resetSelectedRating(true);this.initRatingMouseEvents()}});Ext.define("OPF.console.domain.view.ReferenceHtmlEditor",{extend:Ext.form.field.HtmlEditor,alias:"widget.opf-reference-htmleditor",height:28,cls:"opf-reference-htmleditor",enableFormat:false,enableFontSize:false,enableColors:false,enableAlignments:false,enableLists:false,enableSourceEdit:false,enableLinks:false,enableFont:false,enableKeyEvents:true,keyUpFn:Ext.emptyFn(),mixins:{subLabelable:OPF.core.component.form.SubLabelable},listeners:{afterrender:function(b){var c=b.iframeEl.dom;var a=Ext.create("Ext.dd.DropTarget",c,{ddGroup:"fieldGridDDGroup",notifyEnter:function(g,f,d){b.iframeEl.stopAnimation();b.iframeEl.highlight()},notifyDrop:function(h,l,g){var j=g.records[0];var k=j.data.id;var m=j.data.name;var d=OPF.textToImage(m,"21px Tahoma");var f={fieldId:k,fieldName:m};var n=Ext.JSON.encode(f).replace(/"/g,"'");b.activated=true;b.insertAtCursor('<img src="'+d.base64Src+'" width="'+d.width+'" height="'+d.height+'" style="vertical-align: middle;" data="'+n+'"/>');b.keyUpFn();return true}})}},constructor:function(a){a=a||{};a.listeners=a.listeners||{};this.keyUpFn=a.listeners.keyup;a.listeners=Ext.apply(a.listeners,a.listeners,this.listeners);this.superclass.constructor.call(this,a)},initComponent:function(){this.initSubLabelable();this.callParent()},initEditor:function(){this.callParent(arguments);var a=this;var b=a.getDoc();if(Ext.isGecko){Ext.EventManager.on(b,"keyup",a.keyUpFn,a)}if(Ext.isIE||Ext.isWebKit||Ext.isOpera){Ext.EventManager.on(b,"keyup",a.keyUpFn,a)}},getHtmlValue:function(){var a=this,b;if(!a.sourceEditMode){a.syncValue()}b=a.rendered?a.textareaEl.dom.value:a.value;a.value=b;return b},getValue:function(){var b=this.callParent(arguments);if(OPF.isNotBlank(b)){b=b.replace(/\u200B/,"");var a=/(<img)[^<>]*?src=[^<>]*?(data="\{[^{}]*?\}")[^<>]*?(>)/g;while(b.search(a)!=-1){b=b.replace(a,"$1 $2 $3")}b=b.replace(/<\/?br\/?>/g,"")}return b},setValue:function(f){if(OPF.isNotBlank(f)){var c=/<img[^<>"]*?data="(\{[^{}]*?\})"[^<>]*?>/i;while(f.search(c)!=-1){var b=f.match(c);var e=b[0];var a=b[1];var h=a.match(/fieldname['"]\s*:\s*['"]([^"]*?)['"]/i)[1];var g=OPF.textToImage(h,"21px Tahoma");var d='<img src="'+g.base64Src+'" width="'+g.width+'" height="'+g.height+'" style="vertical-align: middle;" data="'+a+'"/>';f=f.replace(e,d)}}return this.callParent(arguments)}});Ext.define("OPF.core.component.form.SearchComboBox",{extend:OPF.core.component.form.FieldContainer,alias:["widget.opf-searchcombo"],layout:"anchor",name:null,fieldLabel:null,subFieldLabel:null,multiSelect:true,readOnly:false,model:null,validator:null,constructor:function(a){a=a||{};this.addEvents("onBeforeStoreLoad");OPF.core.component.form.SearchComboBox.superclass.constructor.call(this,a)},initComponent:function(){var d=this;this.initializedModel=Ext.create(this.model);this.selectedItemsStore=Ext.create("Ext.data.Store",{model:this.model});var b;var g;if(OPF.isNotEmpty(this.initializedModel.self.template)){b=this.initializedModel.self.template.join("");g=this.getFieldsFromTemplate()}else{b="{"+this.initializedModel.displayProperty+"}";var f=d.findModelField(this.initializedModel,this.initializedModel.displayProperty);g=[f]}var c=new Ext.XTemplate('<ul class="x-boxselect-list">','<tpl for=".">','<li class="x-boxselect-item item-wrap">','<div class="x-boxselect-item-text">',b,"</div>",'<tpl if="this.allowToDelete()">','<div class="x-tab-close-btn x-boxselect-item-close"></div>',"</tpl>","</li>","</tpl>","</ul>",{disableFormats:true,allowToDelete:function(){return !d.readOnly}});this.selectedItemsView=Ext.create("Ext.view.View",{store:this.selectedItemsStore,tpl:c,itemSelector:"li.item-wrap",readOnly:this.readOnly,listeners:{itemclick:function(j,h,l,k,m){if(m.getTarget(".x-boxselect-item-close")){d.removeSelectSearchedItem(h)}}}});this.searchComboStore=Ext.create("Ext.data.Store",{model:this.model,proxy:{type:"ajax",url:this.initializedModel.self.restSuffixUrl+"/advanced-search",reader:{type:"json",root:"data"},startParam:"offset",limitParam:"limit"},pageSize:10,autoLoad:false,listeners:{beforeload:function(j){var h=d.searchCombo.getRawValue();d.fireEvent("onBeforeStoreLoad",d,j,h)}}});var e=OPF.isNotEmpty(this.validator)&&Ext.isFunction(this.validator)?this.validator:null;var a={store:this.searchComboStore,excludeStore:this.selectedItemsStore,cls:"opf-combo-field",anchor:"100%",valueField:this.initializedModel.idProperty,displayField:this.initializedModel.displayProperty,searchFields:g,queryMode:"remote",queryCaching:false,typeAhead:true,typeAheadDelay:250,getParams:this.getParams,forceSelection:false,triggerAction:"query",minChars:0,pageSize:10,listeners:{select:this.selectSearchedItem,scope:this},listConfig:{loadingText:"Searching...",emptyText:"No matching items found.",getInnerTpl:function(){return b}},hidden:this.readOnly,validator:e};this.searchCombo=Ext.create("OPF.core.component.form.ComboBox",a);this.items=[this.selectedItemsView,this.searchCombo];d.callParent()},getParams:function(e){var c=this;var a=[];var d=this.excludeStore.getRange();Ext.each(d,function(f){a.push(f.get(c.valueField))});var b=[];Ext.each(this.searchFields,function(g){if(g.type.type=="string"){var f=[];if(OPF.isNotBlank(e)){f.push({field:g.name,operation:"LIKE",value:e});if(a.length>0){f.push({field:c.valueField,operation:"NOTIN",value:a})}b.push(f)}}});if(b.length==0&&a.length>0){b.push([{field:c.valueField,operation:"NOTIN",value:a}])}return{queryParameters:Ext.encode(b)}},selectSearchedItem:function(d,a,b){var c=this;Ext.Array.each(a,function(e){if(!c.multiSelect){c.selectedItemsStore.removeAll()}c.selectedItemsStore.add(e)});d.clearValue()},removeSelectSearchedItem:function(a){this.selectedItemsStore.remove(a)},getValue:function(){var c=this;var b=[];var a=this.selectedItemsStore.getRange();Ext.Array.each(a,function(d){b.push(d.get(c.initializedModel.idProperty))});return b},getSubmitValue:function(){return this.getValue()},getSubmitData:function(){var a=this,b=null;if(!a.disabled&&a.submitValue&&!a.isFileUpload()){b={};b[a.getName()]=a.getSubmitValue()}return b},setValue:function(a){this.selectedItemsStore.removeAll();if(a){this.selectedItemsStore.add(a)}},setReadOnly:function(c){var b=this,a=b.readOnly;if(c!=a){b.readOnly=c;this.searchCombo.setVisible(!c);this.selectedItemsView.readOnly=c;this.selectedItemsView.refresh()}},getFieldsFromTemplate:function(){var c=this;var b=this.initializedModel.self.template[0];var a=[];var d=b.match(/\{[\w\.]+\}/gi);Ext.each(d,function(e){var g=e.substring(1,e.length-1);var f=c.findModelField(c.initializedModel,g);if(OPF.isNotEmpty(f)){a.push(f)}});return a},findModelField:function(a,c){var b=null;Ext.each(a.fields.items,function(d){if(d.name==c){b=d}});return b}});Ext.define("OPF.core.component.form.TextArea",{extend:Ext.form.field.TextArea,alias:["widget.opf-form-textarea","widget.opf-textarea"],cls:"opf-text-area",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(a){return this.getValidatorErrors(a)}});Ext.define("OPF.core.component.form.Time",{extend:Ext.form.field.Time,alias:["widget.opf-form-time","widget.opf-time"],cls:"opf-time-field",mixins:{subLabelable:OPF.core.component.form.SubLabelable,errorHandler:OPF.core.component.form.ErrorHandler},initComponent:function(){this.initSubLabelable();this.callParent()},getErrors:function(d){var b=this,f=Ext.String.format,g=this.getValidatorErrors(d),c=b.minValue,e=b.maxValue,a;d=b.formatDate(d||b.processRawValue(b.getRawValue()));if(d===null||d.length<1){return g}a=b.parseDate(d);if(!a){g.push(f(b.invalidText,d,b.format));return g}if(c&&a<c){g.push(f(b.minText,b.formatDate(c)))}if(e&&a>e){g.push(f(b.maxText,b.formatDate(e)))}return g},notNullValidatorProcessor:function(c,b,e,a,f){if(!OPF.isNotBlank(b)){var d=OPF.isNotBlank(a)?a:"'"+c.getName()+"' should not be null";f.push(d)}}});Ext.define("OPF.core.component.grid.Column",{extend:Ext.grid.column.Column,alias:"widget.opf-column",displayField:"name",statics:{renderer:function(k,h,f,g,m,l,j){var c=j.headerCt.getGridColumns()[m];var b=l.model.prototype.associations;var a=b.get(c.dataIndex);if(a&&f[a.instanceName]){var e=f[a.instanceName];var d=OPF.ModelHelper.getProperty(e,c.displayField);if(d||!c.alternatePropertyName){return d}}if(c.alternatePropertyName){return f.get(c.alternatePropertyName)}else{return k}}},renderer:function(f,e,b,g,d,c,a){return OPF.core.component.grid.Column.renderer(f,e,b,g,d,c,a)},getSortParam:function(){var a=this.dataIndex;if(this.displayField){a+="."+this.displayField}return a}});Ext.define("OPF.core.component.grid.RatingColumn",{extend:Ext.grid.column.Column,alias:"widget.opf-rating-column",ratingPoints:10,ratingImageUrl:null,ratingImageHeight:32,ratingImageWidth:32,ratingImagePadding:{top:0,left:0,right:0,bottom:0},tpl:new Ext.XTemplate('<div class="rating-column" style="position: relative" data-qtip="{tooltip}">','<div class="rating-points" style="height: {ratingHeight}px; width: {ratingWidth}px; background: url({ratingImageUrl}) repeat-x 0 0;"></div>','<div class="rating-active" style="position: absolute; top: 0; left: 0; height: {ratingHeight}px; width: {ratingActiveWidth}px; background: url({ratingImageUrl}) repeat scroll left bottom transparent;"></div>',"</div>"),initComponent:function(){var a=this;a.hasCustomRenderer=true;a.callParent(arguments)},defaultRenderer:function(d,f,a){var b=Math.floor(d);var h=d-Math.floor(d);var e=this.ratingImageWidth-(this.ratingImagePadding.left+this.ratingImagePadding.right);var g=Math.round(this.ratingImageWidth*b+this.ratingImagePadding.left+e*h);var c={ratingHeight:this.ratingImageHeight,ratingWidth:this.ratingImageWidth*this.ratingPoints,ratingImageUrl:this.ratingImageUrl,ratingActiveWidth:g,tooltip:"Rating: "+Math.round(d*100)/100};return this.tpl.apply(c)}});Ext.define("OPF.core.component.grid.RowToolbarGridPlugin",{extend:Ext.AbstractPlugin,alias:"widget.opf-row-toolbar-grid-plugin",buttons:[],showBtnWidth:39,showBtnHeight:60,init:function(a){var b=this;a.on("itemmouseenter",this.gridItemMouseEnter);a.on("itemmouseleave",this.gridItemMouseLeave);a.buttons=this.buttons;Ext.each(this.buttons,function(c){a[c.name+"Fn"]=b[c.name+"Fn"]});a.showFn=this.showFn;a.showBtnWidth=this.showBtnWidth;a.showBtnHeight=this.showBtnHeight;a.scope=this.scope},gridItemMouseEnter:function(b,a,h,c,j){var g=this;b.rowElement=Ext.get(h);b.rowElement.setStyle("position","relative");b.currentRecord=a;if(OPF.isEmpty(b.rowCmp)){b.buttons=b.buttons||b.ownerCt.buttons;Ext.each(b.buttons,function(e){b[e.name+"RecordButton"]=Ext.create("Ext.button.Button",{tooltip:e.tooltip||Ext.String.capitalize(e.name),ui:"action",width:e.width||26,height:e.height||26,iconCls:e.iconCls||(e.name+"-btn"),hidden:true})});b.showRowToolbarButton=Ext.create("Ext.button.Button",{text:">>",width:this.showBtnWidth,height:this.showBtnHeight,handler:this.showFn,scope:b,hideMode:"visibility"});var f=[b.showRowToolbarButton];Ext.each(b.buttons,function(e){f.push(b[e.name+"RecordButton"])});b.rowCmp=Ext.create("Ext.container.Container",{cls:"row-action-toolbar",renderTo:b.rowElement,items:f})}else{b.rowCmp.getEl().appendTo(b.rowElement)}var d=b.rowElement.getSize();b.rowCmp.show();b.rowCmp.setHeight(d.height);b.rowCmp.setPosition(0,d.height*c);Ext.each(b.buttons,function(e){b[e.name+"RecordButton"].on("click",g[e.name+"Fn"],g.scope,[b,a,c])})},gridItemMouseLeave:function(b,a,f,c,g){var d=this;if(b.rowCmp){b.rowCmp.setWidth(b.showRowToolbarButton.getWidth());b.rowCmp.hide();b.showRowToolbarButton.show();Ext.each(b.buttons,function(e){b[e.name+"RecordButton"].hide();b[e.name+"RecordButton"].un("click",d[e.name+"Fn"],d.scope)})}},showFn:function(){var b=this;var a=this.rowElement.getSize();this.rowCmp.setWidth(a.width);this.showRowToolbarButton.hide();Ext.each(this.buttons,function(c){b[c.name+"RecordButton"].show()})}});Ext.define("OPF.core.component.htmleditor.SimpleHtmlEditor",{extend:Ext.form.field.HtmlEditor,alias:"widget.simplehtmleditor",enableAlignments:false,enableColors:false,enableFont:false,enableFontSize:false,enableLinks:false,sourceEditMode:true,initComponent:function(){this.plugins=OPF.core.component.htmleditor.plugins.HtmlEditorPlugins.plugins();this.callParent(arguments)},getValue:function(){var a=OPF.core.component.htmleditor.SimpleHtmlEditor.superclass.getValue.call(this);a=a.replace(/<link[^<>]*?\/?>/g,"");return a},setValue:function(a){a='<link type="text/css" rel="stylesheet" href="'+OPF.Cfg.OPF_CONSOLE_URL+'/css/simple-html-editor.css">'+a;OPF.core.component.htmleditor.SimpleHtmlEditor.superclass.setValue.call(this,a)}});Ext.define("OPF.core.component.htmleditor.plugins.SpecialHeadingFormats",{extend:Ext.util.Observable,formatInstructions:[{id:"normal",labelName:"Normal",shortName:"nor",tagName:null,className:null},{id:"h1",labelName:"H1",shortName:"h1",tagName:"H1",className:null},{id:"h2",labelName:"H2",shortName:"h2",tagName:"H2",className:null},{id:"h3",labelName:"H3",shortName:"h3",tagName:"H3",className:null},{id:"quote",labelName:"Quote",shortName:"qot",tagName:"DIV",className:"quote"},{id:"code",labelName:"Code",shortName:"cod",tagName:"DIV",className:"code"},{id:"warning",labelName:"Warning",shortName:"wrn",tagName:"SPAN",className:"warn"},{id:"important",labelName:"Important",shortName:"imp",tagName:"SPAN",className:"important"},{id:"critical",labelName:"Critical",shortName:"crt",tagName:"SPAN",className:"critical"},{id:"subdued",labelName:"Subdued",shortName:"sub",tagName:"SPAN",className:"subdued"}],init:function(a){this.cmp=a;this.cmp.on("render",this.onRender,this)},onRender:function(){var a=this;var b=this.cmp;Ext.each(this.formatInstructions,function(c){a.cmp.getToolbar().add({xtype:"button",iconCls:"editor-without-image",tooltip:c.labelName,text:c.shortName,handler:function(d,e){a.applyFormatStyle(c)},scope:b})})},applyFormatStyle:function(a){if(this.cmp.win.getSelection||this.cmp.getDoc().getSelection){OPF.Msg.setAlert(true,"FF");var c=this.cmp.win.getSelection();if(!c){c=this.cmp.getDoc().getSelection()}var g=this.cmp.win.getSelection().getRangeAt(0);var b=g.cloneContents();var f,j=false;Ext.each(b.childNodes,function(k){if(k.nodeType!==3){j=true}});if(j){f=this.cmp.win.getSelection()+""}else{f=b.textContent}if(a.id=="normal"){g.deleteContents();g.insertNode(this.cmp.getDoc().createTextNode(f))}else{var e=this.cmp.getDoc().createElement(a.tagName);e.className=a.className;e.innerHTML=g;g.deleteContents();g.insertNode(e)}}else{if(this.cmp.getDoc().selection){OPF.Msg.setAlert(true,"IE");this.cmp.win.focus();g=this.cmp.getDoc().selection.createRange();OPF.Msg.setAlert(true,g.text);if(a.id=="normal"){g.pasteHTML(this.cmp.getDoc().selection)}else{var d="<"+a.tagName+(a.className!=null?' class="'+a.className+'"':"")+">";var h="</"+a.tagName+">";g.pasteHTML(d+g.text+h)}}}}});Ext.ns("OPF.core.component.htmleditor.plugins.HtmlEditorPlugins");OPF.core.component.htmleditor.plugins.HtmlEditorPlugins.plugins=function(){return[new OPF.core.component.htmleditor.plugins.SpecialHeadingFormats()]};Ext.define("OPF.core.component.htmleditor.plugins.SpecialHeadingFormat",{extend:Ext.util.Observable,formatInstructions:[{id:"normal",labelName:"Normal",tagName:null,className:null},{id:"h1",labelName:"H1",tagName:"H1",className:null},{id:"h2",labelName:"H2",tagName:"H2",className:null},{id:"h3",labelName:"H3",tagName:"H3",className:null},{id:"quote",labelName:"Quote",tagName:"DIV",className:"quote"},{id:"code",labelName:"Code",tagName:"DIV",className:"code"},{id:"warning",labelName:"Warning",tagName:"SPAN",className:"warn"},{id:"important",labelName:"Important",tagName:"SPAN",className:"important"},{id:"critical",labelName:"Critical",tagName:"SPAN",className:"critical"},{id:"subdued",labelName:"Subdued",tagName:"SPAN",className:"subdued"}],init:function(a){this.cmp=a;this.cmp.on("render",this.onRender,this)},onRender:function(){var a=this;var c=this.cmp;var b=this.cmp.getToolbar().addItem({xtype:"combo",displayField:"display",valueField:"value",name:"headingsize",forceSelection:false,mode:"local",selectOnFocus:false,editable:false,typeAhead:true,triggerAction:"all",width:65,emptyText:"Heading",store:{xtype:"arraystore",autoDestroy:true,fields:["value","display"],data:[["normal","Normal"],["h1","H1"],["h2","H2"],["h3","H3"],["quote","Quote"],["code","Code"],["warning","Warning"],["important","Important"],["critical","Critical"],["subdued","Subdued"]]},listeners:{select:function(d,e){a.applyFormatStyle(e.get("value"));d.reset()},scope:c}})},applyFormatStyle:function(k){var a=null;Ext.each(this.formatInstructions,function(l,m){if(l.id==k){a=l}});if(this.cmp.win.getSelection||this.cmp.getDoc().getSelection){OPF.Msg.setAlert(true,"FF");var d=this.cmp.win.getSelection();if(!d){d=this.cmp.getDoc().getSelection()}var g=this.cmp.win.getSelection().getRangeAt(0);var b=g.cloneContents();var f,j=false;Ext.each(b.childNodes,function(l){if(l.nodeType!==3){j=true}});if(j){f=this.cmp.win.getSelection()+""}else{f=b.textContent}if(a.id=="normal"){g.deleteContents();g.insertNode(this.cmp.getDoc().createTextNode(f))}else{var e=this.cmp.getDoc().createElement(a.tagName);e.className=a.className;e.innerHTML=g;g.deleteContents();g.insertNode(e)}}else{if(this.cmp.getDoc().selection){OPF.Msg.setAlert(true,"IE");this.cmp.win.focus();g=this.cmp.getDoc().selection.createRange();OPF.Msg.setAlert(true,g.text);if(a.id=="normal"){g.pasteHTML(this.cmp.getDoc().selection)}else{var c="<"+a.tagName+(a.className!=null?' class="'+a.className+'"':"")+">";var h="</"+a.tagName+">";g.pasteHTML(c+g.text+h)}}}}});Ext.define("OPF.core.component.NoticeContainer",{extend:Ext.container.Container,alias:"widget.notice-container",cls:"notice-container",hidden:true,form:null,delay:null,activeMessageContainerTpl:['<div class="{containerCls}">','<tpl if="messages && messages.length">','<h4><img src="{imageUrl}" border="0"/>{title}</h4>','<ul><tpl for="messages"><li class="{level.css} <tpl if="xindex == xcount"> last</tpl>">{msg}</li></tpl></ul>',"</tpl>","</div>"],initComponent:function(){var b=this;if(OPF.isNotEmpty(this.delay)){var a=new Ext.util.DelayedTask(function(){b.initErrorContainer()},this);a.delay(this.delay)}else{this.initErrorContainer()}this.items=this.items||[];this.callParent(arguments)},initErrorContainer:function(){var b=this;if(!this.form){this.form=this.up("form")}if(this.form){var a=this.form.getForm().getFields();Ext.each(a.items,function(c){c.on("errorchange",b.showErrors,b)})}},showInfo:function(b,a){this.showError(b,a)},showError:function(c,a){var b=[{level:c,msg:a}];this.setNoticeContainer(b)},showErrors:function(){var a=this;if(OPF.isNotEmpty(this.task)){this.task.cancel()}this.task=new Ext.util.DelayedTask(function(){a.showLastErrors()},this);this.task.delay(10)},showLastErrors:function(){var b=[];var a=this.form.getForm().getFields();Ext.each(a.items,function(d){var c=d.getActiveErrors();Ext.each(c,function(e){if(OPF.isNotBlank(e)){b.push({level:OPF.core.validation.MessageLevel.ERROR,msg:e})}})});this.setNoticeContainer(b)},setNoticeContainer:function(d){var g=[];Ext.each(d,function(h){if(h.level==OPF.core.validation.MessageLevel.ERROR){g.push(h)}});var c="";if(g.length>0){c=this.getTpl("activeMessageContainerTpl").apply({title:"Error Message!",containerCls:"error-container",messages:g,imageUrl:OPF.Cfg.fullUrl("images/error.png")})}var b=[];Ext.each(d,function(h){if(h.level==OPF.core.validation.MessageLevel.WARN){b.push(h)}});var f="";if(b.length>0){f=this.getTpl("activeMessageContainerTpl").apply({title:"Warning Message!",containerCls:"warn-container",messages:b,imageUrl:OPF.Cfg.fullUrl("images/info.png")})}var e=[];Ext.each(d,function(h){if(h.level==OPF.core.validation.MessageLevel.INFO){e.push(h)}});var a="";if(e.length>0){a=this.getTpl("activeMessageContainerTpl").apply({title:"Info Message!",containerCls:"info-container",messages:e,imageUrl:OPF.Cfg.fullUrl("images/info.png")})}this.update(c+f+a);this.setVisible(OPF.isNotBlank(c+f+a))},cleanActiveErrors:function(){this.update("");this.hide()}});Ext.define("OPF.core.component.plugin.TreeViewDragDrop",{extend:Ext.tree.plugin.TreeViewDragDrop,alias:"plugin.opf-treeviewdragdrop",beforeDragEnter:function(b,a,c){return true},beforeDragOver:function(b,a,c){return true},beforeDragDrop:function(b,a,c){return true},isValidDropPoint:function(a,b){return true},onViewRender:function(a){var b=this;if(b.enableDrag){b.dragZone=Ext.create("Ext.tree.ViewDragZone",{view:a,ddGroup:b.dragGroup||b.ddGroup,dragText:b.dragText,repairHighlightColor:b.nodeHighlightColor,repairHighlight:b.nodeHighlightOnRepair,beforeDragEnter:b.beforeDragEnter,beforeDragOver:b.beforeDragOver,beforeDragDrop:b.beforeDragDrop})}if(b.enableDrop){b.dropZone=Ext.create("Ext.tree.ViewDropZone",{view:a,ddGroup:b.dropGroup||b.ddGroup,allowContainerDrops:b.allowContainerDrops,appendOnly:b.appendOnly,allowParentInserts:b.allowParentInserts,expandDelay:b.expandDelay,dropHighlightColor:b.nodeHighlightColor,dropHighlight:b.nodeHighlightOnDrop,isValidDropPoint:function(d,k,o,l,h){if(!d||!h.item){return false}var p=this.view,m=p.getRecord(d),g=h.records,c=g.length,n=g.length,f,j;if(!(m&&k&&c)){return false}for(f=0;f<n;f++){j=g[f];if(j.isNode&&j.contains(m)){return false}}if(k==="append"&&m.get("allowDrop")===false){return false}else{if(k!="append"&&m.parentNode.get("allowDrop")===false){return false}}if(Ext.Array.contains(g,m)){return false}return b.isValidDropPoint(m,g)}})}}});Ext.define("OPF.core.component.CultureComboBox",{extend:Ext.form.field.ComboBox,triggerAction:"all",editable:false,valueField:"culture",displayField:"country",width:100,initComponent:function(){this.store=new Ext.data.Store({model:"OPF.core.model.Culture",data:[{country:"US",culture:"AMERICAN"}],proxy:{type:"ajax",url:OPF.Cfg.restUrl("content/resource/culture"),reader:{type:"json",root:"data"}}});this.listConfig={getInnerTpl:function(){return'<div data-qtip="{culture}"><img src="'+OPF.Cfg.OPF_CONSOLE_URL+'/images/icons/16/flag_{countryLC}_16.png" />{country}</div>'}};this.callParent(arguments)},listeners:{afterrender:function(a){a.setValue("AMERICAN");a.store.proxy.url=OPF.Cfg.restUrl("content/resource/culture")}}});Ext.define("OPF.core.component.resource.DisplayComponent",{extend:Ext.container.Container,alias:"widget.display-component",maxTextLength:null,fullHtmlOrData:null,getHtmlOrData:function(){return this.fullHtmlOrData},update:function(b,c,a){var d=this;this.fullHtmlOrData=b;if(OPF.isNotEmpty(this.maxTextLength)){b=OPF.cutting(b,this.maxTextLength)}if(d.tpl&&!Ext.isString(b)){d.data=b;if(d.rendered){d.tpl[d.tplWriteMode](d.getTargetEl(),b||{})}}else{d.html=Ext.isObject(b)?Ext.DomHelper.markup(b):b;if(d.rendered){d.getTargetEl().update(d.html,c,a)}}if(d.rendered){d.doComponentLayout()}},listeners:{afterrender:function(a){Ext.create("Ext.tip.ToolTip",{target:a.getId(),html:"Loading...",dismissDelay:0,listeners:{beforeshow:function(b){b.update(a.fullHtmlOrData)}}})}}});Ext.define("OPF.core.component.resource.ImageResourceControl",{extend:Ext.container.Container,alias:"widget.image-resource-control",componentCls:null,cls:"image-resource-control",innerCls:"info-content",imgResourceLookup:null,imgInnerCls:"info-image",imageWidth:null,imageHeight:null,autoInit:false,allowEdit:true,initComponent:function(){var b=this;this.cls=OPF.isNotBlank(this.componentCls)?this.cls+" "+this.componentCls:this.cls;var a={render:function(c){if(OPF.Cfg.CAN_EDIT_RESOURCE&&b.allowEdit){c.getEl().on({mouseover:function(){b.editButton.addCls("active")},mouseout:function(){b.editButton.removeCls("active")}})}}};this.innerImgCnt=Ext.create("Ext.container.Container",{autoEl:"span",cls:this.imgInnerCls,listeners:a,html:"Loading..."});this.items=[this.innerImgCnt];if(OPF.Cfg.CAN_EDIT_RESOURCE&&this.allowEdit){this.editButton=Ext.ComponentMgr.create({xtype:"hrefclick",cls:"image-resource-edit hidden",html:'<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" alt="edit" title="edit"/>',onClick:function(){var c="ImageEditorWinId9865";var d=Ext.getCmp(c);if(d==null){d=new OPF.core.component.resource.ImageResourceEditor(c,{imageWidth:b.imageWidth,imageHeight:b.imageHeight})}d.setEditingEl(b.innerImgCnt);d.setIdData(b.imageIdData);d.show()},listeners:a});this.items.push(this.editButton)}this.callParent(arguments)},listeners:{afterrender:function(a){if(a.autoInit){a.loadResource(true)}}},getResourceLookup:function(){return this.imgResourceLookup},loadResource:function(a){var b=this;Ext.Ajax.request({url:OPF.Cfg.restUrl("content/resource/image/by-lookup/"+this.imgResourceLookup),method:"GET",async:a,success:function(c){var d=Ext.decode(c.responseText);var e=null;if(d.data){e=d.data[0]}b.initResource(e)},failure:function(c){var d=Ext.decode(c.responseText);OPF.Msg.setAlert(false,d.message)}})},initResource:function(e){var d;var c;if(OPF.isNotEmpty(e)){var a="content/resource/image/by-filename/"+e.id+"/"+e.resourceVersion.storedFilename+"?_dc="+new Date().getTime();var b=OPF.Cfg.restUrl(a);d=OPF.core.component.resource.ResourceControl.getImgHtml(b,this.imageWidth,this.imageHeight);this.innerImgCnt.el.dom.innerHTML=d;this.imageIdData={resourceId:e.id,version:e.resourceVersion.version,lookup:this.imgResourceLookup}}else{d=OPF.core.component.resource.ResourceControl.getStubHtml("Image not defined",this.imageWidth,this.imageHeight);c=Ext.create("Ext.container.Container",{cls:"test-image-container",html:d});this.innerImgCnt.add(c);this.imageIdData={resourceId:null,version:null,lookup:this.imgResourceLookup}}}});Ext.define("OPF.core.component.resource.ImageResourceEditor",{extend:Ext.window.Window,id:"imageResourceEditorWindow",title:"Edit Image Resource",closeAction:"hide",modal:true,minWidth:530,minHeight:200,constrainHeader:true,imageWidth:null,imageHeight:null,editingEl:null,constructor:function(b,a){a=a||{};OPF.core.component.resource.ImageResourceEditor.superclass.constructor.call(this,Ext.apply({id:b},a))},initComponent:function(){var a=this;this.imageWidthField=Ext.ComponentMgr.create({xtype:"hidden",name:"imageWidthField"});this.imageHeightField=Ext.ComponentMgr.create({xtype:"hidden",name:"imageHeightField"});this.resourceFileTemporaryName=Ext.ComponentMgr.create({xtype:"hidden",name:"resourceFileTemporaryName"});this.resourceFileOriginalName=Ext.ComponentMgr.create({xtype:"hidden",name:"resourceFileOriginalName"});this.imageContainer=new Ext.Component({html:"Loading..."});this.cultureCombo=new OPF.core.component.CultureComboBox();this.uploadFileDialog=new OPF.core.component.UploadFileDialog(this,{fileTypes:["jpg","jpeg","png","gif"],uploadUrl:OPF.Cfg.restUrl("content/resource/upload/image"),successUploaded:function(c){var d=c.data[0];a.resourceFileOriginalName.setValue(d.orgFilename);a.resourceFileTemporaryName.setValue(d.filename);var b=OPF.Cfg.restUrl("content/resource/tmp/"+d.filename);a.imageWidthField.setValue(d.width);a.imageHeightField.setValue(d.height);a.loadImageContainer(b,d.width,d.height);a.saveButton.enable()}});this.saveButton=new Ext.Button({text:"Save",disabled:true,handler:function(){a.save()}});this.bbar=[{xtype:"button",text:"Upload new image",handler:function(){a.uploadFileDialog.show()}}," ","Language:",this.cultureCombo,"->",this.saveButton," ",{xtype:"button",text:"Close",handler:function(){a.hide()}}];this.items=[this.imageContainer];this.callParent(arguments)},setEditingEl:function(a){this.editingEl=a},setIdData:function(a){this.idData=a},setSizeAccordingToImg:function(){var b=this.imageContainer.getSize().width+14;var a=this.imageContainer.getSize().height+69;if(b<this.minWidth){b=this.minWidth}if(a<this.minHeight){a=this.minHeight}this.setSize({width:b,height:a});this.doLayout()},show:function(){var b=this.editingEl.getSize();var a=OPF.core.component.resource.ImageResourceEditor.superclass.show.call(this);this.imageContainer.update(this.editingEl.el.dom.innerHTML);this.setSizeAccordingToImg();return a},loadImageContainer:function(a,e,d){var b=this;var c=OPF.core.component.resource.ResourceControl.getImgHtml(a,this.imageWidth,this.imageHeight);this.imageContainer.update(c);new Ext.util.DelayedTask(function(){b.setSizeAccordingToImg()}).delay(200)},getJsonData:function(){return{width:this.imageWidthField.getValue(),height:this.imageHeightField.getValue(),resourceFileTemporaryName:this.resourceFileTemporaryName.getValue(),resourceFileOriginalName:this.resourceFileOriginalName.getValue()}},save:function(){var a=this;var c=this.getJsonData();if(OPF.isEmpty(c.resourceFileOriginalName)){OPF.Msg.setAlert(false,"Please upload an image.");return false}var b;var d;if(this.idData.resourceId){c.resourceId=this.idData.resourceId;c.version=this.idData.version;b=OPF.Cfg.restUrl("content/resource/image/version/"+this.idData.resourceId);d="PUT"}else{b=OPF.Cfg.restUrl("content/resource/image/version/new-by-lookup/"+this.idData.lookup);d="POST"}c.culture=this.cultureCombo.getValue();Ext.Ajax.request({url:b,method:d,jsonData:{data:c},success:function(k,j){var h;try{h=Ext.decode(k.responseText)}catch(n){OPF.Msg.setAlert(false,"Error saving resource.");return}OPF.Msg.setAlert(h.success,h.message);if(h.success){a.saveButton.disable();if(a.cultureCombo.getValue()=="AMERICAN"){var m=a.editingEl.el.dom.firstChild;var g;if(m.nodeName=="DIV"){var l=h.data[0];var o="content/resource/image/by-filename/"+l.resourceId+"/"+l.storedFilename+"?_dc="+new Date().getTime();var f=OPF.Cfg.restUrl(o);g=OPF.core.component.resource.ResourceControl.getImgHtml(f,a.imageWidth,a.imageHeight)}else{var p=m.src;p=p.replace(/_dc=.+/,"");p+="_dc="+new Date().getTime();g=OPF.core.component.resource.ResourceControl.getImgHtml(p,a.imageWidth,a.imageHeight)}a.editingEl.update(g)}}},failure:function(e){OPF.Msg.setAlert(false,"Error occurred while saving image.")}})}});Ext.define("OPF.core.component.resource.ResourceControl",{extend:Ext.panel.Panel,alias:"widget.resource-control",cls:"info-resource-content",innerCls:"info-content",textResourceLookup:null,textInnerCls:"info-text",textMaxLength:null,htmlResourceLookup:null,htmlInnerCls:"info-html",imgResourceLookup:null,imgInnerCls:"info-image",imageWidth:null,imageHeight:null,border:false,initComponent:function(){var a=this;this.innerLoadingCmp=new Ext.Component({html:"Loading..."});var b=[];var d=[this.innerLoadingCmp];if(this.imgResourceLookup){this.innerImgCnt=new Ext.Component({cls:this.imgInnerCls});d.push(this.innerImgCnt);b.push({xtype:"hrefclick",cls:"resourceEditLink",html:"EDIT IMAGE",onClick:function(){var e="ImageEditorWinId9320";var f=Ext.getCmp(e);if(f==null){f=new OPF.core.component.resource.ImageResourceEditor(e,{imageWidth:a.imageWidth,imageHeight:a.imageHeight})}f.setEditingEl(a.innerImgCnt);f.setIdData(a.imageIdData);f.show()}})}if(this.textResourceLookup){if(OPF.isNotEmpty(this.textMaxLength)){this.innerTextCnt=new OPF.core.component.resource.DisplayComponent({cls:this.textInnerCls,maxTextLength:this.textMaxLength})}else{this.innerTextCnt=new Ext.Component({cls:this.textInnerCls})}d.push(this.innerTextCnt);b.push({xtype:"hrefclick",cls:"resourceEditLink",html:"EDIT TEXT",onClick:function(){var e="TextEditorWinId5823";var f=Ext.getCmp(e);if(f==null){f=new OPF.core.component.resource.TextResourceEditor(e,"textarea")}f.setEditingEl(a.innerTextCnt);f.setIdData(a.textIdData);f.show()}})}if(this.htmlResourceLookup){this.innerHtmlCnt=new Ext.Component({cls:this.htmlInnerCls});d.push(this.innerHtmlCnt);b.push({xtype:"hrefclick",cls:"resourceEditLink",html:"EDIT HTML",onClick:function(){var e="HtmlEditorWinId9420";var f=Ext.getCmp(e);if(f==null){f=new OPF.core.component.resource.TextResourceEditor(e,"tinymceeditor")}f.setEditingEl(a.innerHtmlCnt);f.setIdData(a.htmlIdData);f.show()}})}var c={render:function(e){e.getEl().on({mouseover:function(){a.actionsCnt.show()},mouseout:function(){a.actionsCnt.hide()}})}};this.innerCnt=new Ext.Container({cls:this.innerCls,items:d,listeners:c});this.actionsCnt=new Ext.Container({xtype:"container",cls:"actions",hidden:true,items:b,listeners:c});this.items=[this.innerCnt];this.callParent(arguments);this.numUpdates=0;if(this.textResourceLookup){this.numUpdates++}if(this.htmlResourceLookup){this.numUpdates++}if(this.imgResourceLookup){this.numUpdates++}if(this.textResourceLookup){Ext.Ajax.request({url:OPF.Cfg.restUrl("content/resource/text/by-lookup/"+this.textResourceLookup),method:"GET",success:function(e){var f=Ext.decode(e.responseText);if(f.data){var g=f.data[0];a.innerTextCnt.update(g.resourceVersion.text);a.textIdData={resourceId:g.id,version:g.resourceVersion.version}}else{a.innerTextCnt.update("Not defined")}a.finishUpdate()},failure:null})}if(this.htmlResourceLookup){Ext.Ajax.request({url:OPF.Cfg.restUrl("content/resource/html/by-lookup/"+this.htmlResourceLookup),method:"GET",success:function(e){var f=Ext.decode(e.responseText);if(f.data){var g=f.data[0];a.innerHtmlCnt.update(g.resourceVersion.html);a.htmlIdData={resourceId:g.id,version:g.resourceVersion.version}}else{a.innerHtmlCnt.update("Not defined")}a.finishUpdate()},failure:null})}if(this.imgResourceLookup){Ext.Ajax.request({url:OPF.Cfg.restUrl("content/resource/image/by-lookup/"+this.imgResourceLookup),method:"GET",success:function(f){var h=Ext.decode(f.responseText);if(h.data){var k=h.data[0];var e="content/resource/image/by-filename/"+k.id+"/"+k.resourceVersion.storedFilename+"?_dc="+new Date().getTime();var g=OPF.Cfg.restUrl(e);var j=OPF.core.component.resource.ResourceControl.getImgHtml(g,a.imageWidth,a.imageHeight);a.innerImgCnt.update(j);a.finishUpdate();a.imageIdData={resourceId:k.id,version:k.resourceVersion.version}}},failure:null})}},finishUpdate:function(){this.numUpdates--;if(this.numUpdates==0){this.innerLoadingCmp.update("");if(OPF.Cfg.CAN_EDIT_RESOURCE){this.insert(1,this.actionsCnt)}this.doLayout()}}});OPF.core.component.resource.ResourceControl.getImgHtml=function(b,c,a,e){var d='<img src="'+b+'"';if(c){d+=' width="'+c+'"'}if(a){d+=' height="'+a+'"'}if(e){d+=' title="'+e+'"';d+=' alt="'+e+'"'}d+=" />";return d};OPF.core.component.resource.ResourceControl.getImgHtmlWrapper=function(a,c,d,g,l,m){var o=1;var j=1;if(c>l){o=c/l}if(d>m){j=d/m}var b;var n;if(j>o){b=c/j;n=d/j}else{if(j<o){b=c/o;n=d/o}else{b=c;n=d}}var p=(l-b)/2;var h=p>0?p+"px":"0";var k=(m-n)/2;var f=k>0?k+"px":"0";var e='<div style="width: '+l+"px; height: "+m+"px; padding: "+f+" "+h+" "+f+" "+h+';">';e+='<img src="'+a+'"';e+=' width="'+b+'"';e+=' height="'+n+'"';if(g){e+=' title="'+g+'"';e+=' alt="'+g+'"'}e+=" /></div>";return e};OPF.core.component.resource.ResourceControl.getStubHtml=function(d,b,a){var c='<div style="display: table-cell; border: 1px solid #999999; text-align: center; vertical-align: middle;';if(b){c+="width: "+b+"px;"}if(a){c+="height: "+a+"px;"}c+='">';if(d){c+=d}c+="</div>";return c};Ext.define("OPF.core.component.resource.TextResourceControl",{extend:Ext.container.Container,alias:"widget.text-resource-control",innerCls:"info-content",textResourceLookup:null,textInnerCls:"info-text",maxTextLength:null,autoInit:false,allowEdit:true,initComponent:function(){var b=this;var a={render:function(c){if(OPF.Cfg.CAN_EDIT_RESOURCE&&b.allowEdit){c.getEl().on({mouseover:function(){b.editButton.addCls("active")},mouseout:function(){b.editButton.removeCls("active")}})}}};if(OPF.isNotEmpty(this.maxTextLength)){this.innerTextCnt=Ext.create("OPF.core.component.resource.DisplayComponent",{autoEl:"span",cls:this.textInnerCls,maxTextLength:this.maxTextLength,listeners:a,html:"Loading..."})}else{this.innerTextCnt=Ext.create("Ext.container.Container",{autoEl:"span",cls:this.textInnerCls,listeners:a,html:"Loading..."})}this.items=[this.innerTextCnt];if(OPF.Cfg.CAN_EDIT_RESOURCE&&this.allowEdit){this.editButton=Ext.ComponentMgr.create({xtype:"hrefclick",cls:"text-resource-edit hidden",html:'<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" alt="edit" title="edit"/>',onClick:function(){var c="TextEditorWinId4582";var d=Ext.getCmp(c);if(d==null){d=new OPF.core.component.resource.TextResourceEditor(c,"textarea")}d.setEditingEl(b.innerTextCnt);d.setIdData(b.textIdData);d.show()},listeners:a});this.items.push(this.editButton)}this.callParent(arguments)},listeners:{afterrender:function(a){if(a.autoInit){a.loadResource(true)}}},getResourceLookup:function(){return this.textResourceLookup},loadResource:function(a){var b=this;Ext.Ajax.request({url:OPF.Cfg.restUrl("content/resource/text/by-lookup/"+this.textResourceLookup),method:"GET",async:a,success:function(c){var d=Ext.decode(c.responseText);var e=null;if(d.data){e=d.data[0]}b.initResource(e)},failure:function(c){var d=Ext.decode(c.responseText);OPF.Msg.setAlert(false,d.message)}})},initResource:function(a){if(OPF.isNotEmpty(a)){this.innerTextCnt.el.dom.innerHTML=a.resourceVersion.text;this.textIdData={resourceId:a.id,version:a.resourceVersion.version,lookup:this.textResourceLookup}}else{this.innerTextCnt.el.dom.innerHTML="Not defined";this.textIdData={resourceId:null,version:null,lookup:this.textResourceLookup}}}});Ext.define("OPF.core.component.resource.TextResourceEditor",{extend:Ext.window.Window,id:"textResourceEditorWindow",title:"Edit Text Resource",closeAction:"hide",modal:true,minWidth:400,minHeight:200,layout:"fit",constrainHeader:true,editorXType:null,editingEl:null,constructor:function(d,a,b){b=b||{};var c;if(a=="textarea"){c="Edit Text Resource"}else{if(a=="tinymceeditor"){c="Edit HTML Resource"}}OPF.core.component.resource.TextResourceEditor.superclass.constructor.call(this,Ext.apply({id:d,editorXType:a,title:c},b))},initComponent:function(){var a=this;this.cultureCombo=new OPF.core.component.CultureComboBox();this.bbar=Ext.create("Ext.toolbar.Toolbar",{items:["Language:",this.cultureCombo,"->",{xtype:"button",text:"Save",handler:function(){a.save()}}," ",{xtype:"button",text:"Close",handler:function(){a.hide()}}]});this.editorComponent=Ext.ComponentMgr.create({xtype:this.editorXType});this.items=[this.editorComponent];this.callParent(arguments)},setEditingEl:function(a){this.editingEl=a;this.editorComponent.setValue(a.getHtmlOrData?a.getHtmlOrData():a.el.dom.innerHTML)},setIdData:function(a){this.idData=a},show:function(){var a=this.editingEl.getSize();var c=a.width<this.minWidth?this.minWidth:a.width;var b=a.height<this.minHeight?this.minHeight:a.height;this.setSize({width:c+5,height:b+40});return OPF.core.component.resource.TextResourceEditor.superclass.show.call(this)},save:function(){var d=this;var c={};var b;if(this.editorXType=="textarea"){c.text=this.editorComponent.getValue();b="content/resource/text/version"}else{if(this.editorXType=="tinymceeditor"){c.html=this.editorComponent.getValue();b="content/resource/html/version"}}var a;var e;if(this.idData.resourceId){c.resourceId=this.idData.resourceId;c.version=this.idData.version;a=OPF.Cfg.restUrl(b+"/"+this.idData.resourceId);e="PUT"}else{a=OPF.Cfg.restUrl(b+"/new/"+this.idData.lookup);e="POST"}c.culture=this.cultureCombo.getValue();Ext.Ajax.request({url:a,method:e,jsonData:{data:c},success:function(f,j){var g;try{g=Ext.decode(f.responseText)}catch(k){OPF.Msg.setAlert(false,"Error saving resource.");return}OPF.Msg.setAlert(g.success,g.message);if(g.success){d.idData.resourceId=g.data[0].resourceId;d.idData.version=g.data[0].version;if(d.cultureCombo.getValue()=="AMERICAN"){var h=d.editorComponent.getValue();d.editingEl.update(h)}}},failure:function(f){OPF.Msg.setAlert(false,"Error saving resource.")}})}});Ext.define("OPF.core.component.tinymce.WindowManager",{constructor:function(a){tinymce.WindowManager.call(this,a.editor)},alert:function(b,a,c){Ext.MessageBox.alert("",b,function(){if(!Ext.isEmpty(a)){a.call(this)}},c)},confirm:function(b,a,c){Ext.MessageBox.confirm("",b,function(d){if(!Ext.isEmpty(a)){a.call(this,d=="yes")}},c)},open:function(a,c){a=a||{};c=c||{};if(!a.type){this.bookmark=this.editor.selection.getBookmark("simple")}a.width=parseInt(a.width||320);a.height=parseInt(a.height||240)+(tinymce.isIE?8:0);a.min_width=parseInt(a.min_width||150);a.min_height=parseInt(a.min_height||100);a.max_width=parseInt(a.max_width||2000);a.max_height=parseInt(a.max_height||2000);a.movable=true;a.resizable=true;c.mce_width=a.width;c.mce_height=a.height;c.mce_inline=true;this.features=a;this.params=c;var b=Ext.create("Ext.window.Window",{title:a.name,width:a.width,height:a.height,minWidth:a.min_width,minHeight:a.min_height,resizable:true,maximizable:a.maximizable,minimizable:a.minimizable,modal:true,stateful:false,constrain:true,layout:"fit",items:[Ext.create("Ext.Component",{autoEl:{tag:"iframe",src:a.url||a.file},style:"border-width: 0px;"})]});c.mce_window_id=b.getId();b.show(null,function(){if(a.left&&a.top){b.setPagePosition(a.left,a.top)}var d=b.getPosition();a.left=d[0];a.top=d[1];this.onOpen.dispatch(this,a,c)},this);return b},close:function(b){if(!b.tinyMCEPopup||!b.tinyMCEPopup.id){tinymce.WindowManager.prototype.close.call(this,b);return}var a=Ext.getCmp(b.tinyMCEPopup.id);if(a){this.onClose.dispatch(this);a.close()}},setTitle:function(c,b){if(!c.tinyMCEPopup||!c.tinyMCEPopup.id){tinymce.WindowManager.prototype.setTitle.call(this,c,b);return}var a=Ext.getCmp(c.tinyMCEPopup.id);if(a){a.setTitle(b)}},resizeBy:function(b,d,e){var a=Ext.getCmp(e);if(a){var c=a.getSize();a.setSize(c.width+b,c.height+d)}},focus:function(b){var a=Ext.getCmp(b);if(a){a.setActive(true)}}});Ext.define("OPF.core.component.tinymce.TinyMCEEditor",{extend:Ext.form.field.TextArea,alias:"widget.tinymceeditor",config:{},constructor:function(b,a){var c=this;a=a||{};a.height=(a.height&&a.height>=c.config.height)?a.height:c.config.height;a.tinymceConfig={};Ext.applyIf(a.tinymceConfig,c.getGlobalSettings());a.tinymceConfig.mode="none";c.addEvents({editorcreated:true});c.callParent([a])},getGlobalSettings:function(){return{accessibility_focus:false,language:"en",mode:"none",theme:"advanced",plugins:"autolink,table",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,bullist,numlist,|,forecolor,backcolor,|,styleselect,formatselect,fontselect,fontsizeselect,|,link, unlink,|,tablecontrols,removeformat,cleanup,code",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_buttons4:"",content_css:[OPF.Cfg.fullUrl("css/clds4.css"),OPF.Cfg.fullUrl("css/documentation.css"),OPF.Cfg.fullUrl("css/simple-html-editor.css"),OPF.Cfg.fullUrl("css/tinymce.css")],theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"none",theme_advanced_resizing:false,theme_advanced_row_height:30,style_formats:[{title:"Quote",inline:"span",classes:"quote"},{title:"Code",inline:"span",classes:"code"},{title:"Warning",inline:"span",classes:"warn"},{title:"Important",inline:"span",classes:"important"},{title:"Critical",inline:"span",classes:"critical"},{title:"Subdued",inline:"span",classes:"subdued"}]}},afterRender:function(){var b=this;b.callParent(arguments);b.tinymceConfig.height=b.height;console.log(b.tinymceConfig.height);b.editor=new tinymce.Editor(b.inputEl.id,b.tinymceConfig);var a=Ext.Function.createBuffered(b.validate,250,this);b.editor.onKeyPress.add(a);b.editor.onPostRender.add(Ext.Function.bind(function(d,c){d.windowManager=Ext.create("OPF.core.component.tinymce.WindowManager",{editor:b.editor});b.tableEl=Ext.get(b.editor.id+"_tbl");b.iframeEl=Ext.get(b.editor.id+"_ifr")},b));window.b=b.editor;b.on("resize",b.onResize,b);b.editor.render();tinyMCE.add(b.editor)},setSize:function(b,a){console.log([b,a]);if(this.editor.theme){this.editor.theme.resizeTo(b,a-30)}this.callParent(arguments)},isDirty:function(){var a=this;if(a.disabled||!a.rendered){return false}return a.editor&&a.editor.initialized&&a.editor.isDirty()},getValue:function(){return this.editor.getContent()},setValue:function(b){var a=this;if(OPF.isNotEmpty(b)){a.value=b;if(a.rendered){a.withEd(function(){a.editor.undoManager.clear();a.editor.setContent(b===null||b===undefined?"":b);a.editor.startContent=a.editor.getContent({format:"raw"});a.validate()})}else{new Ext.util.DelayedTask(function(c){this.setValue(c)},this).delay(100,null,this,[b])}}},getSubmitData:function(){var a={};a[this.getName()]=this.getValue();return a},insertValueAtCursor:function(b){var a=this;if(a.editor&&a.editor.initialized){a.editor.execCommand("mceInsertContent",false,b)}},onDestroy:function(){var a=this;a.editor.remove();a.editor.destroy();a.callParent(arguments)},onResize:function(b,e,d){var c,a=b.bodyEl.getWidth();if(b.iframeEl){c=a-b.iframeEl.getBorderWidth("lr")-2;b.iframeEl.setWidth(c)}if(b.tableEl){c=a-b.tableEl.getBorderWidth("lr")-2;b.tableEl.setWidth(c)}},getEditor:function(){return this.editor},getRawValue:function(){var a=this;return(!a.editor||!a.editor.initialized)?Ext.valueFrom(a.value,""):a.editor.getContent()},disable:function(){this.withEd(function(){var a=this.editor.getBody();a=Ext.get(a);if(a.hasCls("mceContentBody")){a.removeCls("mceContentBody");a.addCls("mceNonEditable")}})},enable:function(){this.withEd(function(){var a=this.editor.getBody();a=Ext.get(a);if(a.hasCls("mceNonEditable")){a.removeCls("mceNonEditable");a.addCls("mceContentBody")}})},withEd:function(a){if(!this.editor){this.on("editorcreated",function(){this.withEd(a)},this)}else{if(this.editor.initialized){a.call(this)}else{this.editor.onInit.add(Ext.Function.bind(function(){Ext.Function.defer(a,10,this)},this))}}},validateValue:function(b){var a=this;if(Ext.isFunction(a.validator)){var d=a.validator(b);if(d!==true){a.markInvalid(d);return false}}if(b.length<1||b===a.emptyText){if(a.allowBlank){a.clearInvalid();return true}else{a.markInvalid(a.blankText);return false}}if(b.length<a.minLength){a.markInvalid(Ext.String.format(a.minLengthText,a.minLength));return false}else{a.clearInvalid()}if(b.length>a.maxLength){a.markInvalid(Ext.String.format(a.maxLengthText,a.maxLength));return false}else{a.clearInvalid()}if(a.vtype){var c=Ext.form.field.VTypes;if(!c[a.vtype](b,a)){a.markInvalid(a.vtypeText||c[a.vtype+"Text"]);return false}}if(a.regex&&!a.regex.test(b)){a.markInvalid(a.regexText);return false}return true}});(function(h){var g=/^\s*|\s*$/g,f,j="B".replace(/A(.)|B/,"$1")==="$1";var k={majorVersion:"3",minorVersion:"5b3",releaseDate:"2012-03-29",_init:function(){var y=this,b=document,c=navigator,v=c.userAgent,d,x,e,n,p,a;y.isOpera=h.opera&&opera.buildNumber;y.isWebKit=/WebKit/.test(v);y.isIE=!y.isWebKit&&!y.isOpera&&(/MSIE/gi).test(v)&&(/Explorer/gi).test(c.appName);y.isIE6=y.isIE&&/MSIE [56]/.test(v);y.isIE7=y.isIE&&/MSIE [7]/.test(v);y.isIE8=y.isIE&&/MSIE [8]/.test(v);y.isIE9=y.isIE&&/MSIE [9]/.test(v);y.isGecko=!y.isWebKit&&/Gecko/.test(v);y.isMac=v.indexOf("Mac")!=-1;y.isAir=/adobeair/i.test(v);y.isIDevice=/(iPad|iPhone)/.test(v);y.isIOS5=y.isIDevice&&v.match(/AppleWebKit\/(\d*)/)[1]>=534;if(h.tinyMCEPreInit){y.suffix=tinyMCEPreInit.suffix;y.baseURL=tinyMCEPreInit.base;y.query=tinyMCEPreInit.query;return}y.suffix="";x=b.getElementsByTagName("base");for(d=0;d<x.length;d++){a=x[d].href;if(a){if(/^https?:\/\/[^\/]+$/.test(a)){a+="/"}n=a?a.match(/.*\//)[0]:""}}function u(l){if(l.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(l.src)){if(/_(src|dev)\.js/g.test(l.src)){y.suffix="_src"}if((p=l.src.indexOf("?"))!=-1){y.query=l.src.substring(p+1)}y.baseURL=l.src.substring(0,l.src.lastIndexOf("/"));if(n&&y.baseURL.indexOf("://")==-1&&y.baseURL.indexOf("/")!==0){y.baseURL=n+y.baseURL}return y.baseURL}return null}x=b.getElementsByTagName("script");for(d=0;d<x.length;d++){if(u(x[d])){return}}e=b.getElementsByTagName("head")[0];if(e){x=e.getElementsByTagName("script");for(d=0;d<x.length;d++){if(u(x[d])){return}}}return},is:function(a,b){if(!b){return a!==f}if(b=="array"&&(a.hasOwnProperty&&a instanceof Array)){return true}return typeof(a)==b},makeMap:function(d,a,b){var c;d=d||[];a=a||",";if(typeof(d)=="string"){d=d.split(a)}b=b||{};c=d.length;while(c--){b[d[c]]={}}return b},each:function(b,e,c){var a,d;if(!b){return 0}c=c||b;if(b.length!==f){for(a=0,d=b.length;a<d;a++){if(e.call(c,b[a],a,b)===false){return 0}}}else{for(a in b){if(b.hasOwnProperty(a)){if(e.call(c,b[a],a,b)===false){return 0}}}}return 1},map:function(c,b){var a=[];k.each(c,function(d){a.push(b(d))});return a},grep:function(c,b){var a=[];k.each(c,function(d){if(!b||b(d)){a.push(d)}});return a},inArray:function(c,b){var a,d;if(c){for(a=0,d=c.length;a<d;a++){if(c[a]===b){return a}}}return -1},extend:function(o,b){var c,l,d,e=arguments,a;for(c=1,l=e.length;c<l;c++){b=e[c];for(d in b){if(b.hasOwnProperty(d)){a=b[d];if(a!==f){o[d]=a}}}}return o},trim:function(a){return(a?""+a:"").replace(g,"")},create:function(a,u,p){var b=this,s,q,e,d,r,c=0;a=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(a);e=a[3].match(/(^|\.)(\w+)$/i)[2];q=b.createNS(a[3].replace(/\.\w+$/,""),p);if(q[e]){return}if(a[2]=="static"){q[e]=u;if(this.onCreate){this.onCreate(a[2],a[3],q[e])}return}if(!u[e]){u[e]=function(){};c=1}q[e]=u[e];b.extend(q[e].prototype,u);if(a[5]){s=b.resolve(a[5]).prototype;d=a[5].match(/\.(\w+)$/i)[1];r=q[e];if(c){q[e]=function(){return s[d].apply(this,arguments)}}else{q[e]=function(){this.parent=s[d];return r.apply(this,arguments)}}q[e].prototype[e]=q[e];b.each(s,function(m,l){q[e].prototype[l]=s[l]});b.each(u,function(m,l){if(s[l]){q[e].prototype[l]=function(){this.parent=s[l];return m.apply(this,arguments)}}else{if(l!=e){q[e].prototype[l]=m}}})}b.each(u["static"],function(m,l){q[e][l]=m});if(this.onCreate){this.onCreate(a[2],a[3],q[e].prototype)}},walk:function(b,c,a,d){d=d||this;if(b){if(a){b=b[a]}k.each(b,function(e,l){if(c.call(d,e,l,a)===false){return false}k.walk(e,c,a,d)})}},createNS:function(a,b){var c,d;b=b||h;a=a.split(".");for(c=0;c<a.length;c++){d=a[c];if(!b[d]){b[d]={}}b=b[d]}return b},resolve:function(a,b){var c,d;b=b||h;a=a.split(".");for(c=0,d=a.length;c<d;c++){b=b[a[c]];if(!b){break}}return b},addUnload:function(b,c){var d=this,e;e=function(){var p=d.unloads,o,n;if(p){for(n in p){o=p[n];if(o&&o.func){o.func.call(o.scope,1)}}if(h.detachEvent){h.detachEvent("onbeforeunload",a);h.detachEvent("onunload",e)}else{if(h.removeEventListener){h.removeEventListener("unload",e,false)}}d.unloads=o=p=w=e=0;if(h.CollectGarbage){CollectGarbage()}}};function a(){var m=document;function n(){m.detachEvent("onstop",n);if(e){e()}m=0}if(m.readyState=="interactive"){if(m){m.attachEvent("onstop",n)}h.setTimeout(function(){if(m){m.detachEvent("onstop",n)}},0)}}b={func:b,scope:c||this};if(!d.unloads){if(h.attachEvent){h.attachEvent("onunload",e);h.attachEvent("onbeforeunload",a)}else{if(h.addEventListener){h.addEventListener("unload",e,false)}}d.unloads=[b]}else{d.unloads.push(b)}return b},removeUnload:function(a){var c=this.unloads,b=null;k.each(c,function(d,e){if(d&&d.func==a){c.splice(e,1);b=a;return false}});return b},explode:function(b,a){if(!b||k.is(b,"array")){return b}return k.map(b.split(a||","),k.trim)},_addVer:function(a){var b;if(!this.query){return a}b=(a.indexOf("?")==-1?"?":"&")+this.query;if(a.indexOf("#")==-1){return a+b}return a.replace("#",b+"#")},_replace:function(a,c,b){if(j){return b.replace(a,function(){var d=c,m=arguments,e;for(e=0;e<m.length-2;e++){if(m[e]===f){d=d.replace(new RegExp("\\$"+e,"g"),"")}else{d=d.replace(new RegExp("\\$"+e,"g"),m[e])}}return d})}return b.replace(a,c)}};k._init();h.tinymce=h.tinyMCE=k})(window);tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,Dispatcher:function(b){this.scope=b||this;this.listeners=[]},add:function(d,c){this.listeners.push({cb:d,scope:c||this.scope});return d},addToTop:function(d,c){this.listeners.unshift({cb:d,scope:c||this.scope});return d},remove:function(e){var d=this.listeners,f=null;tinymce.each(d,function(a,b){if(e==a.cb){f=e;d.splice(b,1);return false}});return f},dispatch:function(){var h,k=arguments,j,a=this.listeners,c;for(j=0;j<a.length;j++){c=a[j];h=c.cb.apply(c.scope,k.length>0?k:[c.scope]);if(h===false){break}}return h}});(function(){var b=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(m,k){var l=this,a,n,o,j;m=tinymce.trim(m);k=l.settings=k||{};if(/^([\w\-]+):([^\/]{2})/i.test(m)||/^\s*#/.test(m)){l.source=m;return}if(m.indexOf("/")===0&&m.indexOf("//")!==0){m=(k.base_uri?k.base_uri.protocol||"http":"http")+"://mce_host"+m}if(!/^[\w\-]*:?\/\//.test(m)){j=k.base_uri?k.base_uri.path:new tinymce.util.URI(location.href).directory;m=((k.base_uri&&k.base_uri.protocol)||"http")+"://mce_host"+l.toAbsPath(j,m)}m=m.replace(/@@/g,"(mce_at)");m=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(m);b(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(c,e){var d=m[e];if(d){d=d.replace(/\(mce_at\)/g,"@@")}l[c]=d});o=k.base_uri;if(o){if(!l.protocol){l.protocol=o.protocol}if(!l.userInfo){l.userInfo=o.userInfo}if(!l.port&&l.host==="mce_host"){l.port=o.port}if(!l.host||l.host==="mce_host"){l.host=o.host}l.source=""}},setPath:function(d){var a=this;d=/^(.*?)\/?(\w+)?$/.exec(d);a.path=d[0];a.directory=d[1];a.file=d[2];a.source="";a.getURI()},toRelative:function(a){var j=this,g;if(a==="./"){return a}a=new tinymce.util.URI(a,{base_uri:j});if((a.host!="mce_host"&&j.host!=a.host&&a.host)||j.port!=a.port||j.protocol!=a.protocol){return a.getURI()}var k=j.getURI(),h=a.getURI();if(k==h||(k.charAt(k.length-1)=="/"&&k.substr(0,k.length-1)==h)){return k}g=j.toRelPath(j.path,a.path);if(a.query){g+="?"+a.query}if(a.anchor){g+="#"+a.anchor}return g},toAbsolute:function(a,d){a=new tinymce.util.URI(a,{base_uri:this});return a.getURI(this.host==a.host&&this.protocol==a.protocol?d:0)},toRelPath:function(k,j){var o,l=0,n="",m,a;k=k.substring(0,k.lastIndexOf("/"));k=k.split("/");o=j.split("/");if(k.length>=o.length){for(m=0,a=k.length;m<a;m++){if(m>=o.length||k[m]!=o[m]){l=m+1;break}}}if(k.length<o.length){for(m=0,a=o.length;m<a;m++){if(m>=k.length||k[m]!=o[m]){l=m+1;break}}}if(l===1){return j}for(m=0,a=k.length-(l-1);m<a;m++){n+="../"}for(m=l-1,a=o.length;m<a;m++){if(m!=l-1){n+="/"+o[m]}else{n+=o[m]}}return n},toAbsPath:function(m,l){var o,a=0,j=[],n,k;n=/\/$/.test(l)?"/":"";m=m.split("/");l=l.split("/");b(m,function(c){if(c){j.push(c)}});m=j;for(o=l.length-1,j=[];o>=0;o--){if(l[o].length===0||l[o]==="."){continue}if(l[o]===".."){a++;continue}if(a>0){a--;continue}j.push(l[o])}o=m.length-a;if(o<=0){k=j.reverse().join("/")}else{k=m.slice(0,o).join("/")+"/"+j.reverse().join("/")}if(k.indexOf("/")!==0){k="/"+k}if(n&&k.lastIndexOf("/")!==k.length-1){k+=n}return k},getURI:function(e){var f,a=this;if(!a.source||e){f="";if(!e){if(a.protocol){f+=a.protocol+"://"}if(a.userInfo){f+=a.userInfo+"@"}if(a.host){f+=a.host}if(a.port){f+=":"+a.port}}if(a.path){f+=a.path}if(a.query){f+="?"+a.query}if(a.anchor){f+="#"+a.anchor}a.source=f}return a.source}})})();(function(){var b=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(e){var a=this.get(e),f;if(a){b(a.split("&"),function(c){c=c.split("=");f=f||{};f[unescape(c[0])]=unescape(c[1])})}return f},setHash:function(d,a,l,m,e,n){var k="";b(a,function(c,f){k+=(!k?"":"&")+escape(f)+"="+escape(c)});this.set(d,k,l,m,e,n)},get:function(a){var c=document.cookie,e,j=a+"=",k;if(!c){return}k=c.indexOf("; "+j);if(k==-1){k=c.indexOf(j);if(k!==0){return null}}else{k+=2}e=c.indexOf(";",k);if(e==-1){e=c.length}return unescape(c.substring(k+j.length,e))},set:function(d,a,j,k,e,l){document.cookie=d+"="+escape(a)+((j)?"; expires="+j.toGMTString():"")+((k)?"; path="+escape(k):"")+((e)?"; domain="+e:"")+((l)?"; secure":"")},remove:function(d,a){var f=new Date();f.setTime(f.getTime()-1000);this.set(d,"",f,a,f)}})})();(function(){function serialize(o,quote){var i,v,t,name;quote=quote||'"';if(o==null){return"null"}t=typeof o;if(t=="string"){v="\bb\tt\nn\ff\rr\"\"''\\\\";return quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){if(quote==='"'&&a==="'"){return a}i=v.indexOf(b);if(i+1){return"\\"+v.charAt(i+1)}a=b.charCodeAt().toString(16);return"\\u"+"0000".substring(a.length)+a})+quote}if(t=="object"){if(o.hasOwnProperty&&o instanceof Array){for(i=0,v="[";i<o.length;i++){v+=(i>0?",":"")+serialize(o[i],quote)}return v+"]"}v="{";for(name in o){if(o.hasOwnProperty(name)){v+=typeof o[name]!="function"?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):""}}return v+"}"}return""+o}tinymce.util.JSON={serialize:serialize,parse:function(s){try{return eval("("+s+")")}catch(ex){}}}})();tinymce.create("static tinymce.util.XHR",{send:function(l){var j,n,c=window,k=0;function m(){if(!l.async||j.readyState==4||k++>10000){if(l.success&&k<10000&&j.status==200){l.success.call(l.success_scope,""+j.responseText,j,l)}else{if(l.error){l.error.call(l.error_scope,k>10000?"TIMED_OUT":"GENERAL",j,l)}}j=null}else{c.setTimeout(m,10)}}l.scope=l.scope||this;l.success_scope=l.success_scope||l.scope;l.error_scope=l.error_scope||l.scope;l.async=l.async===false?false:true;l.data=l.data||"";function o(a){j=0;try{j=new ActiveXObject(a)}catch(b){}return j}j=c.XMLHttpRequest?new XMLHttpRequest():o("Microsoft.XMLHTTP")||o("Msxml2.XMLHTTP");if(j){if(j.overrideMimeType){j.overrideMimeType(l.content_type)}j.open(l.type||(l.data?"POST":"GET"),l.url,l.async);if(l.content_type){j.setRequestHeader("Content-Type",l.content_type)}j.setRequestHeader("X-Requested-With","XMLHttpRequest");j.send(l.data);if(!l.async){return m()}n=c.setTimeout(m,10)}}});(function(){var f=tinymce.extend,d=tinymce.util.JSON,e=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(a){this.settings=f({},a);this.count=0},send:function(a){var b=a.error,c=a.success;a=f(this.settings,a);a.success=function(j,k){j=d.parse(j);if(typeof(j)=="undefined"){j={error:"JSON Parse error."}}if(j.error){b.call(a.error_scope||a.scope,j.error,k)}else{c.call(a.success_scope||a.scope,j.result)}};a.error=function(j,k){if(b){b.call(a.error_scope||a.scope,j,k)}};a.data=d.serialize({id:a.id||"c"+(this.count++),method:a.method,params:a.params});a.content_type="application/json";e.send(a)},"static":{sendRPC:function(a){return new tinymce.util.JSONRequest().send(a)}}})}());(function(b){b.VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(a){return a.shiftKey||a.ctrlKey||a.altKey}}})(tinymce);tinymce.util.Quirks=function(Y){var Q=tinymce.VK,I=Q.BACKSPACE,H=Q.DELETE,N=Y.dom,M=Y.selection,K=Y.settings;function Z(a,b){try{Y.getDoc().execCommand(a,false,b)}catch(c){}}function U(){function a(d){var f,b,e,c;f=M.getRng();b=N.getParent(f.startContainer,N.isBlock);if(d){b=N.getNext(b,N.isBlock)}if(b){e=b.firstChild;while(e&&e.nodeType==3&&e.nodeValue.length===0){e=e.nextSibling}if(e&&e.nodeName==="SPAN"){c=e.cloneNode(false)}}Y.getDoc().execCommand(d?"ForwardDelete":"Delete",false,null);b=N.getParent(f.startContainer,N.isBlock);tinymce.each(N.select("span.Apple-style-span,font.Apple-style-span",b),function(h){var g=M.getBookmark();if(c){N.replace(c.cloneNode(false),h,true)}else{N.remove(h,true)}M.moveToBookmark(g)})}Y.onKeyDown.add(function(d,b){var c;if(b.isDefaultPrevented()){return}c=b.keyCode==H;if((c||b.keyCode==I)&&!Q.modifierPressed(b)){b.preventDefault();a(c)}});Y.addCommand("Delete",function(){a()})}function J(){function b(d){var e=N.create("body");var c=d.cloneContents();e.appendChild(c);return M.serializer.serialize(e,{format:"html"})}function a(f){var d=b(f);var c=N.createRng();c.selectNode(Y.getBody());var e=b(c);return d===e}Y.onKeyDown.addToTop(function(e,c){var d=c.keyCode;if(d==H||d==I){var f=M.getRng(true);if(!f.collapsed&&a(f)){e.setContent("",{format:"raw"});e.nodeChanged();c.preventDefault()}}})}function G(){N.bind(Y.getBody(),"focusin",function(){M.setRng(M.getRng())})}function P(){Y.onKeyDown.add(function(d,a){if(a.keyCode===I){if(M.isCollapsed()&&M.getRng(true).startOffset===0){var b=M.getNode();var c=b.previousSibling;if(c&&c.nodeName&&c.nodeName.toLowerCase()==="hr"){N.remove(c);tinymce.dom.Event.cancel(a)}}}})}function aa(){if(!Range.prototype.getClientRects){Y.onMouseDown.add(function(b,a){if(a.target.nodeName==="HTML"){var c=b.getBody();c.blur();setTimeout(function(){c.focus()},0)}})}}function E(){Y.onClick.add(function(b,a){a=a.target;if(/^(IMG|HR)$/.test(a.nodeName)){M.getSel().setBaseAndExtent(a,0,a,1)}if(a.nodeName=="A"&&N.hasClass(a,"mceItemAnchor")){M.select(a)}b.nodeChanged()})}function D(){function b(){var d=N.getAttribs(M.getStart().cloneNode(false));return function(){var e=M.getStart();if(e!==Y.getBody()){N.setAttrib(e,"style",null);tinymce.each(d,function(f){e.setAttributeNode(f.cloneNode(true))})}}}function c(){return !M.isCollapsed()&&M.getStart()!=M.getEnd()}function a(e,d){d.preventDefault();return false}Y.onKeyPress.add(function(f,d){var e;if((d.keyCode==8||d.keyCode==46)&&c()){e=b();f.getDoc().execCommand("delete",false,null);e();d.preventDefault();return false}});N.bind(Y.getDoc(),"cut",function(d){var e;if(c()){e=b();Y.onKeyUp.addToTop(a);setTimeout(function(){e();Y.onKeyUp.remove(a)},0)}})}function T(){var a,b;N.bind(Y.getDoc(),"selectionchange",function(){if(b){clearTimeout(b);b=0}b=window.setTimeout(function(){var c=M.getRng();if(!a||!tinymce.dom.RangeUtils.compareRanges(c,a)){Y.nodeChanged();a=c}},50)})}function C(){document.body.setAttribute("role","application")}function F(){Y.onKeyDown.add(function(c,a){if(a.keyCode===I){if(M.isCollapsed()&&M.getRng(true).startOffset===0){var b=M.getNode().previousSibling;if(b&&b.nodeName&&b.nodeName.toLowerCase()==="table"){return tinymce.dom.Event.cancel(a)}}}})}function V(){var a=Y.getDoc().documentMode;if(a&&a>7){return}Z("RespectVisibilityInDesign",true);N.addClass(Y.getBody(),"mceHideBrInPre");Y.parser.addNodeFilter("pre",function(h,f){var e=h.length,c,g,b,d;while(e--){c=h[e].getAll("br");g=c.length;while(g--){b=c[g];d=b.prev;if(d&&d.type===3&&d.value.charAt(d.value-1)!="\n"){d.value+="\n"}else{b.parent.insert(new tinymce.html.Node("#text",3),b,true).value="\n"}}}});Y.serializer.addNodeFilter("pre",function(h,f){var e=h.length,c,g,b,d;while(e--){c=h[e].getAll("br");g=c.length;while(g--){b=c[g];d=b.prev;if(d&&d.type==3){d.value=d.value.replace(/\r?\n$/,"")}}}})}function W(){N.bind(Y.getBody(),"mouseup",function(a){var b,c=M.getNode();if(c.nodeName=="IMG"){if(b=N.getStyle(c,"width")){N.setAttrib(c,"width",b.replace(/[^0-9%]+/g,""));N.setStyle(c,"width","")}if(b=N.getStyle(c,"height")){N.setAttrib(c,"height",b.replace(/[^0-9%]+/g,""));N.setStyle(c,"height","")}}})}function L(){Y.onKeyDown.add(function(e,d){var f,b,a,h,g,c,j;if(d.isDefaultPrevented()){return}f=d.keyCode==H;if((f||d.keyCode==I)&&!Q.modifierPressed(d)){b=M.getRng();a=b.startContainer;h=b.startOffset;j=b.collapsed;if(a.nodeType==3&&a.nodeValue.length>0&&((h===0&&!j)||(j&&h===(f?0:1)))){nonEmptyElements=e.schema.getNonEmptyElements();d.preventDefault();g=N.create("br",{id:"__tmp"});a.parentNode.insertBefore(g,a);e.getDoc().execCommand(f?"ForwardDelete":"Delete",false,null);a=M.getRng().startContainer;c=a.previousSibling;if(c&&c.nodeType==1&&!N.isBlock(c)&&N.isEmpty(c)&&!nonEmptyElements[c.nodeName.toLowerCase()]){N.remove(c)}N.remove("__tmp")}}})}function X(){Y.onKeyDown.add(function(c,b){var e,f,a,g,d;if(b.keyCode!=Q.BACKSPACE){return}e=M.getRng();f=e.startContainer;a=e.startOffset;g=N.getRoot();d=f;if(!e.collapsed||a!==0){return}while(d&&d.parentNode.firstChild==d&&d.parentNode!=g){d=d.parentNode}if(d.tagName==="BLOCKQUOTE"){c.formatter.toggle("blockquote",null,d);e.setStart(f,0);e.setEnd(f,0);M.setRng(e);M.collapse(false)}})}function R(){function a(){Y._refreshContentEditable();Z("StyleWithCSS",false);Z("enableInlineTableEditing",false);if(!K.object_resizing){Z("enableObjectResizing",false)}}if(!K.readonly){Y.onBeforeExecCommand.add(a);Y.onMouseDown.add(a)}}function O(){function a(c,b){tinymce.each(N.select("a"),function(d){var f=d.parentNode,e=N.getRoot();if(f.lastChild===d){while(f&&!N.isBlock(f)){if(f.parentNode.lastChild!==f||f===e){return}f=f.parentNode}N.add(f,"br",{"data-mce-bogus":1})}})}Y.onExecCommand.add(function(c,b){if(b==="CreateLink"){a(c)}});Y.onSetContent.add(M.onSetContent.add(a))}function ab(){function a(b,c){if(!b||!c.initial){Y.execCommand("mceRepaint")}}Y.onUndo.add(a);Y.onRedo.add(a);Y.onSetContent.add(a)}function S(){Y.onKeyDown.add(function(b,a){if(a.keyCode==8&&M.getNode().nodeName=="IMG"){a.preventDefault();b.undoManager.beforeChange();N.remove(M.getNode());b.undoManager.add()}})}F();X();if(tinymce.isWebKit){L();U();J();G();E();if(tinymce.isIDevice){T()}}if(tinymce.isIE){P();J();C();V();W();S()}if(tinymce.isGecko){P();aa();D();R();O();ab()}};(function(m){var x,p,s,l=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,v=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,q=/[<>&\"\']/g,u=/&(#x|#)?([\w]+);/g,n={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"};p={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};s={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};function o(b){var a;a=document.createElement("div");a.innerHTML=b;return a.textContent||a.innerText||b}function r(a,d){var f,e,b,c={};if(a){a=a.split(",");d=d||10;for(f=0;f<a.length;f+=2){e=String.fromCharCode(parseInt(a[f],d));if(!p[e]){b="&"+a[f+1]+";";c[e]=b;c[b]=e}}return c}}x=r("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);m.html=m.html||{};m.html.Entities={encodeRaw:function(a,b){return a.replace(b?l:v,function(c){return p[c]||c})},encodeAllRaw:function(a){return(""+a).replace(q,function(b){return p[b]||b})},encodeNumeric:function(a,b){return a.replace(b?l:v,function(c){if(c.length>1){return"&#"+(((c.charCodeAt(0)-55296)*1024)+(c.charCodeAt(1)-56320)+65536)+";"}return p[c]||"&#"+c.charCodeAt(0)+";"})},encodeNamed:function(c,b,a){a=a||x;return c.replace(b?l:v,function(d){return p[d]||a[d]||d})},getEncodeFunc:function(b,d){var c=m.html.Entities;d=r(d)||x;function a(f,g){return f.replace(g?l:v,function(h){return p[h]||d[h]||"&#"+h.charCodeAt(0)+";"||h})}function e(f,g){return c.encodeNamed(f,g,d)}b=m.makeMap(b.replace(/\+/g,","));if(b.named&&b.numeric){return a}if(b.named){if(d){return e}return c.encodeNamed}if(b.numeric){return c.encodeNumeric}return c.encodeRaw},decode:function(a){return a.replace(u,function(d,b,c){if(b){c=parseInt(c,b.length===2?16:10);if(c>65535){c-=65536;return String.fromCharCode(55296+(c>>10),56320+(c&1023))}else{return n[c]||String.fromCharCode(c)}}return s[d]||x[d]||o(d)})}}})(tinymce);tinymce.html.Styles=function(x,u){var p=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,r=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,z=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,n=/rgb/,v,s,A={},q;x=x||{};q="\\\" \\' \\; \\: ; : \uFEFF".split(" ");for(s=0;s<q.length;s++){A[q[s]]="\uFEFF"+s;A["\uFEFF"+s]=q[s]}function y(e,b,c,a){function d(f){f=parseInt(f).toString(16);return f.length>1?f:"0"+f}return"#"+d(b)+d(c)+d(a)}return{toHex:function(a){return a.replace(p,y)},parse:function(D){var f={},b,g,k,a,l=x.url_converter,j=x.url_converter_scope||this;function d(K,B){var I,L,M,J;I=f[K+"-top"+B];if(!I){return}L=f[K+"-right"+B];if(I!=L){return}M=f[K+"-bottom"+B];if(L!=M){return}J=f[K+"-left"+B];if(M!=J){return}f[K+B]=J;delete f[K+"-top"+B];delete f[K+"-right"+B];delete f[K+"-bottom"+B];delete f[K+"-left"+B]}function m(F){var B=f[F],G;if(!B||B.indexOf(" ")<0){return}B=B.split(" ");G=B.length;while(G--){if(B[G]!==B[0]){return false}}f[F]=B[0];return true}function c(G,H,I,B){if(!m(H)){return}if(!m(I)){return}if(!m(B)){return}f[G]=f[H]+" "+f[I]+" "+f[B];delete f[H];delete f[I];delete f[B]}function C(B){a=true;return A[B]}function h(B,E){if(a){B=B.replace(/\uFEFF[0-9]/g,function(F){return A[F]})}if(!E){B=B.replace(/\\([\'\";:])/g,"$1")}return B}function e(L,M,I,J,B,K){B=B||K;if(B){B=h(B);return"'"+B.replace(/\'/g,"\\'")+"'"}M=h(M||I||J);if(l){M=l.call(j,M,"style")}return"url('"+M.replace(/\'/g,"\\'")+"')"}if(D){D=D.replace(/\\[\"\';:\uFEFF]/g,C).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(B){return B.replace(/[;:]/g,C)});while(b=z.exec(D)){g=b[1].replace(o,"").toLowerCase();k=b[2].replace(o,"");if(g&&k.length>0){if(g==="font-weight"&&k==="700"){k="bold"}else{if(g==="color"||g==="background-color"){k=k.toLowerCase()}}k=k.replace(p,y);k=k.replace(r,e);f[g]=a?h(k,true):k}z.lastIndex=b.index+b[0].length}d("border","");d("border","-width");d("border","-color");d("border","-style");d("padding","");d("margin","");c("border","border-width","border-style","border-color");if(f.border==="medium none"){delete f.border}}return f},serialize:function(d,b){var e="",f,c;function a(j){var l,h,k,g;l=u.styles[j];if(l){for(h=0,k=l.length;h<k;h++){j=l[h];g=d[j];if(g!==v&&g.length>0){e+=(e.length>0?" ":"")+j+": "+g+";"}}}}if(b&&u&&u.styles){a("*");a(b)}else{for(f in d){c=d[f];if(c!==v&&c.length>0){e+=(e.length>0?" ":"")+f+": "+c+";"}}}return e}}};(function(n){var k={},o=n.makeMap,m=n.each;function p(a,b){return a.split(b||",")}function l(a,b){var d,c={};function e(f){return f.replace(/[A-Z]+/g,function(g){return e(a[g])})}for(d in a){if(a.hasOwnProperty(d)){a[d]=e(a[d])}}e(b).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(f,h,r,g){r=p(r,"|");c[h]={attributes:o(r),attributesOrder:r,children:o(g,"|",{"#comment":{}})}});return c}function j(){var a=k.html5;if(!a){a=k.html5=l({A:"id|accesskey|class|dir|draggable|item|hidden|itemprop|role|spellcheck|style|subject|title",B:"#|a|abbr|area|audio|b|bdo|br|button|canvas|cite|code|command|datalist|del|dfn|em|embed|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|meta|meter|noscript|object|output|progress|q|ruby|samp|script|select|small|span|strong|sub|sup|svg|textarea|time|var|video",C:"#|a|abbr|area|address|article|aside|audio|b|bdo|blockquote|br|button|canvas|cite|code|command|datalist|del|details|dfn|dialog|div|dl|em|embed|fieldset|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|menu|meta|meter|nav|noscript|ol|object|output|p|pre|progress|q|ruby|samp|script|section|select|small|span|strong|style|sub|sup|svg|table|textarea|time|ul|var|video"},"html[A|manifest][body|head]head[A][base|command|link|meta|noscript|script|style|title]title[A][#]base[A|href|target][]link[A|href|rel|media|type|sizes][]meta[A|http-equiv|name|content|charset][]style[A|type|media|scoped][#]script[A|charset|type|src|defer|async][#]noscript[A][C]body[A][C]section[A][C]nav[A][C]article[A][C]aside[A][C]h1[A][B]h2[A][B]h3[A][B]h4[A][B]h5[A][B]h6[A][B]hgroup[A][h1|h2|h3|h4|h5|h6]header[A][C]footer[A][C]address[A][C]p[A][B]br[A][]pre[A][B]dialog[A][dd|dt]blockquote[A|cite][C]ol[A|start|reversed][li]ul[A][li]li[A|value][C]dl[A][dd|dt]dt[A][B]dd[A][C]a[A|href|target|ping|rel|media|type][C]em[A][B]strong[A][B]small[A][B]cite[A][B]q[A|cite][B]dfn[A][B]abbr[A][B]code[A][B]var[A][B]samp[A][B]kbd[A][B]sub[A][B]sup[A][B]i[A][B]b[A][B]mark[A][B]progress[A|value|max][B]meter[A|value|min|max|low|high|optimum][B]time[A|datetime][B]ruby[A][B|rt|rp]rt[A][B]rp[A][B]bdo[A][B]span[A][B]ins[A|cite|datetime][B]del[A|cite|datetime][B]figure[A][C|legend|figcaption]figcaption[A][C]img[A|alt|src|height|width|usemap|ismap][]iframe[A|name|src|height|width|sandbox|seamless][]embed[A|src|height|width|type][]object[A|data|type|height|width|usemap|name|form|classid][param]param[A|name|value][]details[A|open][C|legend]command[A|type|label|icon|disabled|checked|radiogroup][]menu[A|type|label][C|li]legend[A][C|B]div[A][C]source[A|src|type|media][]audio[A|src|autobuffer|autoplay|loop|controls][source]video[A|src|autobuffer|autoplay|loop|controls|width|height|poster][source]hr[A][]form[A|accept-charset|action|autocomplete|enctype|method|name|novalidate|target][C]fieldset[A|disabled|form|name][C|legend]label[A|form|for][B]input[A|type|accept|alt|autocomplete|checked|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|height|list|max|maxlength|min|multiple|pattern|placeholder|readonly|required|size|src|step|width|files|value][]button[A|autofocus|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|name|value|type][B]select[A|autofocus|disabled|form|multiple|name|size][option|optgroup]datalist[A][B|option]optgroup[A|disabled|label][option]option[A|disabled|selected|label|value][]textarea[A|autofocus|disabled|form|maxlength|name|placeholder|readonly|required|rows|cols|wrap][]keygen[A|autofocus|challenge|disabled|form|keytype|name][]output[A|for|form|name][B]canvas[A|width|height][]map[A|name][B|C]area[A|shape|coords|href|alt|target|media|rel|ping|type][]mathml[A][]svg[A][]table[A|summary][caption|colgroup|thead|tfoot|tbody|tr]caption[A][C]colgroup[A|span][col]col[A|span][]thead[A][tr]tfoot[A][tr]tbody[A][tr]tr[A][th|td]th[A|headers|rowspan|colspan|scope][B]td[A|headers|rowspan|colspan][C]")}return a}function q(){var a=k.html4;if(!a){a=k.html4=l({Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"},"script[id|charset|type|language|src|defer|xml:space][]style[B|id|type|media|title|xml:space][]object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]param[id|name|value|valuetype|type][]p[E|align][#|S]a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]br[A|clear][]span[E][#|S]bdo[A|C|B][#|S]applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]h1[E|align][#|S]img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]map[B|C|A|name][X|form|Q|area]h2[E|align][#|S]iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]h3[E|align][#|S]tt[E][#|S]i[E][#|S]b[E][#|S]u[E][#|S]s[E][#|S]strike[E][#|S]big[E][#|S]small[E][#|S]font[A|B|size|color|face][#|S]basefont[id|size|color|face][]em[E][#|S]strong[E][#|S]dfn[E][#|S]code[E][#|S]q[E|cite][#|S]samp[E][#|S]kbd[E][#|S]var[E][#|S]cite[E][#|S]abbr[E][#|S]acronym[E][#|S]sub[E][#|S]sup[E][#|S]input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]optgroup[E|disabled|label][option]option[E|selected|disabled|label|value][]textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]label[E|for|accesskey|onfocus|onblur][#|S]button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[E|align][#|S]ins[E|cite|datetime][#|Y]h5[E|align][#|S]del[E|cite|datetime][#|Y]h6[E|align][#|S]div[E|align][#|Y]ul[E|type|compact][li]li[E|type|value][#|Y]ol[E|type|compact|start][li]dl[E|compact][dt|dd]dt[E][#|S]dd[E][#|Y]menu[E|compact][li]dir[E|compact][li]pre[E|width|xml:space][#|ZA]hr[E|align|noshade|size|width][]blockquote[E|cite][#|Y]address[E][#|S|p]center[E][#|Y]noframes[E][#|Y]isindex[A|B|prompt][]fieldset[E][#|legend|Y]legend[E|accesskey|align][#|S]table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]caption[E|align][#|S]col[ZG][]colgroup[ZG][col]thead[ZF][tr]tr[ZF|bgcolor][th|td]th[E|ZE][#|Y]form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]noscript[E][#|Y]td[E|ZE][#|Y]tfoot[ZF][tr]tbody[ZF][tr]area[E|D|shape|coords|href|nohref|alt|target][]base[id|href|target][]body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]")}return a}n.html.Schema=function(H){var d=this,g={},P={},Q=[],f,a;var L,I,J,G,c,M,K={};function N(u,v,r){var s=H[u];if(!s){s=k[u];if(!s){s=o(v," ",o(v.toUpperCase()," "));s=n.extend(s,r);k[u]=s}}else{s=o(s,",",o(s.toUpperCase()," "))}return s}H=H||{};a=H.schema=="html5"?j():q();if(H.verify_html===false){H.valid_elements="*[*]"}if(H.valid_styles){f={};m(H.valid_styles,function(r,s){f[s]=n.explode(r)})}L=N("whitespace_elements","pre script style textarea");I=N("self_closing_elements","colgroup dd dt li options p td tfoot th thead tr");J=N("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source");G=N("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");M=N("non_empty_elements","td th iframe video audio object",J);c=N("block_elements","h1 h2 h3 h4 h5 h6 hr p div address pre form table tbody thead tfoot th tr td li ol ul caption blockquote center dl dt dd dir fieldset noscript menu isindex samp header footer article section hgroup aside nav figure");function R(r){return new RegExp("^"+r.replace(/([?+*])/g,".$1")+"$")}function h(ag){var ah,al,at,v,ar,am,aj,x,s,B,r,ap,D,ai,u,an,z,ak,aq,ao,C,y,E=/^([#+\-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,A=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,af=/[*?+]/;if(ag){ag=p(ag);if(g["@"]){z=g["@"].attributes;ak=g["@"].attributesOrder}for(ah=0,al=ag.length;ah<al;ah++){am=E.exec(ag[ah]);if(am){u=am[1];B=am[2];an=am[3];s=am[4];D={};ai=[];aj={attributes:D,attributesOrder:ai};if(u==="#"){aj.paddEmpty=true}if(u==="-"){aj.removeEmpty=true}if(z){for(ao in z){D[ao]=z[ao]}ai.push.apply(ai,ak)}if(s){s=p(s,"|");for(at=0,v=s.length;at<v;at++){am=A.exec(s[at]);if(am){x={};ap=am[1];r=am[2].replace(/::/g,":");u=am[3];y=am[4];if(ap==="!"){aj.attributesRequired=aj.attributesRequired||[];aj.attributesRequired.push(r);x.required=true}if(ap==="-"){delete D[r];ai.splice(n.inArray(ai,r),1);continue}if(u){if(u==="="){aj.attributesDefault=aj.attributesDefault||[];aj.attributesDefault.push({name:r,value:y});x.defaultValue=y}if(u===":"){aj.attributesForced=aj.attributesForced||[];aj.attributesForced.push({name:r,value:y});x.forcedValue=y}if(u==="<"){x.validValues=o(y,"?")}}if(af.test(r)){aj.attributePatterns=aj.attributePatterns||[];x.pattern=R(r);aj.attributePatterns.push(x)}else{if(!D[r]){ai.push(r)}D[r]=x}}}}if(!z&&B=="@"){z=D;ak=ai}if(an){aj.outputName=B;g[an]=aj}if(af.test(B)){aj.pattern=R(B);Q.push(aj)}else{g[B]=aj}}}}}function e(r){g={};Q=[];h(r);m(a,function(s,u){P[u]=s.children})}function O(r){var s=/^(~)?(.+)$/;if(r){m(p(r),function(v){var y=s.exec(v),x=y[1]==="~",u=x?"span":"div",z=y[2];P[z]=P[u];K[z]=u;if(!x){c[z]={}}m(P,function(B,A){if(B[u]){B[z]=B[u]}})})}}function b(r){var s=/^([+\-]?)(\w+)\[([^\]]+)\]$/;if(r){m(p(r),function(u){var v=s.exec(u),y,x;if(v){x=v[1];if(x){y=P[v[2]]}else{y=P[v[2]]={"#comment":{}}}y=P[v[2]];m(p(v[3],"|"),function(z){if(x==="-"){delete y[z]}else{y[z]={}}})}})}}function F(u){var r=g[u],s;if(r){return r}s=Q.length;while(s--){r=Q[s];if(r.pattern.test(u)){return r}}}if(!H.valid_elements){m(a,function(r,s){g[s]={attributes:r.attributes,attributesOrder:r.attributesOrder};P[s]=r.children});if(H.schema!="html5"){m(p("strong/b,em/i"),function(r){r=p(r,"/");g[r[1]].outputName=r[0]})}g.img.attributesDefault=[{name:"alt",value:""}];m(p("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr,strong,em,b,i"),function(r){if(g[r]){g[r].removeEmpty=true}});m(p("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(r){g[r].paddEmpty=true})}else{e(H.valid_elements)}O(H.custom_elements);b(H.valid_children);h(H.extended_valid_elements);b("+ol[ul|ol],+ul[ul|ol]");if(H.invalid_elements){n.each(n.explode(H.invalid_elements),function(r){if(g[r]){delete g[r]}})}if(!F("span")){h("span[!data-mce-type|*]")}d.children=P;d.styles=f;d.getBoolAttrs=function(){return G};d.getBlockElements=function(){return c};d.getShortEndedElements=function(){return J};d.getSelfClosingElements=function(){return I};d.getNonEmptyElements=function(){return M};d.getWhiteSpaceElements=function(){return L};d.isValidChild=function(u,r){var s=P[u];return !!(s&&s[r])};d.getElementRule=F;d.getCustomElements=function(){return K};d.addValidElements=h;d.setValidElements=e;d.addCustomElements=O;d.addValidChildren=b}})(tinymce);(function(b){b.html.SaxParser=function(h,f){var a=this,g=function(){};h=h||{};a.schema=f=f||new b.html.Schema();if(h.fix_self_closing!==false){h.fix_self_closing=true}b.each("comment cdata text start end pi doctype".split(" "),function(c){if(c){a[c]=h[c]||g}});a.parse=function(af){var aw=this,aC,ad=0,ab,ai,aj=[],W,e,ah,ar,ak,aq,X,ac,V,an,ax,az,ap,d,av,U,ae,c,Y,aD,aa,ay,ag,Z,aB,am=0,aA=b.html.Entities.decode,al,at;function ao(l){var j,k;j=aj.length;while(j--){if(aj[j].name===l){break}}if(j>=0){for(k=aj.length-1;k>=j;k--){l=aj[k];if(l.valid){aw.end(l.name)}}aj.length=j}}function au(k,l,n,o,p){var m,j;l=l.toLowerCase();n=l in ac?l:aA(n||o||p||"");if(an&&!ak&&l.indexOf("data-")!==0){m=U[l];if(!m&&ae){j=ae.length;while(j--){m=ae[j];if(m.pattern.test(l)){break}}if(j===-1){m=null}}if(!m){return}if(m.validValues&&!(n in m.validValues)){return}}W.map[l]=n;W.push({name:l,value:n})}ay=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g");ag=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;Z={script:/<\/script[^>]*>/gi,style:/<\/style[^>]*>/gi,noscript:/<\/noscript[^>]*>/gi};X=f.getShortEndedElements();aa=f.getSelfClosingElements();ac=f.getBoolAttrs();an=h.validate;aq=h.remove_internals;al=h.fix_self_closing;at=b.isIE;av=/^:/;while(aC=ay.exec(af)){if(ad<aC.index){aw.text(aA(af.substr(ad,aC.index-ad)))}if(ab=aC[6]){ab=ab.toLowerCase();if(at&&av.test(ab)){ab=ab.substr(1)}ao(ab)}else{if(ab=aC[7]){ab=ab.toLowerCase();if(at&&av.test(ab)){ab=ab.substr(1)}V=ab in X;if(al&&aa[ab]&&aj.length>0&&aj[aj.length-1].name===ab){ao(ab)}if(!an||(ax=f.getElementRule(ab))){az=true;if(an){U=ax.attributes;ae=ax.attributePatterns}if(d=aC[8]){ak=d.indexOf("data-mce-type")!==-1;if(ak&&aq){az=false}W=[];W.map={};d.replace(ag,au)}else{W=[];W.map={}}if(an&&!ak){c=ax.attributesRequired;Y=ax.attributesDefault;aD=ax.attributesForced;if(aD){e=aD.length;while(e--){ap=aD[e];ar=ap.name;aB=ap.value;if(aB==="{$uid}"){aB="mce_"+am++}W.map[ar]=aB;W.push({name:ar,value:aB})}}if(Y){e=Y.length;while(e--){ap=Y[e];ar=ap.name;if(!(ar in W.map)){aB=ap.value;if(aB==="{$uid}"){aB="mce_"+am++}W.map[ar]=aB;W.push({name:ar,value:aB})}}}if(c){e=c.length;while(e--){if(c[e] in W.map){break}}if(e===-1){az=false}}if(W.map["data-mce-bogus"]){az=false}}if(az){aw.start(ab,W,V)}}else{az=false}if(ai=Z[ab]){ai.lastIndex=ad=aC.index+aC[0].length;if(aC=ai.exec(af)){if(az){ah=af.substr(ad,aC.index-ad)}ad=aC.index+aC[0].length}else{ah=af.substr(ad);ad=af.length}if(az&&ah.length>0){aw.text(ah,true)}if(az){aw.end(ab)}ay.lastIndex=ad;continue}if(!V){if(!d||d.indexOf("/")!=d.length-1){aj.push({name:ab,valid:az})}else{if(az){aw.end(ab)}}}}else{if(ab=aC[1]){aw.comment(ab)}else{if(ab=aC[2]){aw.cdata(ab)}else{if(ab=aC[3]){aw.doctype(ab)}else{if(ab=aC[4]){aw.pi(ab,aC[5])}}}}}}ad=aC.index+aC[0].length}if(ad<af.length){aw.text(aA(af.substr(ad)))}for(e=aj.length-1;e>=0;e--){ab=aj[e];if(ab.valid){aw.end(ab.name)}}}}})(tinymce);(function(j){var k=/^[ \t\r\n]*$/,h={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};function g(b,a,c){var d,e,n=c?"lastChild":"firstChild",m=c?"prev":"next";if(b[n]){return b[n]}if(b!==a){d=b[m];if(d){return d}for(e=b.parent;e&&e!==a;e=e.parent){d=e[m];if(d){return d}}}}function f(b,a){this.name=b;this.type=a;if(a===1){this.attributes=[];this.attributes.map={}}}j.extend(f.prototype,{replace:function(a){var b=this;if(a.parent){a.remove()}b.insert(a,b);b.remove();return b},attr:function(d,a){var m=this,e,c,b;if(typeof d!=="string"){for(c in d){m.attr(c,d[c])}return m}if(e=m.attributes){if(a!==b){if(a===null){if(d in e.map){delete e.map[d];c=e.length;while(c--){if(e[c].name===d){e=e.splice(c,1);return m}}}return m}if(d in e.map){c=e.length;while(c--){if(e[c].name===d){e[c].value=a;break}}}else{e.push({name:d,value:a})}e.map[d]=a;return m}else{return e.map[d]}}},clone:function(){var e=this,o=new f(e.name,e.type),d,l,a,c,b;if(a=e.attributes){b=[];b.map={};for(d=0,l=a.length;d<l;d++){c=a[d];if(c.name!=="id"){b[b.length]={name:c.name,value:c.value};b.map[c.name]=c.value}}o.attributes=b}o.value=e.value;o.shortEnded=e.shortEnded;return o},wrap:function(a){var b=this;b.parent.insert(a,b);a.append(b);return b},unwrap:function(){var c=this,a,b;for(a=c.firstChild;a;){b=a.next;c.insert(a,c,true);a=b}c.remove()},remove:function(){var d=this,b=d.parent,c=d.next,a=d.prev;if(b){if(b.firstChild===d){b.firstChild=c;if(c){c.prev=null}}else{a.next=c}if(b.lastChild===d){b.lastChild=a;if(a){a.next=null}}else{c.prev=a}d.parent=d.next=d.prev=null}return d},append:function(a){var c=this,b;if(a.parent){a.remove()}b=c.lastChild;if(b){b.next=a;a.prev=b;c.lastChild=a}else{c.lastChild=c.firstChild=a}a.parent=c;return a},insert:function(b,d,a){var c;if(b.parent){b.remove()}c=d.parent||this;if(a){if(d===c.firstChild){c.firstChild=b}else{d.prev.next=b}b.prev=d.prev;b.next=d;d.prev=b}else{if(d===c.lastChild){c.lastChild=b}else{d.next.prev=b}b.next=d.next;b.prev=d;d.next=b}b.parent=c;return b},getAll:function(c){var d=this,b,a=[];for(b=d.firstChild;b;b=g(b,d)){if(b.name===c){a.push(b)}}return a},empty:function(){var c=this,d,b,a;if(c.firstChild){d=[];for(a=c.firstChild;a;a=g(a,c)){d.push(a)}b=d.length;while(b--){a=d[b];a.parent=a.firstChild=a.lastChild=a.next=a.prev=null}}c.firstChild=c.lastChild=null;return c},isEmpty:function(a){var e=this,b=e.firstChild,c,d;if(b){do{if(b.type===1){if(b.attributes.map["data-mce-bogus"]){continue}if(a[b.name]){return false}c=b.attributes.length;while(c--){d=b.attributes[c].name;if(d==="name"||d.indexOf("data-")===0){return false}}}if(b.type===8){return false}if((b.type===3&&!k.test(b.value))){return false}}while(b=g(b,e))}return true},walk:function(a){return g(this,null,a)}});j.extend(f,{create:function(c,d){var a,b;a=new f(c,h[c]||1);if(d){for(b in d){a.attr(b,d[b])}}return a}});j.html.Node=f})(tinymce);(function(c){var d=c.html.Node;c.html.DomParser=function(l,k){var m=this,n={},o=[],b={},p={};l=l||{};l.validate="validate" in l?l.validate:true;l.root_name=l.root_name||"body";m.schema=k=k||new c.html.Schema();function a(C){var h,g,G,H,j,B,f,D,J,I,E,K,F,e;K=c.makeMap("tr,td,th,tbody,thead,tfoot,table");E=k.getNonEmptyElements();for(h=0;h<C.length;h++){g=C[h];if(!g.parent){continue}H=[g];for(G=g.parent;G&&!k.isValidChild(G.name,g.name)&&!K[G.name];G=G.parent){H.push(G)}if(G&&H.length>1){H.reverse();j=B=m.filterNode(H[0].clone());for(J=0;J<H.length-1;J++){if(k.isValidChild(B.name,H[J].name)){f=m.filterNode(H[J].clone());B.append(f)}else{f=B}for(D=H[J].firstChild;D&&D!=H[J+1];){e=D.next;f.append(D);D=e}B=f}if(!j.isEmpty(E)){G.insert(j,H[0],true);G.insert(g,j)}else{G.insert(g,H[0],true)}G=H[0];if(G.isEmpty(E)||G.firstChild===G.lastChild&&G.firstChild.name==="br"){G.empty().remove()}}else{if(g.parent){if(g.name==="li"){F=g.prev;if(F&&(F.name==="ul"||F.name==="ul")){F.append(g);continue}F=g.next;if(F&&(F.name==="ul"||F.name==="ul")){F.insert(g,F.firstChild,true);continue}g.wrap(m.filterNode(new d("ul",1)));continue}if(k.isValidChild(g.parent.name,"div")&&k.isValidChild("div",g.name)){g.wrap(m.filterNode(new d("div",1)))}else{if(g.name==="style"||g.name==="script"){g.empty().remove()}else{g.unwrap()}}}}}}m.filterNode=function(e){var f,g,h;if(g in n){h=b[g];if(h){h.push(e)}else{b[g]=[e]}}f=o.length;while(f--){g=o[f].name;if(g in e.attributes.map){h=p[g];if(h){h.push(e)}else{p[g]=[e]}}}return e};m.addNodeFilter=function(f,e){c.each(c.explode(f),function(g){var h=n[g];if(!h){n[g]=h=[]}h.push(e)})};m.addAttributeFilter=function(f,e){c.each(c.explode(f),function(g){var h;for(h=0;h<o.length;h++){if(o[h].name===g){o[h].callbacks.push(e);return}}o.push({name:g,callbacks:[e]})})};m.parse=function(P,ag){var af,O,ab,ad,X,Y,N,Z,U,e,h,ae,V,f=[],g,T,ah,W,ac,S,aa;ag=ag||{};b={};p={};ae=c.extend(c.makeMap("script,style,head,html,body,title,meta,param"),k.getBlockElements());S=k.getNonEmptyElements();ac=k.children;h=l.validate;aa="forced_root_block" in ag?ag.forced_root_block:l.forced_root_block;W=k.getWhiteSpaceElements();V=/^[ \t\r\n]+/;T=/[ \t\r\n]+$/;ah=/[ \t\r\n]+/g;function R(){var s=O.firstChild,q,r;while(s){q=s.next;if(s.type==3||(s.type==1&&s.name!=="p"&&!ae[s.name]&&!s.attr("data-mce-type"))){if(!r){r=j(aa,1);O.insert(r,s);r.append(s)}else{r.append(s)}}else{r=null}s=q}}function j(q,u){var s=new d(q,u),r;if(q in n){r=b[q];if(r){r.push(s)}else{b[q]=[s]}}return s}function Q(s){var r,q,u;for(r=s.prev;r&&r.type===3;){q=r.value.replace(T,"");if(q.length>0){r.value=q;r=r.prev}else{u=r.prev;r.remove();r=u}}}af=new c.html.SaxParser({validate:h,fix_self_closing:!h,cdata:function(q){ab.append(j("#cdata",4)).value=q},text:function(r,q){var s;if(!g){r=r.replace(ah," ");if(ab.lastChild&&ae[ab.lastChild.name]){r=r.replace(V,"")}}if(r.length!==0){s=j("#text",3);s.raw=!!q;ab.append(s).value=r}},comment:function(q){ab.append(j("#comment",8)).value=q},pi:function(q,r){ab.append(j(q,7)).value=r;Q(ab)},doctype:function(r){var q;q=ab.append(j("#doctype",10));q.value=r;Q(ab)},start:function(u,r,B){var v,z,A,C,y,q,s,x;A=h?k.getElementRule(u):{};if(A){v=j(A.outputName||u,1);v.attributes=r;v.shortEnded=B;ab.append(v);x=ac[ab.name];if(x&&ac[v.name]&&!x[v.name]){f.push(v)}z=o.length;while(z--){y=o[z].name;if(y in r.map){U=p[y];if(U){U.push(v)}else{p[y]=[v]}}}if(ae[u]){Q(v)}if(!B){ab=v}if(!g&&W[u]){g=true}}},end:function(q){var r,v,s,x,u;v=h?k.getElementRule(q):{};if(v){if(ae[q]){if(!g){for(r=ab.firstChild;r&&r.type===3;){s=r.value.replace(V,"");if(s.length>0){r.value=s;r=r.next}else{x=r.next;r.remove();r=x}}for(r=ab.lastChild;r&&r.type===3;){s=r.value.replace(T,"");if(s.length>0){r.value=s;r=r.prev}else{x=r.prev;r.remove();r=x}}}r=ab.prev;if(r&&r.type===3){s=r.value.replace(V,"");if(s.length>0){r.value=s}else{r.remove()}}}if(g&&W[q]){g=false}if(v.removeEmpty||v.paddEmpty){if(ab.isEmpty(S)){if(v.paddEmpty){ab.empty().append(new d("#text","3")).value="\u00a0"}else{if(!ab.attributes.map.name){u=ab.parent;ab.empty().remove();ab=u;return}}}}ab=ab.parent}}},k);O=ab=new d(ag.context||l.root_name,11);af.parse(P);if(h&&f.length){if(!ag.context){a(f)}else{ag.invalid=true}}if(aa&&O.name=="body"){R()}if(!ag.invalid){for(e in b){U=n[e];ad=b[e];N=ad.length;while(N--){if(!ad[N].parent){ad.splice(N,1)}}for(X=0,Y=U.length;X<Y;X++){U[X](ad,e,ag)}}for(X=0,Y=o.length;X<Y;X++){U=o[X];if(U.name in p){ad=p[U.name];N=ad.length;while(N--){if(!ad[N].parent){ad.splice(N,1)}}for(N=0,Z=U.callbacks.length;N<Z;N++){U.callbacks[N](ad,U.name,ag)}}}}return O};if(l.remove_trailing_brs){m.addNodeFilter("br",function(j,y){var e,f=j.length,h,A=c.extend({},k.getBlockElements()),z=k.getNonEmptyElements(),C,D,g,B;A.body=1;for(e=0;e<f;e++){h=j[e];C=h.parent;if(A[h.parent.name]&&h===C.lastChild){g=h.prev;while(g){B=g.name;if(B!=="span"||g.attr("data-mce-type")!=="bookmark"){if(B!=="br"){break}if(B==="br"){h=null;break}}g=g.prev}if(h){h.remove();if(C.isEmpty(z)){elementRule=k.getElementRule(C.name);if(elementRule){if(elementRule.removeEmpty){C.remove()}else{if(elementRule.paddEmpty){C.empty().append(new c.html.Node("#text",3)).value="\u00a0"}}}}}}else{D=h;while(C.firstChild===D&&C.lastChild===D){D=C;if(A[C.name]){break}C=C.parent}if(D===C){textNode=new c.html.Node("#text",3);textNode.value="\u00a0";h.replace(textNode)}}}})}if(!l.allow_html_in_named_anchor){m.addAttributeFilter("name",function(g,f){var s=g.length,j,e,r,h;while(s--){h=g[s];if(h.name==="a"&&h.firstChild){r=h.parent;j=h.lastChild;do{e=j.prev;r.insert(j,h);j=e}while(j)}}})}}})(tinymce);tinymce.html.Writer=function(m){var o=[],j,h,n,l,k;m=m||{};j=m.indent;h=tinymce.makeMap(m.indent_before||"");n=tinymce.makeMap(m.indent_after||"");l=tinymce.html.Entities.getEncodeFunc(m.entity_encoding||"raw",m.entities);k=m.element_format=="html";return{start:function(a,b,e){var g,c,d,f;if(j&&h[a]&&o.length>0){f=o[o.length-1];if(f.length>0&&f!=="\n"){o.push("\n")}}o.push("<",a);if(b){for(g=0,c=b.length;g<c;g++){d=b[g];o.push(" ",d.name,'="',l(d.value,true),'"')}}if(!e||k){o[o.length]=">"}else{o[o.length]=" />"}if(e&&j&&n[a]&&o.length>0){f=o[o.length-1];if(f.length>0&&f!=="\n"){o.push("\n")}}},end:function(b){var a;o.push("</",b,">");if(j&&n[b]&&o.length>0){a=o[o.length-1];if(a.length>0&&a!=="\n"){o.push("\n")}}},text:function(a,b){if(a.length>0){o[o.length]=b?a:l(a)}},cdata:function(a){o.push("<![CDATA[",a,"]]>")},comment:function(a){o.push("<!--",a,"-->")},pi:function(b,a){if(a){o.push("<?",b," ",a,"?>")}else{o.push("<?",b,"?>")}if(j){o.push("\n")}},doctype:function(a){o.push("<!DOCTYPE",a,">",j?"\n":"")},reset:function(){o.length=0},getContent:function(){return o.join("").replace(/\n$/,"")}}};(function(b){b.html.Serializer=function(h,g){var a=this,f=new b.html.Writer(h);h=h||{};h.validate="validate" in h?h.validate:true;a.schema=g=g||new b.html.Schema();a.writer=f;a.serialize=function(d){var e,c;c=h.validate;e={3:function(l,m){f.text(l.value,l.raw)},8:function(k){f.comment(k.value)},7:function(k){f.pi(k.name,k.value)},10:function(k){f.doctype(k.value)},4:function(k){f.cdata(k.value)},11:function(k){if((k=k.firstChild)){do{j(k)}while(k=k.next)}}};f.reset();function j(C){var F=e[C.type],D,z,G,l,y,E,A,B,x;if(!F){D=C.name;z=C.shortEnded;G=C.attributes;if(c&&G&&G.length>1){E=[];E.map={};x=g.getElementRule(C.name);for(A=0,B=x.attributesOrder.length;A<B;A++){l=x.attributesOrder[A];if(l in G.map){y=G.map[l];E.map[l]=y;E.push({name:l,value:y})}}for(A=0,B=G.length;A<B;A++){l=G[A].name;if(!(l in E.map)){y=G.map[l];E.map[l]=y;E.push({name:l,value:y})}}G=E}f.start(C.name,G,z);if(!z){if((C=C.firstChild)){do{j(C)}while(C=C.next)}f.end(D)}}else{F(C)}}if(d.type==1&&!h.inner){j(d)}else{e[11](d)}return f.getContent()}}})(tinymce);tinymce.dom={};(function(j,l){var m=!!document.addEventListener;function q(b,c,a,d){if(b.addEventListener){b.addEventListener(c,a,d||false)}else{if(b.attachEvent){b.attachEvent("on"+c,a)}}}function o(b,c,a,d){if(b.removeEventListener){b.removeEventListener(c,a,d||false)}else{if(b.detachEvent){b.detachEvent("on"+c,a)}}}function k(f,b){var e,c=b||{};function d(){return false}function a(){return true}for(e in f){if(e!=="layerX"&&e!=="layerY"){c[e]=f[e]}}if(!c.target){c.target=c.srcElement||document}c.preventDefault=function(){c.isDefaultPrevented=a;if(f){if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}}};c.stopPropagation=function(){c.isPropagationStopped=a;if(f){if(f.stopPropagation){f.stopPropagation()}else{f.cancelBubble=true}}};c.stopImmediatePropagation=function(){c.isImmediatePropagationStopped=a;c.stopPropagation()};if(!c.isDefaultPrevented){c.isDefaultPrevented=d;c.isPropagationStopped=d;c.isImmediatePropagationStopped=d}return c}function p(a,f,b){var c=a.document,d={type:"ready"};function e(){if(!b.domLoaded){b.domLoaded=true;f(d)}}if(m){q(a,"DOMContentLoaded",e)}else{q(c,"readystatechange",function(){if(c.readyState==="complete"){o(c,"readystatechange",arguments.callee);e()}});if(c.documentElement.doScroll&&a===a.top){(function(){try{c.documentElement.doScroll("left")}catch(g){setTimeout(arguments.callee,0);return}e()})()}}q(a,"load",e)}function n(g){var a=this,b={},r,c,d,e,f;e="onmouseenter" in document.documentElement;d="onfocusin" in document.documentElement;f={mouseenter:"mouseover",mouseleave:"mouseout"};r=1;a.domLoaded=false;a.events=b;function h(B,E){var C,A,D,z;C=b[E][B.type];if(C){for(A=0,D=C.length;A<D;A++){z=C[A];if(z&&z.func.call(z.scope,B)===false){B.preventDefault()}if(B.isImmediatePropagationStopped()){return}}}}a.bind=function(M,J,R,Q){var S,P,O,H,I,K,G,N=window;function L(s){h(k(s||N.event),S)}if(!M||M.nodeType===3||M.nodeType===8){return}if(!M[l]){S=r++;M[l]=S;b[S]={}}else{S=M[l];if(!b[S]){b[S]={}}}Q=Q||M;J=J.split(" ");O=J.length;while(O--){H=J[O];K=L;I=G=false;if(H==="DOMContentLoaded"){H="ready"}if((a.domLoaded||M.readyState=="complete")&&H==="ready"){a.domLoaded=true;R.call(Q,k({type:H}));continue}if(!e){I=f[H];if(I){K=function(v){var s,u;s=v.currentTarget;u=v.relatedTarget;if(u&&s.contains){u=s.contains(u)}else{while(u&&u!==s){u=u.parentNode}}if(!u){v=k(v||N.event);v.type=v.type==="mouseout"?"mouseleave":"mouseenter";v.target=s;h(v,S)}}}}if(!d&&(H==="focusin"||H==="focusout")){G=true;I=H==="focusin"?"focus":"blur";K=function(s){s=k(s||N.event);s.type=s.type==="focus"?"focusin":"focusout";h(s,S)}}P=b[S][H];if(!P){b[S][H]=P=[{func:R,scope:Q}];P.fakeName=I;P.capture=G;P.nativeHandler=K;if(!m){P.proxyHandler=g(S)}if(H==="ready"){p(M,K,a)}else{q(M,I||H,m?K:P.proxyHandler,G)}}else{P.push({func:R,scope:Q})}}M=P=0;return R};a.unbind=function(I,G,F){var M,K,J,E,D,L;if(!I||I.nodeType===3||I.nodeType===8){return a}M=I[l];if(M){L=b[M];if(G){G=G.split(" ");J=G.length;while(J--){D=G[J];K=L[D];if(K){if(F){E=K.length;while(E--){if(K[E].func===F){K.splice(E,1)}}}if(!F||K.length===0){delete L[D];o(I,K.fakeName||D,m?K.nativeHandler:K.proxyHandler,K.capture)}}}}else{for(D in L){K=L[D];o(I,K.fakeName||D,m?K.nativeHandler:K.proxyHandler,K.capture)}L={}}for(D in L){return a}delete b[M];try{delete I[l]}catch(H){I[l]=null}}return a};a.fire=function(z,B,C){var y,A;if(!z||z.nodeType===3||z.nodeType===8){return a}A=k(null,C);A.type=B;do{y=z[l];if(y){h(A,y)}z=z.parentNode||z.ownerDocument||z.defaultView||z.parentWindow}while(z&&!A.isPropagationStopped());return a};a.clean=function(x){var z,A,y=a.unbind;if(!x||x.nodeType===3||x.nodeType===8){return a}if(x[l]){y(x)}if(!x.getElementsByTagName){x=x.document}if(x&&x.getElementsByTagName){y(x);A=x.getElementsByTagName("*");z=A.length;while(z--){x=A[z];if(x[l]){y(x)}}}return a};a.callNativeHandler=function(u,v){if(b){b[u][v.type].nativeHandler(v)}};a.destory=function(){b={}};a.add=function(y,B,z,A){if(typeof(y)==="string"){y=document.getElementById(y)}if(y&&y instanceof Array){var C=y;while(C--){a.add(y[C],B,z,A)}return}if(B==="init"){B="ready"}return a.bind(y,B instanceof Array?B.join(" "):B,z,A)};a.remove=function(x,z,y){if(typeof(x)==="string"){x=document.getElementById(x)}if(x instanceof Array){var A=x;while(A--){a.remove(x[A],z,y,scope)}return a}return a.unbind(x,z instanceof Array?z.join(" "):z,y)};a.clear=function(s){if(typeof(s)==="string"){s=document.getElementById(s)}return a.clean(s)};a.cancel=function(s){if(s){a.prevent(s);a.stop(s)}return false};a.prevent=function(s){s.preventDefault();return false};a.stop=function(s){s.stopPropagation();return false}}j.EventUtils=n;j.Event=new n(function(a){return function(b){tinymce.dom.Event.callNativeHandler(a,b)}});j.Event.bind(window,"ready",function(){});j=0})(tinymce.dom,"data-mce-expando");tinymce.dom.TreeWalker=function(f,h){var e=f;function g(b,k,l,a){var c,d;if(b){if(!a&&b[k]){return b[k]}if(b!=h){c=b[l];if(c){return c}for(d=b.parentNode;d&&d!=h;d=d.parentNode){c=d[l];if(c){return c}}}}}this.current=function(){return e};this.next=function(a){return(e=g(e,"firstChild","nextSibling",a))};this.prev=function(a){return(e=g(e,"lastChild","previousSibling",a))}};(function(o){var m=o.each,p=o.is,n=o.isWebKit,j=o.isIE,l=o.html.Entities,q=/^([a-z0-9],?)+$/i,k=/^[ \t\r\n]*$/;o.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},DOMUtils:function(f,b){var c=this,e,d,g;c.doc=f;c.win=window;c.files={};c.cssFlicker=false;c.counter=0;c.stdMode=!o.isIE||f.documentMode>=8;c.boxModel=!o.isIE||f.compatMode=="CSS1Compat"||c.stdMode;c.hasOuterHTML="outerHTML" in f.createElement("a");c.settings=b=o.extend({keep_values:false,hex_colors:1},b);c.schema=b.schema;c.styles=new o.html.Styles({url_converter:b.url_converter,url_converter_scope:b.url_converter_scope},b.schema);if(o.isIE6){try{f.execCommand("BackgroundImageCache",false,true)}catch(a){c.cssFlicker=true}}c.fixDoc(f);c.events=b.ownEvents?new o.dom.EventUtils(b.proxy):o.dom.Event;o.addUnload(c.destroy,c);g=b.schema?b.schema.getBlockElements():{};c.isBlock=function(h){var r=h.nodeType;if(r){return !!(r===1&&g[h.nodeName])}return !!g[h]}},fixDoc:function(a){var b=this.settings,c;if(j&&b.schema){("abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video").replace(/\w+/g,function(d){a.createElement(d)});for(c in b.schema.getCustomElements()){a.createElement(c)}}},clone:function(c,e){var d=this,a,b;if(!j||c.nodeType!==1||e){return c.cloneNode(e)}b=d.doc;if(!e){a=b.createElement(c.nodeName);m(d.getAttribs(c),function(f){d.setAttrib(a,f.nodeName,d.getAttrib(c,f.nodeName))});return a}return a.firstChild},getRoot:function(){var b=this,a=b.settings;return(a&&b.get(a.root_element))||b.doc.body},getViewPort:function(b){var a,c;b=!b?this.win:b;a=b.document;c=this.boxModel?a.documentElement:a.body;return{x:b.pageXOffset||c.scrollLeft,y:b.pageYOffset||c.scrollTop,w:b.innerWidth||c.clientWidth,h:b.innerHeight||c.clientHeight}},getRect:function(a){var b,d=this,c;a=d.get(a);b=d.getPos(a);c=d.getSize(a);return{x:b.x,y:b.y,w:c.w,h:c.h}},getSize:function(a){var c=this,d,b;a=c.get(a);d=c.getStyle(a,"width");b=c.getStyle(a,"height");if(d.indexOf("px")===-1){d=0}if(b.indexOf("px")===-1){b=0}return{w:parseInt(d,10)||a.offsetWidth||a.clientWidth,h:parseInt(b,10)||a.offsetHeight||a.clientHeight}},getParent:function(a,b,c){return this.getParents(a,b,c,false)},getParents:function(f,a,c,g){var d=this,e,b=d.settings,h=[];f=d.get(f);g=g===undefined;if(b.strict_root){c=c||d.getRoot()}if(p(a,"string")){e=a;if(a==="*"){a=function(r){return r.nodeType==1}}else{a=function(r){return d.is(r,e)}}}while(f){if(f==c||!f.nodeType||f.nodeType===9){break}if(!a||a(f)){if(g){h.push(f)}else{return f}}f=f.parentNode}return g?h:null},get:function(b){var a;if(b&&this.doc&&typeof(b)=="string"){a=b;b=this.doc.getElementById(b);if(b&&b.id!==a){return this.doc.getElementsByName(a)[1]}}return b},getNext:function(a,b){return this._findSib(a,b,"nextSibling")},getPrev:function(a,b){return this._findSib(a,b,"previousSibling")},select:function(a,b){var c=this;return o.dom.Sizzle(a,c.get(b)||c.get(c.settings.root_element)||c.doc,[])},is:function(a,c){var b;if(a.length===undefined){if(c==="*"){return a.nodeType==1}if(q.test(c)){c=c.toLowerCase().split(/,/);a=a.nodeName.toLowerCase();for(b=c.length-1;b>=0;b--){if(c[b]==a){return true}}return false}}return o.dom.Sizzle.matches(c,a.nodeType?[a]:a).length>0},add:function(b,f,e,c,a){var d=this;return this.run(b,function(g){var h,s;h=p(f,"string")?d.doc.createElement(f):f;d.setAttribs(h,e);if(c){if(c.nodeType){h.appendChild(c)}else{d.setHTML(h,c)}}return !a?g.appendChild(h):h})},create:function(a,c,b){return this.add(this.doc.createElement(a),a,c,b,1)},createHTML:function(e,d,a){var f="",b=this,c;f+="<"+e;for(c in d){if(d.hasOwnProperty(c)){f+=" "+c+'="'+b.encode(d[c])+'"'}}if(typeof(a)!="undefined"){return f+">"+a+"</"+e+">"}return f+" />"},remove:function(b,a){return this.run(b,function(d){var c,e=d.parentNode;if(!e){return null}if(a){while(c=d.firstChild){if(!o.isIE||c.nodeType!==3||c.nodeValue){e.insertBefore(c,d)}else{d.removeChild(c)}}}return e.removeChild(d)})},setStyle:function(a,d,c){var b=this;return b.run(a,function(f){var g,e;g=f.style;d=d.replace(/-(\D)/g,function(h,r){return r.toUpperCase()});if(b.pixelStyles.test(d)&&(o.is(c,"number")||/^[\-0-9\.]+$/.test(c))){c+="px"}switch(d){case"opacity":if(j){g.filter=c===""?"":"alpha(opacity="+(c*100)+")";if(!a.currentStyle||!a.currentStyle.hasLayout){g.display="inline-block"}}g[d]=g["-moz-opacity"]=g["-khtml-opacity"]=c||"";break;case"float":j?g.styleFloat=c:g.cssFloat=c;break;default:g[d]=c||""}if(b.settings.update_styles){b.setAttrib(f,"data-mce-style")}})},getStyle:function(a,d,b){a=this.get(a);if(!a){return}if(this.doc.defaultView&&b){d=d.replace(/[A-Z]/g,function(e){return"-"+e});try{return this.doc.defaultView.getComputedStyle(a,null).getPropertyValue(d)}catch(c){return null}}d=d.replace(/-(\D)/g,function(f,e){return e.toUpperCase()});if(d=="float"){d=j?"styleFloat":"cssFloat"}if(a.currentStyle&&b){return a.currentStyle[d]}return a.style?a.style[d]:undefined},setStyles:function(b,a){var d=this,c=d.settings,e;e=c.update_styles;c.update_styles=0;m(a,function(g,f){d.setStyle(b,f,g)});c.update_styles=e;if(c.update_styles){d.setAttrib(b,c.cssText)}},removeAllAttribs:function(a){return this.run(a,function(b){var c,d=b.attributes;for(c=d.length-1;c>=0;c--){b.removeAttributeNode(d.item(c))}})},setAttrib:function(b,a,d){var c=this;if(!b||!a){return}if(c.settings.strict){a=a.toLowerCase()}return this.run(b,function(f){var g=c.settings;var e=f.getAttribute(a);if(d!==null){switch(a){case"style":if(!p(d,"string")){m(d,function(u,s){c.setStyle(f,s,u)});return}if(g.keep_values){if(d&&!c._isRes(d)){f.setAttribute("data-mce-style",d,2)}else{f.removeAttribute("data-mce-style",2)}}f.style.cssText=d;break;case"class":f.className=d||"";break;case"src":case"href":if(g.keep_values){if(g.url_converter){d=g.url_converter.call(g.url_converter_scope||c,d,a,f)}c.setAttrib(f,"data-mce-"+a,d,2)}break;case"shape":f.setAttribute("data-mce-style",d);break}}if(p(d)&&d!==null&&d.length!==0){f.setAttribute(a,""+d,2)}else{f.removeAttribute(a,2)}if(tinyMCE.activeEditor&&e!=d){var h=tinyMCE.activeEditor;h.onSetAttrib.dispatch(h,f,a,d)}})},setAttribs:function(b,a){var c=this;return this.run(b,function(d){m(a,function(e,f){c.setAttrib(d,f,e)})})},getAttrib:function(a,f,c){var e,d=this,b;a=d.get(a);if(!a||a.nodeType!==1){return c===b?false:c}if(!p(c)){c=""}if(/^(src|href|style|coords|shape)$/.test(f)){e=a.getAttribute("data-mce-"+f);if(e){return e}}if(j&&d.props[f]){e=a[d.props[f]];e=e&&e.nodeValue?e.nodeValue:e}if(!e){e=a.getAttribute(f,2)}if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(f)){if(a[d.props[f]]===true&&e===""){return f}return e?f:""}if(a.nodeName==="FORM"&&a.getAttributeNode(f)){return a.getAttributeNode(f).nodeValue}if(f==="style"){e=e||a.style.cssText;if(e){e=d.serializeStyle(d.parseStyle(e),a.nodeName);if(d.settings.keep_values&&!d._isRes(e)){a.setAttribute("data-mce-style",e)}}}if(n&&f==="class"&&e){e=e.replace(/(apple|webkit)\-[a-z\-]+/gi,"")}if(j){switch(f){case"rowspan":case"colspan":if(e===1){e=""}break;case"size":if(e==="+0"||e===20||e===0){e=""}break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":if(e===0){e=""}break;case"hspace":if(e===-1){e=""}break;case"maxlength":case"tabindex":if(e===32768||e===2147483647||e==="32768"){e=""}break;case"multiple":case"compact":case"noshade":case"nowrap":if(e===65535){return f}return c;case"shape":e=e.toLowerCase();break;default:if(f.indexOf("on")===0&&e){e=o._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+e)}}}return(e!==b&&e!==null&&e!=="")?""+e:c},getPos:function(f,b){var d=this,e=0,g=0,a,h=d.doc,c;f=d.get(f);b=b||h.body;if(f){if(f.getBoundingClientRect){f=f.getBoundingClientRect();a=d.boxModel?h.documentElement:h.body;e=f.left+(h.documentElement.scrollLeft||h.body.scrollLeft)-a.clientTop;g=f.top+(h.documentElement.scrollTop||h.body.scrollTop)-a.clientLeft;return{x:e,y:g}}c=f;while(c&&c!=b&&c.nodeType){e+=c.offsetLeft||0;g+=c.offsetTop||0;c=c.offsetParent}c=f.parentNode;while(c&&c!=b&&c.nodeType){e-=c.scrollLeft||0;g-=c.scrollTop||0;c=c.parentNode}}return{x:e,y:g}},parseStyle:function(a){return this.styles.parse(a)},serializeStyle:function(a,b){return this.styles.serialize(a,b)},loadCSS:function(d){var b=this,a=b.doc,c;if(!d){d=""}c=a.getElementsByTagName("head")[0];m(d.split(","),function(e){var f;if(b.files[e]){return}b.files[e]=true;f=b.create("link",{rel:"stylesheet",href:o._addVer(e)});if(j&&a.documentMode&&a.recalc){f.onload=function(){if(a.recalc){a.recalc()}f.onload=null}}c.appendChild(f)})},addClass:function(b,a){return this.run(b,function(d){var c;if(!a){return 0}if(this.hasClass(d,a)){return d.className}c=this.removeClass(d,a);return d.className=(c!=""?(c+" "):"")+a})},removeClass:function(b,a){var d=this,c;return d.run(b,function(f){var e;if(d.hasClass(f,a)){if(!c){c=new RegExp("(^|\\s+)"+a+"(\\s+|$)","g")}e=f.className.replace(c," ");e=o.trim(e!=" "?e:"");f.className=e;if(!e){f.removeAttribute("class");f.removeAttribute("className")}return e}return f.className})},hasClass:function(a,b){a=this.get(a);if(!a||!b){return false}return(" "+a.className+" ").indexOf(" "+b+" ")!==-1},show:function(a){return this.setStyle(a,"display","block")},hide:function(a){return this.setStyle(a,"display","none")},isHidden:function(a){a=this.get(a);return !a||a.style.display=="none"||this.getStyle(a,"display")=="none"},uniqueId:function(a){return(!a?"mce_":a)+(this.counter++)},setHTML:function(a,b){var c=this;return c.run(a,function(d){if(j){while(d.firstChild){d.removeChild(d.firstChild)}try{d.innerHTML="<br />"+b;d.removeChild(d.firstChild)}catch(e){d=c.create("div");d.innerHTML="<br />"+b;m(d.childNodes,function(f,g){if(g){d.appendChild(f)}})}}else{d.innerHTML=b}return b})},getOuterHTML:function(a){var b,c=this;a=c.get(a);if(!a){return null}if(a.nodeType===1&&c.hasOuterHTML){return a.outerHTML}b=(a.ownerDocument||c.doc).createElement("body");b.appendChild(a.cloneNode(true));return b.innerHTML},setOuterHTML:function(b,d,a){var e=this;function c(u,v,g){var f,h;h=g.createElement("body");h.innerHTML=v;f=h.lastChild;while(f){e.insertAfter(f.cloneNode(true),u);f=f.previousSibling}e.remove(u)}return this.run(b,function(f){f=e.get(f);if(f.nodeType==1){a=a||f.ownerDocument||e.doc;if(j){try{if(j&&f.nodeType==1){f.outerHTML=d}else{c(f,d,a)}}catch(g){c(f,d,a)}}else{c(f,d,a)}}})},decode:l.decode,encode:l.encodeAllRaw,insertAfter:function(b,a){a=this.get(a);return this.run(b,function(d){var e,c;e=a.parentNode;c=a.nextSibling;if(c){e.insertBefore(d,c)}else{e.appendChild(d)}return d})},replace:function(a,b,d){var c=this;if(p(b,"array")){a=a.cloneNode(true)}return c.run(b,function(e){if(d){m(o.grep(e.childNodes),function(f){a.appendChild(f)})}return e.parentNode.replaceChild(a,e)})},rename:function(a,d){var b=this,c;if(a.nodeName!=d.toUpperCase()){c=b.create(d);m(b.getAttribs(a),function(e){b.setAttrib(c,e.nodeName,b.getAttrib(a,e.nodeName))});b.replace(c,a,1)}return c||a},findCommonAncestor:function(b,d){var a=b,c;while(a){c=d;while(c&&a!=c){c=c.parentNode}if(a==c){break}a=a.parentNode}if(!a&&b.ownerDocument){return b.ownerDocument.documentElement}return a},toHex:function(c){var a=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(c);function b(d){d=parseInt(d,10).toString(16);return d.length>1?d:"0"+d}if(a){c="#"+b(a[1])+b(a[2])+b(a[3]);return c}return c},getClasses:function(){var h=this,d=[],a,g={},f=h.settings.class_filter,b;if(h.classes){return h.classes}function e(r){m(r.imports,function(u){e(u)});m(r.cssRules||r.rules,function(u){switch(u.type||1){case 1:if(u.selectorText){m(u.selectorText.split(","),function(s){s=s.replace(/^\s*|\s*$|^\s\./g,"");if(/\.mce/.test(s)||!/\.[\w\-]+$/.test(s)){return}b=s;s=o._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",s);if(f&&!(s=f(s,b))){return}if(!g[s]){d.push({"class":s});g[s]=1}})}break;case 3:e(u.styleSheet);break}})}try{m(h.doc.styleSheets,e)}catch(c){}if(d.length>0){h.classes=d}return d},run:function(b,c,d){var e=this,a;if(e.doc&&typeof(b)==="string"){b=e.get(b)}if(!b){return false}d=d||this;if(!b.nodeType&&(b.length||b.length===0)){a=[];m(b,function(f,g){if(f){if(typeof(f)=="string"){f=e.doc.getElementById(f)}a.push(c.call(d,f,g))}});return a}return c.call(d,b)},getAttribs:function(a){var b;a=this.get(a);if(!a){return[]}if(j){b=[];if(a.nodeName=="OBJECT"){return a.attributes}if(a.nodeName==="OPTION"&&this.getAttrib(a,"selected")){b.push({specified:1,nodeName:"selected"})}a.cloneNode(false).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(c){b.push({specified:1,nodeName:c})});return b}return a.attributes},isEmpty:function(f,h){var a=this,d,e,b,s,g,c=0;f=f.firstChild;if(f){s=new o.dom.TreeWalker(f,f.parentNode);h=h||a.schema?a.schema.getNonEmptyElements():null;do{b=f.nodeType;if(b===1){if(f.getAttribute("data-mce-bogus")){continue}g=f.nodeName.toLowerCase();if(h&&h[g]){if(g==="br"){c++;continue}return false}e=a.getAttribs(f);d=f.attributes.length;while(d--){g=f.attributes[d].nodeName;if(g==="name"||g==="data-mce-bookmark"){return false}}}if(b==8){return false}if((b===3&&!k.test(f.nodeValue))){return false}}while(f=s.next())}return c<=1},destroy:function(a){var b=this;b.win=b.doc=b.root=b.events=b.frag=null;if(!a){o.removeUnload(b.destroy)}},createRng:function(){var a=this.doc;return a.createRange?a.createRange():new o.dom.Range(this)},nodeIndex:function(a,f){var e=0,c,b,d;if(a){for(c=a.nodeType,a=a.previousSibling,b=a;a;a=a.previousSibling){d=a.nodeType;if(f&&d==3){if(d==c||!a.nodeValue.length){continue}}e++;c=d}}return e},split:function(e,f,b){var a=this,r=a.createRng(),d,g,c;function h(z){var B,C=z.childNodes,A=z.nodeType;function E(v){var s=v.previousSibling&&v.previousSibling.nodeName=="SPAN";var u=v.nextSibling&&v.nextSibling.nodeName=="SPAN";return s&&u}if(A==1&&z.getAttribute("data-mce-type")=="bookmark"){return}for(B=C.length-1;B>=0;B--){h(C[B])}if(A!=9){if(A==3&&z.nodeValue.length>0){var D=o.trim(z.nodeValue).length;if(!a.isBlock(z.parentNode)||D>0||D===0&&E(z)){return}}else{if(A==1){C=z.childNodes;if(C.length==1&&C[0]&&C[0].nodeType==1&&C[0].getAttribute("data-mce-type")=="bookmark"){z.parentNode.insertBefore(C[0],z)}if(C.length||/^(br|hr|input|img)$/i.test(z.nodeName)){return}}}a.remove(z)}return z}if(e&&f){r.setStart(e.parentNode,a.nodeIndex(e));r.setEnd(f.parentNode,a.nodeIndex(f));d=r.extractContents();r=a.createRng();r.setStart(f.parentNode,a.nodeIndex(f)+1);r.setEnd(e.parentNode,a.nodeIndex(e)+1);g=r.extractContents();c=e.parentNode;c.insertBefore(h(d),e);if(b){c.replaceChild(b,f)}else{c.insertBefore(f,e)}c.insertBefore(h(g),e);a.remove(e);return b||f}},bind:function(a,d,b,c){return this.events.add(a,d,b,c||this)},unbind:function(a,c,b){return this.events.remove(a,c,b)},fire:function(a,b,c){return this.events.fire(a,b,c)},getContentEditable:function(a){var b;if(a.nodeType!=1){return null}b=a.getAttribute("data-mce-contenteditable");if(b&&b!=="inherit"){return b}return a.contentEditable!=="inherit"?a.contentEditable:null},_findSib:function(b,e,d){var c=this,a=e;if(b){if(p(a,"string")){a=function(f){return c.is(f,e)}}for(b=b[d];b;b=b[d]){if(a(b)){return b}}}return null},_isRes:function(a){return/^(top|left|bottom|right|width|height)/i.test(a)||/;\s*(top|left|bottom|right|width|height)/i.test(a)}});o.DOM=new o.dom.DOMUtils(document,{process_html:0})})(tinymce);(function(d){function c(aM){var ab=this,aK=aM.doc,W=0,ak=1,aF=2,al=true,X=false,a="startOffset",aH="startContainer",Z="endContainer",ap="endOffset",aE=tinymce.extend,aB=aM.nodeIndex;aE(ab,{startContainer:aK,startOffset:0,endContainer:aK,endOffset:0,collapsed:al,commonAncestorContainer:aK,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:ay,setEnd:aw,setStartBefore:aI,setStartAfter:ag,setEndBefore:af,setEndAfter:av,collapse:ao,selectNode:ar,selectNodeContents:aj,compareBoundaryPoints:au,deleteContents:az,extractContents:ah,cloneContents:aL,insertNode:am,surroundContents:ac,cloneRange:ae});function at(){return aK.createDocumentFragment()}function ay(f,e){an(al,f,e)}function aw(f,e){an(X,f,e)}function aI(e){ay(e.parentNode,aB(e))}function ag(e){ay(e.parentNode,aB(e)+1)}function af(e){aw(e.parentNode,aB(e))}function av(e){aw(e.parentNode,aB(e)+1)}function ao(e){if(e){ab[Z]=ab[aH];ab[ap]=ab[a]}else{ab[aH]=ab[Z];ab[a]=ab[ap]}ab.collapsed=al}function ar(e){aI(e);av(e)}function aj(e){ay(e,0);aw(e,e.nodeType===1?e.childNodes.length:e.nodeValue.length)}function au(e,j){var m=ab[aH],g=ab[a],n=ab[Z],h=ab[ap],o=j.startContainer,k=j.startOffset,f=j.endContainer,l=j.endOffset;if(e===0){return ai(m,g,o,k)}if(e===1){return ai(n,h,o,k)}if(e===2){return ai(n,h,f,l)}if(e===3){return ai(m,g,f,l)}}function az(){aD(aF)}function ah(){return aD(W)}function aL(){return aD(ak)}function am(g){var j=this[aH],e=this[a],f,h;if((j.nodeType===3||j.nodeType===4)&&j.nodeValue){if(!e){j.parentNode.insertBefore(g,j)}else{if(e>=j.nodeValue.length){aM.insertAfter(g,j)}else{f=j.splitText(e);j.parentNode.insertBefore(g,f)}}}else{if(j.childNodes.length>0){h=j.childNodes[e]}if(h){j.insertBefore(g,h)}else{j.appendChild(g)}}}function ac(f){var e=ab.extractContents();ab.insertNode(f);f.appendChild(e);ab.selectNode(f)}function ae(){return aE(new c(aM),{startContainer:ab[aH],startOffset:ab[a],endContainer:ab[Z],endOffset:ab[ap],collapsed:ab.collapsed,commonAncestorContainer:ab.commonAncestorContainer})}function aa(e,g){var f;if(e.nodeType==3){return e}if(g<0){return e}f=e.firstChild;while(f&&g>0){--g;f=f.nextSibling}if(f){return f}return e}function aC(){return(ab[aH]==ab[Z]&&ab[a]==ab[ap])}function ai(f,o,h,e){var n,g,j,m,k,l;if(f==h){if(o==e){return 0}if(o<e){return -1}return 1}n=h;while(n&&n.parentNode!=f){n=n.parentNode}if(n){g=0;j=f.firstChild;while(j!=n&&g<o){g++;j=j.nextSibling}if(o<=g){return -1}return 1}n=f;while(n&&n.parentNode!=h){n=n.parentNode}if(n){g=0;j=h.firstChild;while(j!=n&&g<e){g++;j=j.nextSibling}if(g<e){return -1}return 1}m=aM.findCommonAncestor(f,h);k=f;while(k&&k.parentNode!=m){k=k.parentNode}if(!k){k=m}l=h;while(l&&l.parentNode!=m){l=l.parentNode}if(!l){l=m}if(k==l){return 0}j=m.firstChild;while(j){if(j==k){return -1}if(j==l){return 1}j=j.nextSibling}}function an(j,g,f){var e,h;if(j){ab[aH]=g;ab[a]=f}else{ab[Z]=g;ab[ap]=f}e=ab[Z];while(e.parentNode){e=e.parentNode}h=ab[aH];while(h.parentNode){h=h.parentNode}if(h==e){if(ai(ab[aH],ab[a],ab[Z],ab[ap])>0){ab.collapse(j)}}else{ab.collapse(j)}ab.collapsed=aC();ab.commonAncestorContainer=aM.findCommonAncestor(ab[aH],ab[Z])}function aD(m){var n,f=0,k=0,h,o,g,e,j,l;if(ab[aH]==ab[Z]){return aJ(m)}for(n=ab[Z],h=n.parentNode;h;n=h,h=h.parentNode){if(h==ab[aH]){return ax(n,m)}++f}for(n=ab[aH],h=n.parentNode;h;n=h,h=h.parentNode){if(h==ab[Z]){return b(n,m)}++k}o=k-f;g=ab[aH];while(o>0){g=g.parentNode;o--}e=ab[Z];while(o<0){e=e.parentNode;o++}for(j=g.parentNode,l=e.parentNode;j!=l;j=j.parentNode,l=l.parentNode){g=j;e=l}return aA(g,e,m)}function aJ(n){var l,k,j,g,f,m,e,h,o;if(n!=aF){l=at()}if(ab[a]==ab[ap]){return l}if(ab[aH].nodeType==3){k=ab[aH].nodeValue;j=k.substring(ab[a],ab[ap]);if(n!=ak){g=ab[aH];h=ab[a];o=ab[ap]-ab[a];if(h===0&&o>=g.nodeValue.length-1){g.parentNode.removeChild(g)}else{g.deleteData(h,o)}ab.collapse(al)}if(n==aF){return}if(j.length>0){l.appendChild(aK.createTextNode(j))}return l}g=aa(ab[aH],ab[a]);f=ab[ap]-ab[a];while(g&&f>0){m=g.nextSibling;e=aq(g,n);if(l){l.appendChild(e)}--f;g=m}if(n!=ak){ab.collapse(al)}return l}function ax(f,k){var g,h,m,e,j,l;if(k!=aF){g=at()}h=aG(f,k);if(g){g.appendChild(h)}m=aB(f);e=m-ab[a];if(e<=0){if(k!=ak){ab.setEndBefore(f);ab.collapse(X)}return g}h=f.previousSibling;while(e>0){j=h.previousSibling;l=aq(h,k);if(g){g.insertBefore(l,g.firstChild)}--e;h=j}if(k!=ak){ab.setEndBefore(f);ab.collapse(X)}return g}function b(h,k){var f,m,g,e,j,l;if(k!=aF){f=at()}g=Y(h,k);if(f){f.appendChild(g)}m=aB(h);++m;e=ab[ap]-m;g=h.nextSibling;while(g&&e>0){j=g.nextSibling;l=aq(g,k);if(f){f.appendChild(l)}--e;g=j}if(k!=ak){ab.setStartAfter(h);ab.collapse(al)}return f}function aA(p,j,m){var g,k,e,o,n,h,l,f;if(m!=aF){k=at()}g=Y(p,m);if(k){k.appendChild(g)}e=p.parentNode;o=aB(p);n=aB(j);++o;h=n-o;l=p.nextSibling;while(h>0){f=l.nextSibling;g=aq(l,m);if(k){k.appendChild(g)}l=f;--h}g=aG(j,m);if(k){k.appendChild(g)}if(m!=ak){ab.setStartAfter(p);ab.collapse(al)}return k}function aG(m,l){var g=aa(ab[Z],ab[ap]-1),k,n,e,j,h,f=g!=ab[Z];if(g==m){return ad(g,f,X,l)}k=g.parentNode;n=ad(k,X,X,l);while(k){while(g){e=g.previousSibling;j=ad(g,f,X,l);if(l!=aF){n.insertBefore(j,n.firstChild)}f=al;g=e}if(k==m){return n}g=k.previousSibling;k=k.parentNode;h=ad(k,X,X,l);if(l!=aF){h.appendChild(n)}n=h}}function Y(m,l){var f=aa(ab[aH],ab[a]),e=f!=ab[aH],k,n,g,j,h;if(f==m){return ad(f,e,al,l)}k=f.parentNode;n=ad(k,X,al,l);while(k){while(f){g=f.nextSibling;j=ad(f,e,al,l);if(l!=aF){n.appendChild(j)}e=al;f=g}if(k==m){return n}f=k.nextSibling;k=k.parentNode;h=ad(k,X,al,l);if(l!=aF){h.appendChild(n)}n=h}}function ad(j,e,l,k){var f,g,n,h,m;if(e){return aq(j,k)}if(j.nodeType==3){f=j.nodeValue;if(l){h=ab[a];g=f.substring(h);n=f.substring(0,h)}else{h=ab[ap];g=f.substring(0,h);n=f.substring(h)}if(k!=ak){j.nodeValue=n}if(k==aF){return}m=aM.clone(j,X);m.nodeValue=g;return m}if(k==aF){return}return aM.clone(j,X)}function aq(f,e){if(e!=aF){return e==ak?aM.clone(f,al):f}f.parentNode.removeChild(f)}}d.Range=c})(tinymce.dom);(function(){function b(n){var a=this,j=n.dom,o=true,l=false;function m(z,y){var x,A=0,d,g,h,v,f,c,e=-1,B;x=z.duplicate();x.collapse(y);B=x.parentElement();if(B.ownerDocument!==n.dom.doc){return}while(B.contentEditable==="false"){B=B.parentNode}if(!B.hasChildNodes()){return{node:B,inside:1}}h=B.children;d=h.length-1;while(A<=d){c=Math.floor((A+d)/2);v=h[c];x.moveToElementText(v);e=x.compareEndPoints(y?"StartToStart":"EndToEnd",z);if(e>0){d=c-1}else{if(e<0){A=c+1}else{return{node:v}}}}if(e<0){if(!v){x.moveToElementText(B);x.collapse(true);v=B;g=true}else{x.collapse(false)}f=0;while(x.compareEndPoints(y?"StartToStart":"StartToEnd",z)!==0){if(x.move("character",1)===0||B!=x.parentElement()){break}f++}}else{x.collapse(true);f=0;while(x.compareEndPoints(y?"StartToStart":"StartToEnd",z)!==0){if(x.move("character",-1)===0||B!=x.parentElement()){break}f++}}return{node:v,position:e,offset:f,inside:g}}function k(){var x=n.getRng(),c=j.createRng(),s,u,e,d,h,v;s=x.item?x.item(0):x.parentElement();if(s.ownerDocument!=j.doc){return c}u=n.isCollapsed();if(x.item){c.setStart(s.parentNode,j.nodeIndex(s));c.setEnd(c.startContainer,c.startOffset+1);return c}function f(G){var r=m(x,G),D,E,q=0,F,p,C;D=r.node;E=r.offset;if(r.inside&&!D.hasChildNodes()){c[G?"setStart":"setEnd"](D,0);return}if(E===p){c[G?"setStartBefore":"setEndAfter"](D);return}if(r.position<0){F=r.inside?D.firstChild:D.nextSibling;if(!F){c[G?"setStartAfter":"setEndAfter"](D);return}if(!E){if(F.nodeType==3){c[G?"setStart":"setEnd"](F,0)}else{c[G?"setStartBefore":"setEndBefore"](F)}return}while(F){C=F.nodeValue;q+=C.length;if(q>=E){D=F;q-=E;q=C.length-q;break}F=F.nextSibling}}else{F=D.previousSibling;if(!F){return c[G?"setStartBefore":"setEndBefore"](D)}if(!E){if(D.nodeType==3){c[G?"setStart":"setEnd"](F,D.nodeValue.length)}else{c[G?"setStartAfter":"setEndAfter"](F)}return}while(F){q+=F.nodeValue.length;if(q>=E){D=F;q-=E;break}F=F.previousSibling}}c[G?"setStart":"setEnd"](D,q)}try{f(true);if(!u){f()}}catch(g){if(g.number==-2147024809){h=a.getBookmark(2);e=x.duplicate();e.collapse(true);s=e.parentElement();if(!u){e=x.duplicate();e.collapse(false);d=e.parentElement();d.innerHTML=d.innerHTML}s.innerHTML=s.innerHTML;a.moveToBookmark(h);x=n.getRng();f(true);if(!u){f()}}else{throw g}}return c}this.getBookmark=function(c){var f=n.getRng(),h,g,d={};function p(x){var y,C,z,A,B=[];y=x.parentNode;C=j.getRoot().parentNode;while(y!=C&&y.nodeType!==9){z=y.children;A=z.length;while(A--){if(x===z[A]){B.push(A);break}}x=y;y=y.parentNode}return B}function e(r){var s;s=m(f,r);if(s){return{position:s.position,offset:s.offset,indexes:p(s.node),inside:s.inside}}}if(c===2){if(!f.item){d.start=e(true);if(!n.isCollapsed()){d.end=e()}}else{d.start={ctrl:true,indexes:p(f.item(0))}}}return d};this.moveToBookmark=function(e){var f,g=j.doc.body;function c(v){var h,s,x,u;h=j.getRoot();for(s=v.length-1;s>=0;s--){u=h.children;x=v[s];if(x<=u.length-1){h=u[x]}}return h}function d(h){var x=e[h?"start":"end"],s,u,v;if(x){s=x.position>0;u=g.createTextRange();u.moveToElementText(c(x.indexes));offset=x.offset;if(offset!==v){u.collapse(x.inside||s);u.moveStart("character",s?-offset:offset)}else{u.collapse(h)}f.setEndPoint(h?"StartToStart":"EndToStart",u);if(h){f.collapse(true)}}}if(e.start){if(e.start.ctrl){f=g.createControlRange();f.addElement(c(e.start.indexes));f.select()}else{f=g.createTextRange();d(true);d();f.select()}}};this.addRange=function(y){var g,u,v,e,z,d,c=n.dom.doc,h=c.body;function x(q){var r,B,s,C,p;s=j.create("a");r=q?v:z;B=q?e:d;C=g.duplicate();if(r==c||r==c.documentElement){r=h;B=0}if(r.nodeType==3){r.parentNode.insertBefore(s,r);C.moveToElementText(s);C.moveStart("character",B);j.remove(s);g.setEndPoint(q?"StartToStart":"EndToEnd",C)}else{p=r.childNodes;if(p.length){if(B>=p.length){j.insertAfter(s,p[p.length-1])}else{r.insertBefore(s,p[B])}C.moveToElementText(s)}else{if(r.canHaveHTML){r.innerHTML="<span>\uFEFF</span>";s=r.firstChild;C.moveToElementText(s);C.collapse(l)}}g.setEndPoint(q?"StartToStart":"EndToEnd",C);j.remove(s)}}v=y.startContainer;e=y.startOffset;z=y.endContainer;d=y.endOffset;g=h.createTextRange();if(v==z&&v.nodeType==1){if(e==d&&!v.hasChildNodes()){if(v.canHaveHTML){v.innerHTML="<span>\uFEFF</span><span>\uFEFF</span>";g.moveToElementText(v.lastChild);g.select();j.doc.selection.clear();v.innerHTML="";return}else{e=j.nodeIndex(v);v=v.parentNode}}if(e==d-1){try{u=h.createControlRange();u.addElement(v.childNodes[e]);u.select();return}catch(f){}}}x(true);x();g.select()};this.getRangeAt=k}tinymce.dom.TridentSelection=b})();(function(){var H=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,M="sizcache",G=0,D=Object.prototype.toString,N=false,O=true,E=/\\/g,A=/\r\n/g,e=/\W/;[0,0].sort(function(){O=false;return 0});var Q=function(a,h,q,p){q=q||[];h=h||document;var n=h;if(h.nodeType!==1&&h.nodeType!==9){return[]}if(!a||typeof a!=="string"){return q}var d,l,f,k,m,g,j,r,b=true,c=Q.isXML(h),s=[],o=a;do{H.exec("");d=H.exec(o);if(d){o=d[3];s.push(d[1]);if(d[2]){k=d[3];break}}}while(d);if(s.length>1&&L.exec(a)){if(s.length===2&&K.relative[s[0]]){l=C(s[0]+s[1],h,p)}else{l=K.relative[s[0]]?[h]:Q(s.shift(),h);while(s.length){a=s.shift();if(K.relative[a]){a+=s.shift()}l=C(a,l,p)}}}else{if(!p&&s.length>1&&h.nodeType===9&&!c&&K.match.ID.test(s[0])&&!K.match.ID.test(s[s.length-1])){m=Q.find(s.shift(),h,c);h=m.expr?Q.filter(m.expr,m.set)[0]:m.set[0]}if(h){m=p?{expr:s.pop(),set:J(p)}:Q.find(s.pop(),s.length===1&&(s[0]==="~"||s[0]==="+")&&h.parentNode?h.parentNode:h,c);l=m.expr?Q.filter(m.expr,m.set):m.set;if(s.length>0){f=J(l)}else{b=false}while(s.length){g=s.pop();j=g;if(!K.relative[g]){g=""}else{j=s.pop()}if(j==null){j=h}K.relative[g](f,j,c)}}else{f=s=[]}}if(!f){f=l}if(!f){Q.error(g||a)}if(D.call(f)==="[object Array]"){if(!b){q.push.apply(q,f)}else{if(h&&h.nodeType===1){for(r=0;f[r]!=null;r++){if(f[r]&&(f[r]===true||f[r].nodeType===1&&Q.contains(h,f[r]))){q.push(l[r])}}}else{for(r=0;f[r]!=null;r++){if(f[r]&&f[r].nodeType===1){q.push(l[r])}}}}}else{J(f,q)}if(k){Q(k,n,q,p);Q.uniqueSort(q)}return q};Q.uniqueSort=function(b){if(F){N=O;b.sort(F);if(N){for(var a=1;a<b.length;a++){if(b[a]===b[a-1]){b.splice(a--,1)}}}}return b};Q.matches=function(a,b){return Q(a,null,null,b)};Q.matchesSelector=function(a,b){return Q(b,null,null,[a]).length>0};Q.find=function(j,f,h){var k,d,b,c,a,g;if(!j){return[]}for(d=0,b=K.order.length;d<b;d++){a=K.order[d];if((c=K.leftMatch[a].exec(j))){g=c[1];c.splice(1,1);if(g.substr(g.length-1)!=="\\"){c[1]=(c[1]||"").replace(E,"");k=K.find[a](c,f,h);if(k!=null){j=j.replace(K.match[a],"");break}}}}if(!k){k=typeof f.getElementsByTagName!=="undefined"?f.getElementsByTagName("*"):[]}return{set:k,expr:j}};Q.filter=function(n,o,j,b){var s,h,p,f,l,k,c,a,m,d=n,g=[],q=o,r=o&&o[0]&&Q.isXML(o[0]);while(n&&o.length){for(p in K.filter){if((s=K.leftMatch[p].exec(n))!=null&&s[2]){k=K.filter[p];c=s[1];h=false;s.splice(1,1);if(c.substr(c.length-1)==="\\"){continue}if(q===g){g=[]}if(K.preFilter[p]){s=K.preFilter[p](s,q,j,g,b,r);if(!s){h=f=true}else{if(s===true){continue}}}if(s){for(a=0;(l=q[a])!=null;a++){if(l){f=k(l,s,a,q);m=b^f;if(j&&f!=null){if(m){h=true}else{q[a]=false}}else{if(m){g.push(l);h=true}}}}}if(f!==undefined){if(!j){q=g}n=n.replace(K.match[p],"");if(!h){return[]}break}}}if(n===d){if(h==null){Q.error(n)}else{break}}d=n}return q};Q.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var S=Q.getText=function(d){var a,f,b=d.nodeType,c="";if(b){if(b===1||b===9||b===11){if(typeof d.textContent==="string"){return d.textContent}else{if(typeof d.innerText==="string"){return d.innerText.replace(A,"")}else{for(d=d.firstChild;d;d=d.nextSibling){c+=S(d)}}}}else{if(b===3||b===4){return d.nodeValue}}}else{for(a=0;(f=d[a]);a++){if(f.nodeType!==8){c+=S(f)}}}return c};var K=Q.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(c,h){var j=typeof h==="string",f=j&&!e.test(h),b=j&&!f;if(f){h=h.toLowerCase()}for(var a=0,d=c.length,g;a<d;a++){if((g=c[a])){while((g=g.previousSibling)&&g.nodeType!==1){}c[a]=b||g&&g.nodeName.toLowerCase()===h?g||false:g===h}}if(b){Q.filter(h,c,true)}},">":function(b,g){var d,f=typeof g==="string",a=0,c=b.length;if(f&&!e.test(g)){g=g.toLowerCase();for(;a<c;a++){d=b[a];if(d){var h=d.parentNode;b[a]=h.nodeName.toLowerCase()===g?h:false}}}else{for(;a<c;a++){d=b[a];if(d){b[a]=f?d.parentNode:d.parentNode===g}}if(f){Q.filter(g,b,true)}}},"":function(g,f,c){var d,a=G++,b=B;if(typeof f==="string"&&!e.test(f)){f=f.toLowerCase();d=f;b=T}b("parentNode",f,a,g,d,c)},"~":function(g,f,c){var d,a=G++,b=B;if(typeof f==="string"&&!e.test(f)){f=f.toLowerCase();d=f;b=T}b("previousSibling",f,a,g,d,c)}},find:{ID:function(c,a,d){if(typeof a.getElementById!=="undefined"&&!d){var b=a.getElementById(c[1]);return b&&b.parentNode?[b]:[]}},NAME:function(a,c){if(typeof c.getElementsByName!=="undefined"){var f=[],d=c.getElementsByName(a[1]);for(var g=0,b=d.length;g<b;g++){if(d[g].getAttribute("name")===a[1]){f.push(d[g])}}return f.length===0?null:f}},TAG:function(a,b){if(typeof b.getElementsByTagName!=="undefined"){return b.getElementsByTagName(a[1])}}},preFilter:{CLASS:function(j,h,a,f,c,b){j=" "+j[1].replace(E,"")+" ";if(b){return j}for(var g=0,d;(d=h[g])!=null;g++){if(d){if(c^(d.className&&(" "+d.className+" ").replace(/[\t\n\r]/g," ").indexOf(j)>=0)){if(!a){f.push(d)}}else{if(a){h[g]=false}}}}return false},ID:function(a){return a[1].replace(E,"")},TAG:function(b,a){return b[1].replace(E,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){if(!a[2]){Q.error(a[0])}a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=(b[1]+(b[2]||1))-0;a[3]=b[3]-0}else{if(a[2]){Q.error(a[0])}}a[0]=G++;return a},ATTR:function(g,f,a,d,c,b){var h=g[1]=g[1].replace(E,"");if(!b&&K.attrMap[h]){g[1]=K.attrMap[h]}g[4]=(g[4]||g[5]||"").replace(E,"");if(g[2]==="~="){g[4]=" "+g[4]+" "}return g},PSEUDO:function(f,d,a,c,b){if(f[1]==="not"){if((H.exec(f[3])||"").length>1||/^\w/.test(f[3])){f[3]=Q(f[3],null,null,d)}else{var g=Q.filter(f[3],d,a,true^b);if(!a){c.push.apply(c,g)}return false}}else{if(K.match.POS.test(f[0])||K.match.CHILD.test(f[0])){return true}}return f},POS:function(a){a.unshift(true);return a}},filters:{enabled:function(a){return a.disabled===false&&a.type!=="hidden"},disabled:function(a){return a.disabled===true},checked:function(a){return a.checked===true},selected:function(a){if(a.parentNode){a.parentNode.selectedIndex}return a.selected===true},parent:function(a){return !!a.firstChild},empty:function(a){return !a.firstChild},has:function(a,c,b){return !!Q(b[3],a).length},header:function(a){return(/h\d/i).test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(b){var a=b.nodeName.toLowerCase();return(a==="input"||a==="button")&&"submit"===b.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(b){var a=b.nodeName.toLowerCase();return(a==="input"||a==="button")&&"reset"===b.type},button:function(b){var a=b.nodeName.toLowerCase();return a==="input"&&"button"===b.type||a==="button"},input:function(a){return(/input|select|textarea|button/i).test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(b,a){return a===0},last:function(a,c,b,d){return c===d.length-1},even:function(b,a){return a%2===0},odd:function(b,a){return a%2===1},lt:function(a,c,b){return c<b[3]-0},gt:function(a,c,b){return c>b[3]-0},nth:function(a,c,b){return b[3]-0===c},eq:function(a,c,b){return b[3]-0===c}},filter:{PSEUDO:function(d,j,k,h){var f=j[1],g=K.filters[f];if(g){return g(d,k,j,h)}else{if(f==="contains"){return(d.textContent||d.innerText||S([d])||"").indexOf(j[3])>=0}else{if(f==="not"){var c=j[3];for(var a=0,b=c.length;a<b;a++){if(c[a]===d){return false}}return true}else{Q.error(f)}}}},CHILD:function(d,b){var c,h,m,j,f,a,k,l=b[1],g=d;switch(l){case"only":case"first":while((g=g.previousSibling)){if(g.nodeType===1){return false}}if(l==="first"){return true}g=d;case"last":while((g=g.nextSibling)){if(g.nodeType===1){return false}}return true;case"nth":c=b[2];h=b[3];if(c===1&&h===0){return true}m=b[0];j=d.parentNode;if(j&&(j[M]!==m||!d.nodeIndex)){a=0;for(g=j.firstChild;g;g=g.nextSibling){if(g.nodeType===1){g.nodeIndex=++a}}j[M]=m}k=d.nodeIndex-h;if(c===0){return k===0}else{return(k%c===0&&k/c>=0)}}},ID:function(b,a){return b.nodeType===1&&b.getAttribute("id")===a},TAG:function(b,a){return(a==="*"&&b.nodeType===1)||!!b.nodeName&&b.nodeName.toLowerCase()===a},CLASS:function(b,a){return(" "+(b.className||b.getAttribute("class"))+" ").indexOf(a)>-1},ATTR:function(d,h){var a=h[1],c=Q.attr?Q.attr(d,a):K.attrHandle[a]?K.attrHandle[a](d):d[a]!=null?d[a]:d.getAttribute(a),b=c+"",g=h[2],f=h[4];return c==null?g==="!=":!g&&Q.attr?c!=null:g==="="?b===f:g==="*="?b.indexOf(f)>=0:g==="~="?(" "+b+" ").indexOf(f)>=0:!f?b&&c!==false:g==="!="?b!==f:g==="^="?b.indexOf(f)===0:g==="$="?b.substr(b.length-f.length)===f:g==="|="?b===f||b.substr(0,f.length+1)===f+"-":false},POS:function(f,d,a,c){var b=d[2],g=K.setFilters[b];if(g){return g(f,a,d,c)}}}};var L=K.match.POS,R=function(b,a){return"\\"+(a-0+1)};for(var P in K.match){K.match[P]=new RegExp(K.match[P].source+(/(?![^\[]*\])(?![^\(]*\))/.source));K.leftMatch[P]=new RegExp(/(^(?:.|\r|\n)*?)/.source+K.match[P].source.replace(/\\(\d+)/g,R))}K.match.globalPOS=L;var J=function(b,a){b=Array.prototype.slice.call(b,0);if(a){a.push.apply(a,b);return a}return b};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(z){J=function(d,f){var a=0,c=f||[];if(D.call(d)==="[object Array]"){Array.prototype.push.apply(c,d)}else{if(typeof d.length==="number"){for(var b=d.length;a<b;a++){c.push(d[a])}}else{for(;d[a];a++){c.push(d[a])}}}return c}}var F,I;if(document.documentElement.compareDocumentPosition){F=function(b,a){if(b===a){N=true;return 0}if(!b.compareDocumentPosition||!a.compareDocumentPosition){return b.compareDocumentPosition?-1:1}return b.compareDocumentPosition(a)&4?-1:1}}else{F=function(j,k){if(j===k){N=true;return 0}else{if(j.sourceIndex&&k.sourceIndex){return j.sourceIndex-k.sourceIndex}}var a,g,d=[],f=[],b=j.parentNode,l=k.parentNode,h=b;if(b===l){return I(j,k)}else{if(!b){return -1}else{if(!l){return 1}}}while(h){d.unshift(h);h=h.parentNode}h=l;while(h){f.unshift(h);h=h.parentNode}a=d.length;g=f.length;for(var c=0;c<a&&c<g;c++){if(d[c]!==f[c]){return I(d[c],f[c])}}return c===a?I(j,f[c],-1):I(d[c],k,1)};I=function(c,b,a){if(c===b){return a}var d=c.nextSibling;while(d){if(d===b){return -1}d=d.nextSibling}return 1}}(function(){var c=document.createElement("div"),a="script"+(new Date()).getTime(),b=document.documentElement;c.innerHTML="<a name='"+a+"'/>";b.insertBefore(c,b.firstChild);if(document.getElementById(a)){K.find.ID=function(g,f,d){if(typeof f.getElementById!=="undefined"&&!d){var h=f.getElementById(g[1]);return h?h.id===g[1]||typeof h.getAttributeNode!=="undefined"&&h.getAttributeNode("id").nodeValue===g[1]?[h]:undefined:[]}};K.filter.ID=function(d,g){var f=typeof d.getAttributeNode!=="undefined"&&d.getAttributeNode("id");return d.nodeType===1&&f&&f.nodeValue===g}}b.removeChild(c);b=c=null})();(function(){var a=document.createElement("div");a.appendChild(document.createComment(""));if(a.getElementsByTagName("*").length>0){K.find.TAG=function(f,c){var d=c.getElementsByTagName(f[1]);if(f[1]==="*"){var g=[];for(var b=0;d[b];b++){if(d[b].nodeType===1){g.push(d[b])}}d=g}return d}}a.innerHTML="<a href='#'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!=="undefined"&&a.firstChild.getAttribute("href")!=="#"){K.attrHandle.href=function(b){return b.getAttribute("href",2)}}a=null})();if(document.querySelectorAll){(function(){var b=Q,d=document.createElement("div"),a="__sizzle__";d.innerHTML="<p class='TEST'></p>";if(d.querySelectorAll&&d.querySelectorAll(".TEST").length===0){return}Q=function(k,f,p,l){f=f||document;if(!l&&!Q.isXML(f)){var m=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(k);if(m&&(f.nodeType===1||f.nodeType===9)){if(m[1]){return J(f.getElementsByTagName(k),p)}else{if(m[2]&&K.find.CLASS&&f.getElementsByClassName){return J(f.getElementsByClassName(m[2]),p)}}}if(f.nodeType===9){if(k==="body"&&f.body){return J([f.body],p)}else{if(m&&m[3]){var q=f.getElementById(m[3]);if(q&&q.parentNode){if(q.id===m[3]){return J([q],p)}}else{return J([],p)}}}try{return J(f.querySelectorAll(k),p)}catch(o){}}else{if(f.nodeType===1&&f.nodeName.toLowerCase()!=="object"){var s=f,r=f.getAttribute("id"),g=r||a,h=f.parentNode,j=/^\s*[+~]/.test(k);if(!r){f.setAttribute("id",g)}else{g=g.replace(/'/g,"\\$&")}if(j&&h){f=f.parentNode}try{if(!j||h){return J(f.querySelectorAll("[id='"+g+"'] "+k),p)}}catch(n){}finally{if(!r){s.removeAttribute("id")}}}}}return b(k,f,p,l)};for(var c in b){Q[c]=b[c]}d=null})()}(function(){var b=document.documentElement,a=b.matchesSelector||b.mozMatchesSelector||b.webkitMatchesSelector||b.msMatchesSelector;if(a){var d=!a.call(document.createElement("div"),"div"),c=false;try{a.call(document.documentElement,"[test!='']:sizzle")}catch(f){c=true}Q.matchesSelector=function(j,g){g=g.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Q.isXML(j)){try{if(c||!K.match.PSEUDO.test(g)&&!/!=/.test(g)){var k=a.call(j,g);if(k||!d||j.document&&j.document.nodeType!==11){return k}}}catch(h){}}return Q(g,null,null,[j]).length>0}}})();(function(){var a=document.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!a.getElementsByClassName||a.getElementsByClassName("e").length===0){return}a.lastChild.className="e";if(a.getElementsByClassName("e").length===1){return}K.order.splice(1,0,"CLASS");K.find.CLASS=function(c,b,d){if(typeof b.getElementsByClassName!=="undefined"&&!d){return b.getElementsByClassName(c[1])}};a=null})();function T(g,l,a,h,k,j){for(var c=0,d=h.length;c<d;c++){var f=h[c];if(f){var b=false;f=f[g];while(f){if(f[M]===a){b=h[f.sizset];break}if(f.nodeType===1&&!j){f[M]=a;f.sizset=c}if(f.nodeName.toLowerCase()===l){b=f;break}f=f[g]}h[c]=b}}}function B(g,l,a,h,k,j){for(var c=0,d=h.length;c<d;c++){var f=h[c];if(f){var b=false;f=f[g];while(f){if(f[M]===a){b=h[f.sizset];break}if(f.nodeType===1){if(!j){f[M]=a;f.sizset=c}if(typeof l!=="string"){if(f===l){b=true;break}}else{if(Q.filter(l,[f]).length>0){b=f;break}}}f=f[g]}h[c]=b}}}if(document.documentElement.contains){Q.contains=function(b,a){return b!==a&&(b.contains?b.contains(a):true)}}else{if(document.documentElement.compareDocumentPosition){Q.contains=function(b,a){return !!(b.compareDocumentPosition(a)&16)}}else{Q.contains=function(){return false}}}Q.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":false};var C=function(d,f,k){var a,j=[],b="",h=f.nodeType?[f]:f;while((a=K.match.PSEUDO.exec(d))){b+=a[0];d=d.replace(K.match.PSEUDO,"")}d=K.relative[d]?d+"*":d;for(var c=0,g=h.length;c<g;c++){Q(d,h[c],j,k)}return Q.filter(b,j)};window.tinymce.dom.Sizzle=Q})();(function(b){b.dom.Element=function(g,j){var a=this,h,k;a.settings=j=j||{};a.id=g;a.dom=h=j.dom||b.DOM;if(!b.isIE){k=h.get(a.id)}b.each(("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get").split(/,/),function(c){a[c]=function(){var e=[g],d;for(d=0;d<arguments.length;d++){e.push(arguments[d])}e=h[c].apply(h,e);a.update(c);return e}});b.extend(a,{on:function(c,d,e){return b.dom.Event.add(a.id,c,d,e)},getXY:function(){return{x:parseInt(a.getStyle("left")),y:parseInt(a.getStyle("top"))}},getSize:function(){var c=h.get(a.id);return{w:parseInt(a.getStyle("width")||c.clientWidth),h:parseInt(a.getStyle("height")||c.clientHeight)}},moveTo:function(d,c){a.setStyles({left:d,top:c})},moveBy:function(e,c){var d=a.getXY();a.moveTo(d.x+e,d.y+c)},resizeTo:function(d,c){a.setStyles({width:d,height:c})},resizeBy:function(e,c){var d=a.getSize();a.resizeTo(d.w+e,d.h+c)},update:function(c){var d;if(b.isIE6&&j.blocker){c=c||"";if(c.indexOf("get")===0||c.indexOf("has")===0||c.indexOf("is")===0){return}if(c=="remove"){h.remove(a.blocker);return}if(!a.blocker){a.blocker=h.uniqueId();d=h.add(j.container||h.getRoot(),"iframe",{id:a.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'});h.setStyle(d,"opacity",0)}else{d=h.get(a.blocker)}h.setStyles(d,{left:a.getStyle("left",1),top:a.getStyle("top",1),width:a.getStyle("width",1),height:a.getStyle("height",1),display:a.getStyle("display",1),zIndex:parseInt(a.getStyle("zIndex",1)||0)-1})}}})}})(tinymce);(function(l){function j(a){return a.replace(/[\n\r]+/g,"")}var m=l.is,g=l.isIE,k=l.each,h=l.dom.TreeWalker;l.create("tinymce.dom.Selection",{Selection:function(a,b,c){var d=this;d.dom=a;d.win=b;d.serializer=c;k(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(e){d[e]=new l.util.Dispatcher(d)});if(!d.win.getSelection){d.tridentSel=new l.dom.TridentSelection(d)}if(l.isIE&&a.boxModel){this._fixIESelection()}l.addUnload(d.destroy,d)},setCursorLocation:function(b,a){var d=this;var c=d.dom.createRng();c.setStart(b,a);c.setEnd(b,a);d.setRng(c);d.collapse(false)},getContent:function(f){var n=this,e=n.getRng(),a=n.dom.create("body"),c=n.getSel(),d,b,p;f=f||{};d=b="";f.get=true;f.format=f.format||"html";f.forced_root_block="";n.onBeforeGetContent.dispatch(n,f);if(f.format=="text"){return n.isCollapsed()?"":(e.text||(c.toString?c.toString():""))}if(e.cloneContents){p=e.cloneContents();if(p){a.appendChild(p)}}else{if(m(e.item)||m(e.htmlText)){a.innerHTML="<br>"+(e.item?e.item(0).outerHTML:e.htmlText);a.removeChild(a.firstChild)}else{a.innerHTML=e.toString()}}if(/^\s/.test(a.innerHTML)){d=" "}if(/\s+$/.test(a.innerHTML)){b=" "}f.getInner=true;f.content=n.isCollapsed()?"":d+n.serializer.serialize(a,f)+b;n.onGetContent.dispatch(n,f);return f.content},setContent:function(q,f){var a=this,r=a.getRng(),e,d=a.win.document,b,c;f=f||{format:"html"};f.set=true;q=f.content=q;if(!f.no_events){a.onBeforeSetContent.dispatch(a,f)}q=f.content;if(r.insertNode){q+='<span id="__caret">_</span>';if(r.startContainer==d&&r.endContainer==d){d.body.innerHTML=q}else{r.deleteContents();if(d.body.childNodes.length===0){d.body.innerHTML=q}else{if(r.createContextualFragment){r.insertNode(r.createContextualFragment(q))}else{b=d.createDocumentFragment();c=d.createElement("div");b.appendChild(c);c.outerHTML=q;r.insertNode(b)}}}e=a.dom.get("__caret");r=d.createRange();r.setStartBefore(e);r.setEndBefore(e);a.setRng(r);a.dom.remove("__caret");try{a.setRng(r)}catch(p){}}else{if(r.item){d.execCommand("Delete",false,null);r=a.getRng()}if(/^\s+/.test(q)){r.pasteHTML('<span id="__mce_tmp">_</span>'+q);a.dom.remove("__mce_tmp")}else{r.pasteHTML(q)}}if(!f.no_events){a.onSetContent.dispatch(a,f)}},getStart:function(){var d=this.getRng(),c,e,a,b;if(d.duplicate||d.item){if(d.item){return d.item(0)}a=d.duplicate();a.collapse(1);c=a.parentElement();e=b=d.parentElement();while(b=b.parentNode){if(b==c){c=e;break}}return c}else{c=d.startContainer;if(c.nodeType==1&&c.hasChildNodes()){c=c.childNodes[Math.min(c.childNodes.length-1,d.startOffset)]}if(c&&c.nodeType==3){return c.parentNode}return c}},getEnd:function(){var c=this,b=c.getRng(),a,d;if(b.duplicate||b.item){if(b.item){return b.item(0)}b=b.duplicate();b.collapse(0);a=b.parentElement();if(a&&a.nodeName=="BODY"){return a.lastChild||a}return a}else{a=b.endContainer;d=b.endOffset;if(a.nodeType==1&&a.hasChildNodes()){a=a.childNodes[d>0?d-1:d]}if(a&&a.nodeType==3){return a.parentNode}return a}},getBookmark:function(H,G){var E=this,e=E.dom,C,z,A,d,B,c,b,f="\uFEFF",F;function D(o,n){var p=0;k(e.select(o),function(q,r){if(q==n){p=r}});return p}function y(){var o=E.getRng(true),q=e.getRoot(),n={};function p(K,r){var L=K[r?"startContainer":"endContainer"],s=K[r?"startOffset":"endOffset"],M=[],x,u,v=0;if(L.nodeType==3){if(G){for(x=L.previousSibling;x&&x.nodeType==3;x=x.previousSibling){s+=x.nodeValue.length}}M.push(s)}else{u=L.childNodes;if(s>=u.length&&u.length){v=1;s=Math.max(0,u.length-1)}M.push(E.dom.nodeIndex(u[s],G)+v)}for(;L&&L!=q;L=L.parentNode){M.push(E.dom.nodeIndex(L,G))}return M}n.start=p(o,true);if(!E.isCollapsed()){n.end=p(o)}return n}if(H==2){if(E.tridentSel){return E.tridentSel.getBookmark(H)}return y()}if(H){return{rng:E.getRng()}}C=E.getRng();A=e.uniqueId();d=tinyMCE.activeEditor.selection.isCollapsed();F="overflow:hidden;line-height:0px";if(C.duplicate||C.item){if(!C.item){z=C.duplicate();try{C.collapse();C.pasteHTML('<span data-mce-type="bookmark" id="'+A+'_start" style="'+F+'">'+f+"</span>");if(!d){z.collapse(false);C.moveToElementText(z.parentElement());if(C.compareEndPoints("StartToEnd",z)===0){z.move("character",-1)}z.pasteHTML('<span data-mce-type="bookmark" id="'+A+'_end" style="'+F+'">'+f+"</span>")}}catch(a){return null}}else{c=C.item(0);B=c.nodeName;return{name:B,index:D(B,c)}}}else{c=E.getNode();B=c.nodeName;if(B=="IMG"){return{name:B,index:D(B,c)}}if(C.startContainer.nodeType==9){return}z=C.cloneRange();if(!d){z.collapse(false);z.insertNode(e.create("span",{"data-mce-type":"bookmark",id:A+"_end",style:F},f))}C.collapse(true);C.insertNode(e.create("span",{"data-mce-type":"bookmark",id:A+"_start",style:F},f))}E.moveToBookmark({id:A,keep:1});return{id:A}},moveToBookmark:function(d){var D=this,f=D.dom,y,z,B,a,x,C,c,b;function A(s){var p=d[s?"start":"end"],r,q,o,n;if(p){o=p[0];for(q=a,r=p.length-1;r>=1;r--){n=q.childNodes;if(p[r]>n.length-1){return}q=n[p[r]]}if(q.nodeType===3){o=Math.min(p[0],q.nodeValue.length)}if(q.nodeType===1){o=Math.min(p[0],q.childNodes.length)}if(s){B.setStart(q,o)}else{B.setEnd(q,o)}}return true}function v(r){var o=f.get(d.id+"_"+r),u,p,q,n,s=d.keep;if(o){u=o.parentNode;if(r=="start"){if(!s){p=f.nodeIndex(o)}else{u=o.firstChild;p=1}x=C=u;c=b=p}else{if(!s){p=f.nodeIndex(o)}else{u=o.firstChild;p=1}C=u;b=p}if(!s){n=o.previousSibling;q=o.nextSibling;k(l.grep(o.childNodes),function(E){if(E.nodeType==3){E.nodeValue=E.nodeValue.replace(/\uFEFF/g,"")}});while(o=f.get(d.id+"_"+r)){f.remove(o,1)}if(n&&q&&n.nodeType==q.nodeType&&n.nodeType==3&&!l.isOpera){p=n.nodeValue.length;n.appendData(q.nodeValue);f.remove(q);if(r=="start"){x=C=n;c=b=p}else{C=n;b=p}}}}}function e(n){if(f.isBlock(n)&&!n.innerHTML&&!g){n.innerHTML='<br data-mce-bogus="1" />'}return n}if(d){if(d.start){B=f.createRng();a=f.getRoot();if(D.tridentSel){return D.tridentSel.moveToBookmark(d)}if(A(true)&&A()){D.setRng(B)}}else{if(d.id){v("start");v("end");if(x){B=f.createRng();B.setStart(e(x),c);B.setEnd(e(C),b);D.setRng(B)}}else{if(d.name){D.select(f.select(d.name)[d.index])}else{if(d.rng){D.setRng(d.rng)}}}}}},select:function(b,c){var d=this,a=d.dom,f=a.createRng(),n;function e(s,q){var r=new h(s,s);do{if(s.nodeType==3&&l.trim(s.nodeValue).length!==0){if(q){f.setStart(s,0)}else{f.setEnd(s,s.nodeValue.length)}return}if(s.nodeName=="BR"){if(q){f.setStartBefore(s)}else{f.setEndBefore(s)}return}}while(s=(q?r.next():r.prev()))}if(b){n=a.nodeIndex(b);f.setStart(b.parentNode,n);f.setEnd(b.parentNode,n+1);if(c){e(b,1);e(b)}d.setRng(f)}return b},isCollapsed:function(){var c=this,a=c.getRng(),b=c.getSel();if(!a||a.item){return false}if(a.compareEndPoints){return a.compareEndPoints("StartToEnd",a)===0}return !b||a.collapsed},collapse:function(d){var b=this,c=b.getRng(),a;if(c.item){a=c.item(0);c=b.win.document.body.createTextRange();c.moveToElementText(a)}c.collapse(!!d);b.setRng(c)},getSel:function(){var a=this,b=this.win;return b.getSelection?b.getSelection():b.document.selection},getRng:function(a){var f=this,e,d,b,c=f.win.document;if(a&&f.tridentSel){return f.tridentSel.getRangeAt(0)}try{if(e=f.getSel()){d=e.rangeCount>0?e.getRangeAt(0):(e.createRange?e.createRange():c.createRange())}}catch(n){}if(l.isIE&&d&&d.setStart&&c.selection.createRange().item){b=c.selection.createRange().item(0);d=c.createRange();d.setStartBefore(b);d.setEndAfter(b)}if(!d){d=c.createRange?c.createRange():c.body.createTextRange()}if(f.selectedRange&&f.explicitRange){if(d.compareBoundaryPoints(d.START_TO_START,f.selectedRange)===0&&d.compareBoundaryPoints(d.END_TO_END,f.selectedRange)===0){d=f.explicitRange}else{f.selectedRange=null;f.explicitRange=null}}return d},setRng:function(a){var b,c=this;if(!c.tridentSel){b=c.getSel();if(b){c.explicitRange=a;try{b.removeAllRanges()}catch(d){}b.addRange(a);c.selectedRange=b.rangeCount>0?b.getRangeAt(0):null}}else{if(a.cloneRange){try{c.tridentSel.addRange(a);return}catch(d){}}try{a.select()}catch(d){}}},setNode:function(a){var b=this;b.setContent(b.dom.getOuterHTML(a));return a},getNode:function(){var e=this,f=e.getRng(),d=e.getSel(),a,b=f.startContainer,n=f.endContainer;function c(r,u){var s=r;while(r&&r.nodeType===3&&r.length===0){r=u?r.nextSibling:r.previousSibling}return r||s}if(!f){return e.dom.getRoot()}if(f.setStart){a=f.commonAncestorContainer;if(!f.collapsed){if(f.startContainer==f.endContainer){if(f.endOffset-f.startOffset<2){if(f.startContainer.hasChildNodes()){a=f.startContainer.childNodes[f.startOffset]}}}if(b.nodeType===3&&n.nodeType===3){if(b.length===f.startOffset){b=c(b.nextSibling,true)}else{b=b.parentNode}if(f.endOffset===0){n=c(n.previousSibling,false)}else{n=n.parentNode}if(b&&b===n){return b}}}if(a&&a.nodeType==3){return a.parentNode}return a}return f.item?f.item(0):f.parentElement()},getSelectedBlocks:function(a,q){var b=this,e=b.dom,c,d,n,f=[];c=e.getParent(a||b.getStart(),e.isBlock);d=e.getParent(q||b.getEnd(),e.isBlock);if(c){f.push(c)}if(c&&d&&c!=d){n=c;var r=new h(c,e.getRoot());while((n=r.next())&&n!=d){if(e.isBlock(n)){f.push(n)}}}if(d&&c!=d){f.push(d)}return f},normalize:function(){var d=this,e,a,b;function c(A){var B,y,C,x=d.dom,F=x.getRoot(),z,f,E;function D(p,o){var n,q;o=o||B;n=new h(o,x.getParent(o.parentNode,x.isBlock)||F);while(z=n[p?"prev":"next"]()){if(z.nodeType===3&&z.nodeValue.length>0){B=z;y=p?z.nodeValue.length:0;a=true;return}if(x.isBlock(z)||f[z.nodeName.toLowerCase()]){return}q=z}if(b&&q){B=q;a=true;y=0}}B=e[(A?"start":"end")+"Container"];y=e[(A?"start":"end")+"Offset"];f=x.schema.getNonEmptyElements();if(B.nodeType===9){B=B.body;y=0}if(B===F){if(A){z=B.childNodes[y>0?y-1:0];if(z){E=z.nodeName.toLowerCase();if(f[z.nodeName]||z.nodeName=="TABLE"){return}}}if(B.hasChildNodes()){B=B.childNodes[Math.min(!A&&y>0?y-1:y,B.childNodes.length-1)];y=0;if(B.hasChildNodes()){z=B;C=new h(B,F);do{if(z.nodeType===3&&z.nodeValue.length>0){y=A?0:z.nodeValue.length;B=z;a=true;break}if(f[z.nodeName.toLowerCase()]){y=x.nodeIndex(z);B=z.parentNode;if(z.nodeName=="IMG"&&!A){y++}a=true;break}}while(z=(A?C.next():C.prev()))}}}if(b){if(B.nodeType===3&&y===0){D(true)}if(B.nodeType===1&&B.childNodes[y]&&B.childNodes[y].nodeName==="BR"){D(true,B.childNodes[y])}}if(A&&!b&&B.nodeType===3&&y===B.nodeValue.length){D(false)}if(a){e["set"+(A?"Start":"End")](B,y)}}if(l.isIE){return}e=d.getRng();b=e.collapsed;c(true);if(!b){c()}if(a){if(b){e.collapse(true)}d.setRng(e)}},destroy:function(a){var b=this;b.win=null;if(!a){l.removeUnload(b.destroy)}},_fixIESelection:function(){var q=this.dom,b=q.doc,p=b.body,e,a,r;function f(v,n){var u=p.createTextRange();try{u.moveToPoint(v,n)}catch(o){u=null}return u}function c(n){var o;if(n.button){o=f(n.x,n.y);if(o){if(o.compareEndPoints("StartToStart",a)>0){o.setEndPoint("StartToStart",a)}else{o.setEndPoint("EndToEnd",a)}o.select()}}else{d()}}function d(){var n=b.selection.createRange();if(a&&!n.item&&n.compareEndPoints("StartToEnd",n)===0){a.select()}q.unbind(b,"mouseup",d);q.unbind(b,"mousemove",c);a=e=0}b.documentElement.unselectable=true;q.bind(b,["mousedown","contextmenu"],function(n){if(n.target.nodeName==="HTML"){if(e){d()}r=b.documentElement;if(r.scrollHeight>r.clientHeight){return}e=1;a=f(n.x,n.y);if(a){q.bind(b,"mouseup",d);q.bind(b,"mousemove",c);q.win.focus();a.select()}}})}})})(tinymce);(function(b){b.dom.Serializer=function(n,j,m){var k,a,o=b.isIE,l=b.each,p;if(!n.apply_source_formatting){n.indent=false}j=j||b.DOM;m=m||new b.html.Schema(n);n.entity_encoding=n.entity_encoding||"named";n.remove_trailing_brs="remove_trailing_brs" in n?n.remove_trailing_brs:true;k=new b.util.Dispatcher(self);a=new b.util.Dispatcher(self);p=new b.html.DomParser(n,m);p.addAttributeFilter("src,href,style",function(u,v){var f=u.length,s,d,g="data-mce-"+v,e=n.url_converter,c=n.url_converter_scope,h;while(f--){s=u[f];d=s.attributes.map[g];if(d!==h){s.attr(v,d.length>0?d:null);s.attr(g,null)}else{d=s.attributes.map[v];if(v==="style"){d=j.serializeStyle(j.parseStyle(d),s.name)}else{if(e){d=e.call(c,d,v,s.name)}}s.attr(v,d.length>0?d:null)}}});p.addAttributeFilter("class",function(f,e){var d=f.length,c,g;while(d--){c=f[d];g=c.attr("class").replace(/\s*mce(Item\w+|Selected)\s*/g,"");c.attr("class",g.length>0?g:null)}});p.addAttributeFilter("data-mce-type",function(f,d,e){var c=f.length,g;while(c--){g=f[c];if(g.attributes.map["data-mce-type"]==="bookmark"&&!e.cleanup){g.remove()}}});p.addAttributeFilter("data-mce-expando",function(f,d,e){var c=f.length;while(c--){f[c].attr(d,null)}});p.addNodeFilter("script,style",function(e,d){var c=e.length,h,g;function f(q){return q.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}while(c--){h=e[c];g=h.firstChild?h.firstChild.value:"";if(d==="script"){h.attr("type",(h.attr("type")||"text/javascript").replace(/^mce\-/,""));if(g.length>0){h.firstChild.value="// <![CDATA[\n"+f(g)+"\n// ]]>"}}else{if(g.length>0){h.firstChild.value="<!--\n"+f(g)+"\n-->"}}}});p.addNodeFilter("#comment",function(f,e){var d=f.length,c;while(d--){c=f[d];if(c.value.indexOf("[CDATA[")===0){c.name="#cdata";c.type=4;c.value=c.value.replace(/^\[CDATA\[|\]\]$/g,"")}else{if(c.value.indexOf("mce:protected ")===0){c.name="#text";c.type=3;c.raw=true;c.value=unescape(c.value).substr(14)}}}});p.addNodeFilter("xml:namespace,input",function(f,e){var d=f.length,c;while(d--){c=f[d];if(c.type===7){c.remove()}else{if(c.type===1){if(e==="input"&&!("type" in c.attributes.map)){c.attr("type","text")}}}}});if(n.fix_list_elements){p.addNodeFilter("ul,ol",function(e,d){var c=e.length,g,f;while(c--){g=e[c];f=g.parent;if(f.name==="ul"||f.name==="ol"){if(g.prev&&g.prev.name==="li"){g.prev.append(g)}}}})}p.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(e,d){var c=e.length;while(c--){e[c].attr(d,null)}});return{schema:m,addNodeFilter:p.addNodeFilter,addAttributeFilter:p.addAttributeFilter,onPreProcess:k,onPostProcess:a,serialize:function(h,c){var d,g,e,f,q;if(o&&j.select("script,style,select,map").length>0){q=h.innerHTML;h=h.cloneNode(false);j.setHTML(h,q)}else{h=h.cloneNode(true)}d=h.ownerDocument.implementation;if(d.createHTMLDocument){g=d.createHTMLDocument("");l(h.nodeName=="BODY"?h.childNodes:[h],function(r){g.body.appendChild(g.importNode(r,true))});if(h.nodeName!="BODY"){h=g.body.firstChild}else{h=g.body}e=j.doc;j.doc=g}c=c||{};c.format=c.format||"html";if(!c.no_events){c.node=h;k.dispatch(self,c)}f=new b.html.Serializer(n,m);c.content=f.serialize(p.parse(b.trim(c.getInner?h.innerHTML:j.getOuterHTML(h)),c));if(!c.cleanup){c.content=c.content.replace(/\uFEFF|\u200B/g,"")}if(!c.no_events){a.dispatch(self,c)}if(e){j.doc=e}c.node=null;return c.content},addRules:function(c){m.addValidElements(c)},setRules:function(c){m.setValidElements(c)}}}})(tinymce);(function(b){b.dom.ScriptLoader=function(p){var v=0,m=1,o=2,a={},n=[],s={},u=[],q=0,r;function x(h,k){var j=this,d=b.DOM,y,f,c,g;function e(){d.remove(g);if(y){y.onreadystatechange=y.onload=y=null}k()}function l(){if(typeof(console)!=="undefined"&&console.log){console.log("Failed to load: "+h)}}g=d.uniqueId();if(b.isIE6){f=new b.util.URI(h);c=location;if(f.host==c.hostname&&f.port==c.port&&(f.protocol+":")==c.protocol&&f.protocol.toLowerCase()!="file"){b.util.XHR.send({url:b._addVer(f.getURI()),success:function(A){var B=d.create("script",{type:"text/javascript"});B.text=A;document.getElementsByTagName("head")[0].appendChild(B);d.remove(B);e()},error:l});return}}y=d.create("script",{id:g,type:"text/javascript",src:b._addVer(h)});if(!b.isIE){y.onload=e}y.onerror=l;if(!b.isOpera){y.onreadystatechange=function(){var z=y.readyState;if(z=="complete"||z=="loaded"){e()}}}(document.getElementsByTagName("head")[0]||document.body).appendChild(y)}this.isDone=function(c){return a[c]==o};this.markDone=function(c){a[c]=o};this.add=this.load=function(c,d,g){var f,e=a[c];if(e==r){n.push(c);a[c]=v}if(d){if(!s[c]){s[c]=[]}s[c].push({func:d,scope:g||this})}};this.loadQueue=function(d,c){this.loadScripts(n,d,c)};this.loadScripts=function(c,d,e){var f;function g(h){b.each(s[h],function(j){j.func.call(j.scope)});s[h]=r}u.push({func:d,scope:e||this});f=function(){var h=b.grep(c);c.length=0;b.each(h,function(j){if(a[j]==o){g(j);return}if(a[j]!=m){a[j]=m;q++;x(j,function(){a[j]=o;q--;g(j);f()})}});if(!q){b.each(u,function(j){j.func.call(j.scope)});u.length=0}};f()}};b.ScriptLoader=new b.dom.ScriptLoader()})(tinymce);(function(b){b.dom.RangeUtils=function(d){var a="\uFEFF";this.walk=function(J,L){var E=J.startContainer,B=J.startOffset,K=J.endContainer,A=J.endOffset,D,G,y,F,c,v,I;I=d.select("td.mceSelected,th.mceSelected");if(I.length>0){b.each(I,function(e){L([e])});return}function H(f){var e;e=f[0];if(e.nodeType===3&&e===E&&B>=e.nodeValue.length){f.splice(0,1)}e=f[f.length-1];if(A===0&&f.length>0&&e===K&&e.nodeType===3){f.splice(f.length-1,1)}return f}function x(h,e,f){var g=[];for(;h&&h!=f;h=h[e]){g.push(h)}return g}function z(e,f){do{if(e.parentNode==f){return e}e=e.parentNode}while(e)}function C(h,e,g){var f=g?"nextSibling":"previousSibling";for(F=h,c=F.parentNode;F&&F!=e;F=c){c=F.parentNode;v=x(F==h?F:F[f],f);if(v.length){if(!g){v.reverse()}L(H(v))}}}if(E.nodeType==1&&E.hasChildNodes()){E=E.childNodes[B]}if(K.nodeType==1&&K.hasChildNodes()){K=K.childNodes[Math.min(A-1,K.childNodes.length-1)]}if(E==K){return L(H([E]))}D=d.findCommonAncestor(E,K);for(F=E;F;F=F.parentNode){if(F===K){return C(E,D,true)}if(F===D){break}}for(F=K;F;F=F.parentNode){if(F===E){return C(K,D)}if(F===D){break}}G=z(E,D)||E;y=z(K,D)||K;C(E,G,true);v=x(G==E?G:G.nextSibling,"nextSibling",y==K?y.nextSibling:y);if(v.length){L(H(v))}C(K,y)};this.split=function(m){var j=m.startContainer,n=m.startOffset,c=m.endContainer,k=m.endOffset;function l(f,e){return f.splitText(e)}if(j==c&&j.nodeType==3){if(n>0&&n<j.nodeValue.length){c=l(j,n);j=c.previousSibling;if(k>n){k=k-n;j=c=l(c,k).previousSibling;k=c.nodeValue.length;n=0}else{k=0}}}else{if(j.nodeType==3&&n>0&&n<j.nodeValue.length){j=l(j,n);n=0}if(c.nodeType==3&&k>0&&k<c.nodeValue.length){c=l(c,k).previousSibling;k=c.nodeValue.length}}return{startContainer:j,startOffset:n,endContainer:c,endOffset:k}}};b.dom.RangeUtils.compareRanges=function(d,a){if(d&&a){if(d.item||d.duplicate){if(d.item&&a.item&&d.item(0)===a.item(0)){return true}if(d.isEqual&&a.isEqual&&a.isEqual(d)){return true}}else{return d.startContainer==a.startContainer&&d.startOffset==a.startOffset}}return false}})(tinymce);(function(d){var e=d.dom.Event,f=d.each;d.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(A,z){var a=this,q=A.root,r=A.items,c=A.enableUpDown,v=A.enableLeftRight||!A.enableUpDown,s=A.excludeFromTabOrder,u,x,b,B,y;z=z||d.DOM;u=function(g){y=g.target.id};x=function(g){z.setAttrib(g.target.id,"tabindex","-1")};B=function(h){var g=z.get(y);z.setAttrib(g,"tabindex","0");g.focus()};a.focus=function(){z.get(y).focus()};a.destroy=function(){f(r,function(g){z.unbind(z.get(g.id),"focus",u);z.unbind(z.get(g.id),"blur",x)});z.unbind(z.get(q),"focus",B);z.unbind(z.get(q),"keydown",b);r=z=q=a.focus=u=x=b=B=null;a.destroy=function(){}};a.moveFocus=function(g,k){var l=-1,h=a.controls,j;if(!y){return}f(r,function(n,m){if(n.id===y){l=m;return false}});l+=g;if(l<0){l=r.length-1}else{if(l>=r.length){l=0}}j=r[l];z.setAttrib(y,"tabindex","-1");z.setAttrib(j.id,"tabindex","0");z.get(j.id).focus();if(A.actOnFocus){A.onAction(j.id)}if(k){e.cancel(k)}};b=function(k){var n=37,o=39,l=38,j=40,h=27,p=14,g=13,m=32;switch(k.keyCode){case n:if(v){a.moveFocus(-1)}break;case o:if(v){a.moveFocus(1)}break;case l:if(c){a.moveFocus(-1)}break;case j:if(c){a.moveFocus(1)}break;case h:if(A.onCancel){A.onCancel();e.cancel(k)}break;case p:case g:case m:if(A.onAction){A.onAction(y);e.cancel(k)}break}};f(r,function(g,j){var h;if(!g.id){g.id=z.uniqueId("_mce_item_")}if(s){z.bind(g.id,"blur",x);h="-1"}else{h=(j===0?"0":"-1")}z.setAttrib(g.id,"tabindex",h);z.bind(z.get(g.id),"focus",u)});if(r[0]){y=r[0].id}z.setAttrib(q,"tabindex","-1");z.bind(z.get(q),"focus",B);z.bind(z.get(q),"keydown",b)}})})(tinymce);(function(f){var d=f.DOM,e=f.is;f.create("tinymce.ui.Control",{Control:function(a,b,c){this.id=a;this.settings=b=b||{};this.rendered=false;this.onRender=new f.util.Dispatcher(this);this.classPrefix="";this.scope=b.scope||this;this.disabled=0;this.active=0;this.editor=c},setAriaProperty:function(a,b){var c=d.get(this.id+"_aria")||d.get(this.id);if(c){d.setAttrib(c,"aria-"+a,!!b)}},focus:function(){d.get(this.id).focus()},setDisabled:function(a){if(a!=this.disabled){this.setAriaProperty("disabled",a);this.setState("Disabled",a);this.setState("Enabled",!a);this.disabled=a}},isDisabled:function(){return this.disabled},setActive:function(a){if(a!=this.active){this.setState("Active",a);this.active=a;this.setAriaProperty("pressed",a)}},isActive:function(){return this.active},setState:function(a,c){var b=d.get(this.id);a=this.classPrefix+a;if(c){d.addClass(b,a)}else{d.removeClass(b,a)}},isRendered:function(){return this.rendered},renderHTML:function(){},renderTo:function(a){d.setHTML(a,this.renderHTML())},postRender:function(){var a=this,b;if(e(a.disabled)){b=a.disabled;a.disabled=-1;a.setDisabled(b)}if(e(a.active)){b=a.active;a.active=-1;a.setActive(b)}},remove:function(){d.remove(this.id);this.destroy()},destroy:function(){f.dom.Event.clear(this.id)}})})(tinymce);tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(f,d,e){this.parent(f,d,e);this.controls=[];this.lookup={}},add:function(b){this.lookup[b.id]=b;this.controls.push(b);return b},get:function(b){return this.lookup[b]}});tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(c,d){this.parent(c,d);this.classPrefix="mceSeparator";this.setDisabled(true)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}});(function(j){var k=j.is,f=j.DOM,h=j.each,g=j.walk;j.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(a,b){this.parent(a,b);this.classPrefix="mceMenuItem"},setSelected:function(a){this.setState("Selected",a);this.setAriaProperty("checked",!!a);this.selected=a},isSelected:function(){return this.selected},postRender:function(){var a=this;a.parent();if(k(a.selected)){a.setSelected(a.selected)}}})})(tinymce);(function(j){var k=j.is,f=j.DOM,h=j.each,g=j.walk;j.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(a,b){var c=this;c.parent(a,b);c.items={};c.collapsed=false;c.menuCount=0;c.onAddItem=new j.util.Dispatcher(this)},expand:function(a){var b=this;if(a){g(b,function(c){if(c.expand){c.expand()}},"items",b)}b.collapsed=false},collapse:function(a){var b=this;if(a){g(b,function(c){if(c.collapse){c.collapse()}},"items",b)}b.collapsed=true},isCollapsed:function(){return this.collapsed},add:function(a){if(!a.settings){a=new j.ui.MenuItem(a.id||f.uniqueId(),a)}this.onAddItem.dispatch(this,a);return this.items[a.id]=a},addSeparator:function(){return this.add({separator:true})},addMenu:function(a){if(!a.collapse){a=this.createMenu(a)}this.menuCount++;return this.add(a)},hasMenus:function(){return this.menuCount!==0},remove:function(a){delete this.items[a.id]},removeAll:function(){var a=this;g(a,function(b){if(b.removeAll){b.removeAll()}else{b.remove()}b.destroy()},"items",a);a.items={}},createMenu:function(a){var b=new j.ui.Menu(a.id||f.uniqueId(),a);b.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return b}})})(tinymce);(function(k){var l=k.is,m=k.DOM,j=k.each,h=k.dom.Event,g=k.dom.Element;k.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(a,b){b=b||{};b.container=b.container||m.doc.body;b.offset_x=b.offset_x||0;b.offset_y=b.offset_y||0;b.vp_offset_x=b.vp_offset_x||0;b.vp_offset_y=b.vp_offset_y||0;if(l(b.icons)&&!b.icons){b["class"]+=" mceNoIcons"}this.parent(a,b);this.onShowMenu=new k.util.Dispatcher(this);this.onHideMenu=new k.util.Dispatcher(this);this.classPrefix="mceMenu"},createMenu:function(a){var c=this,b=c.settings,d;a.container=a.container||b.container;a.parent=c;a.constrain=a.constrain||b.constrain;a["class"]=a["class"]||b["class"];a.vp_offset_x=a.vp_offset_x||b.vp_offset_x;a.vp_offset_y=a.vp_offset_y||b.vp_offset_y;a.keyboard_focus=b.keyboard_focus;d=new k.ui.DropMenu(a.id||m.uniqueId(),a);d.onAddItem.add(c.onAddItem.dispatch,c.onAddItem);return d},focus:function(){var a=this;if(a.keyboardNav){a.keyboardNav.focus()}},update:function(){var d=this,c=d.settings,f=m.get("menu_"+d.id+"_tbl"),a=m.get("menu_"+d.id+"_co"),e,b;e=c.max_width?Math.min(f.clientWidth,c.max_width):f.clientWidth;b=c.max_height?Math.min(f.clientHeight,c.max_height):f.clientHeight;if(!m.boxModel){d.element.setStyles({width:e+2,height:b+2})}else{d.element.setStyles({width:e,height:b})}if(c.max_width){m.setStyle(a,"width",e)}if(c.max_height){m.setStyle(a,"height",b);if(f.clientHeight<c.max_height){m.setStyle(a,"overflow","hidden")}}},showMenu:function(c,f,a){var E=this,e=E.settings,d,D=m.getViewPort(),G,x,F,b,C=2,y,B,s=E.classPrefix;E.collapse(1);if(E.isMenuVisible){return}if(!E.rendered){d=m.add(E.settings.container,E.renderNode());j(E.items,function(n){n.postRender()});E.element=new g("menu_"+E.id,{blocker:1,container:e.container})}else{d=m.get("menu_"+E.id)}if(!k.isOpera){m.setStyles(d,{left:-65535,top:-65535})}m.show(d);E.update();c+=e.offset_x||0;f+=e.offset_y||0;D.w-=4;D.h-=4;if(e.constrain){G=d.clientWidth-C;x=d.clientHeight-C;F=D.x+D.w;b=D.y+D.h;if((c+e.vp_offset_x+G)>F){c=a?a-G:Math.max(0,(F-e.vp_offset_x)-G)}if((f+e.vp_offset_y+x)>b){f=Math.max(0,(b-e.vp_offset_y)-x)}}m.setStyles(d,{left:c,top:f});E.element.update();E.isMenuVisible=1;E.mouseClickFunc=h.add(d,"click",function(o){var n;o=o.target;if(o&&(o=m.getParent(o,"tr"))&&!m.hasClass(o,s+"ItemSub")){n=E.items[o.id];if(n.isDisabled()){return}y=E;while(y){if(y.hideMenu){y.hideMenu()}y=y.settings.parent}if(n.settings.onclick){n.settings.onclick(o)}return false}});if(E.hasMenus()){E.mouseOverFunc=h.add(d,"mouseover",function(q){var p,n,o;q=q.target;if(q&&(q=m.getParent(q,"tr"))){p=E.items[q.id];if(E.lastMenu){E.lastMenu.collapse(1)}if(p.isDisabled()){return}if(q&&m.hasClass(q,s+"ItemSub")){n=m.getRect(q);p.showMenu((n.x+n.w-C),n.y-C,n.x);E.lastMenu=p;m.addClass(m.get(p.id).firstChild,s+"ItemActive")}}})}h.add(d,"keydown",E._keyHandler,E);E.onShowMenu.dispatch(E);if(e.keyboard_focus){E._setupKeyboardNav()}},hideMenu:function(a){var d=this,b=m.get("menu_"+d.id),c;if(!d.isMenuVisible){return}if(d.keyboardNav){d.keyboardNav.destroy()}h.remove(b,"mouseover",d.mouseOverFunc);h.remove(b,"click",d.mouseClickFunc);h.remove(b,"keydown",d._keyHandler);m.hide(b);d.isMenuVisible=0;if(!a){d.collapse(1)}if(d.element){d.element.hide()}if(c=m.get(d.id)){m.removeClass(c.firstChild,d.classPrefix+"ItemActive")}d.onHideMenu.dispatch(d)},add:function(a){var c=this,b;a=c.parent(a);if(c.isRendered&&(b=m.get("menu_"+c.id))){c._add(m.select("tbody",b)[0],a)}return a},collapse:function(a){this.parent(a);this.hideMenu(1)},remove:function(a){m.remove(a.id);this.destroy();return this.parent(a)},destroy:function(){var b=this,a=m.get("menu_"+b.id);if(b.keyboardNav){b.keyboardNav.destroy()}h.remove(a,"mouseover",b.mouseOverFunc);h.remove(m.select("a",a),"focus",b.mouseOverFunc);h.remove(a,"click",b.mouseClickFunc);h.remove(a,"keydown",b._keyHandler);if(b.element){b.element.remove()}m.remove(a)},renderNode:function(){var d=this,c=d.settings,a,e,b,f;f=m.create("div",{role:"listbox",id:"menu_"+d.id,"class":c["class"],style:"position:absolute;left:0;top:0;z-index:200000;outline:0"});if(d.settings.parent){m.setAttrib(f,"aria-parent","menu_"+d.settings.parent.id)}b=m.add(f,"div",{role:"presentation",id:"menu_"+d.id+"_co","class":d.classPrefix+(c["class"]?" "+c["class"]:"")});d.element=new g("menu_"+d.id,{blocker:1,container:c.container});if(c.menu_line){m.add(b,"span",{"class":d.classPrefix+"Line"})}a=m.add(b,"table",{role:"presentation",id:"menu_"+d.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});e=m.add(a,"tbody");j(d.items,function(n){d._add(e,n)});d.rendered=true;return f},_setupKeyboardNav:function(){var a,b,c=this;a=m.get("menu_"+c.id);b=m.select("a[role=option]","menu_"+c.id);b.splice(0,0,a);c.keyboardNav=new k.ui.KeyboardNavigation({root:"menu_"+c.id,items:b,onCancel:function(){c.hideMenu()},enableUpDown:true});a.focus()},_keyHandler:function(c){var b=this,a;switch(c.keyCode){case 37:if(b.settings.parent){b.hideMenu();b.settings.parent.focus();h.cancel(c)}break;case 39:if(b.mouseOverFunc){b.mouseOverFunc(c)}break}},_add:function(f,o){var n,a=o.settings,b,d,e,c=this.classPrefix,r;if(a.separator){d=m.add(f,"tr",{id:o.id,"class":c+"ItemSeparator"});m.add(d,"td",{"class":c+"ItemSeparator"});if(n=d.previousSibling){m.addClass(n,"mceLast")}return}n=d=m.add(f,"tr",{id:o.id,"class":c+"Item "+c+"ItemEnabled"});n=e=m.add(n,a.titleItem?"th":"td");n=b=m.add(n,"a",{id:o.id+"_aria",role:a.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"});if(a.parent){m.setAttrib(b,"aria-haspopup","true");m.setAttrib(b,"aria-owns","menu_"+o.id)}m.addClass(e,a["class"]);r=m.add(n,"span",{"class":"mceIcon"+(a.icon?" mce_"+a.icon:"")});if(a.icon_src){m.add(r,"img",{src:a.icon_src})}n=m.add(n,a.element||"span",{"class":"mceText",title:o.settings.title},o.settings.title);if(o.settings.style){if(typeof o.settings.style=="function"){o.settings.style=o.settings.style()}m.setAttrib(n,"style",o.settings.style)}if(f.childNodes.length==1){m.addClass(d,"mceFirst")}if((n=d.previousSibling)&&m.hasClass(n,c+"ItemSeparator")){m.addClass(d,"mceFirst")}if(o.collapse){m.addClass(d,c+"ItemSub")}if(n=d.previousSibling){m.removeClass(n,"mceLast")}m.addClass(d,"mceLast")}})})(tinymce);(function(c){var d=c.DOM;c.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(a,b,f){this.parent(a,b,f);this.classPrefix="mceButton"},renderHTML:function(){var a=this.classPrefix,b=this.settings,g,h;h=d.encode(b.label||"");g='<a role="button" id="'+this.id+'" href="javascript:;" class="'+a+" "+a+"Enabled "+b["class"]+(h?" "+a+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+d.encode(b.title)+'">';if(b.image&&!(this.editor&&this.editor.forcedHighContrastMode)){g+='<img class="mceIcon" src="'+b.image+'" alt="'+d.encode(b.title)+'" />'+h}else{g+='<span class="mceIcon '+b["class"]+'"></span>'+(h?'<span class="'+a+'Label">'+h+"</span>":"")}g+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+b.title+"</span>";g+="</a>";return g},postRender:function(){var b=this,a=b.settings,f;if(c.isIE&&b.editor){c.dom.Event.add(b.id,"mousedown",function(h){var e=b.editor.selection.getNode().nodeName;f=e==="IMG"?b.editor.selection.getBookmark():null})}c.dom.Event.add(b.id,"click",function(e){if(!b.isDisabled()){if(c.isIE&&b.editor&&f!==null){b.editor.selection.moveToBookmark(f)}return a.onclick.call(a.scope,e)}});c.dom.Event.add(b.id,"keyup",function(e){if(!b.isDisabled()&&e.keyCode==c.VK.SPACEBAR){return a.onclick.call(a.scope,e)}})}})})(tinymce);(function(k){var l=k.DOM,g=k.dom.Event,j=k.each,h=k.util.Dispatcher,m;k.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(a,b,d){var c=this;c.parent(a,b,d);c.items=[];c.onChange=new h(c);c.onPostRender=new h(c);c.onAdd=new h(c);c.onRenderMenu=new k.util.Dispatcher(this);c.classPrefix="mceListBox";c.marked={}},select:function(c){var d=this,a,b;d.marked={};if(c==m){return d.selectByIndex(-1)}if(c&&typeof(c)=="function"){b=c}else{b=function(e){return e==c}}if(c!=d.selectedValue){j(d.items,function(e,f){if(b(e.value)){a=1;d.selectByIndex(f);return false}});if(!a){d.selectByIndex(-1)}}},selectByIndex:function(e){var c=this,b,a,d;c.marked={};if(e!=c.selectedIndex){b=l.get(c.id+"_text");d=l.get(c.id+"_voiceDesc");a=c.items[e];if(a){c.selectedValue=a.value;c.selectedIndex=e;l.setHTML(b,l.encode(a.title));l.setHTML(d,c.settings.title+" - "+a.title);l.removeClass(b,"mceTitle");l.setAttrib(c.id,"aria-valuenow",a.title)}else{l.setHTML(b,l.encode(c.settings.title));l.setHTML(d,l.encode(c.settings.title));l.addClass(b,"mceTitle");c.selectedValue=c.selectedIndex=null;l.setAttrib(c.id,"aria-valuenow",c.settings.title)}b=0}},mark:function(a){this.marked[a]=true},add:function(a,d,b){var c=this;b=b||{};b=k.extend(b,{title:a,value:d});c.items.push(b);c.onAdd.dispatch(c,b)},getLength:function(){return this.items.length},renderHTML:function(){var b="",d=this,c=d.settings,a=d.classPrefix;b='<span role="listbox" aria-haspopup="true" aria-labelledby="'+d.id+'_voiceDesc" aria-describedby="'+d.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+d.id+'" cellpadding="0" cellspacing="0" class="'+a+" "+a+"Enabled"+(c["class"]?(" "+c["class"]):"")+'"><tbody><tr>';b+="<td>"+l.createHTML("span",{id:d.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},d.settings.title);b+=l.createHTML("a",{id:d.id+"_text",tabindex:-1,href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"},l.encode(d.settings.title))+"</td>";b+="<td>"+l.createHTML("a",{id:d.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25BC</span></span>')+"</td>";b+="</tr></tbody></table></span>";return b},showMenu:function(){var c=this,a,b=l.get(this.id),d;if(c.isDisabled()||c.items.length===0){return}if(c.menu&&c.menu.isMenuVisible){return c.hideMenu()}if(!c.isMenuRendered){c.renderMenu();c.isMenuRendered=true}a=l.getPos(b);d=c.menu;d.settings.offset_x=a.x;d.settings.offset_y=a.y;d.settings.keyboard_focus=!k.isOpera;j(c.items,function(e){if(d.items[e.id]){d.items[e.id].setSelected(0)}});j(c.items,function(e){if(d.items[e.id]&&c.marked[e.value]){d.items[e.id].setSelected(1)}if(e.value===c.selectedValue){d.items[e.id].setSelected(1)}});d.showMenu(0,b.clientHeight);g.add(l.doc,"mousedown",c.hideMenu,c);l.addClass(c.id,c.classPrefix+"Selected")},hideMenu:function(a){var b=this;if(b.menu&&b.menu.isMenuVisible){l.removeClass(b.id,b.classPrefix+"Selected");if(a&&a.type=="mousedown"&&(a.target.id==b.id+"_text"||a.target.id==b.id+"_open")){return}if(!a||!l.getParent(a.target,".mceMenu")){l.removeClass(b.id,b.classPrefix+"Selected");g.remove(l.doc,"mousedown",b.hideMenu,b);b.menu.hideMenu()}}},renderMenu:function(){var a=this,b;b=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":a.classPrefix+"Menu mceNoIcons",max_width:150,max_height:150});b.onHideMenu.add(function(){a.hideMenu();a.focus()});b.add({title:a.settings.title,"class":"mceMenuItemTitle",onclick:function(){if(a.settings.onselect("")!==false){a.select("")}}});j(a.items,function(c){if(c.value===m){b.add({title:c.title,role:"option","class":"mceMenuItemTitle",onclick:function(){if(a.settings.onselect("")!==false){a.select("")}}})}else{c.id=l.uniqueId();c.role="option";c.onclick=function(){if(a.settings.onselect(c.value)!==false){a.select(c.value)}};b.add(c)}});a.onRenderMenu.dispatch(a,b);a.menu=b},postRender:function(){var b=this,a=b.classPrefix;g.add(b.id,"click",b.showMenu,b);g.add(b.id,"keydown",function(c){if(c.keyCode==32){b.showMenu(c);g.cancel(c)}});g.add(b.id,"focus",function(){if(!b._focused){b.keyDownHandler=g.add(b.id,"keydown",function(c){if(c.keyCode==40){b.showMenu();g.cancel(c)}});b.keyPressHandler=g.add(b.id,"keypress",function(c){var d;if(c.keyCode==13){d=b.selectedValue;b.selectedValue=null;g.cancel(c);b.settings.onselect(d)}})}b._focused=1});g.add(b.id,"blur",function(){g.remove(b.id,"keydown",b.keyDownHandler);g.remove(b.id,"keypress",b.keyPressHandler);b._focused=0});if(k.isIE6||!l.boxModel){g.add(b.id,"mouseover",function(){if(!l.hasClass(b.id,a+"Disabled")){l.addClass(b.id,a+"Hover")}});g.add(b.id,"mouseout",function(){if(!l.hasClass(b.id,a+"Disabled")){l.removeClass(b.id,a+"Hover")}})}b.onPostRender.dispatch(b,l.get(b.id))},destroy:function(){this.parent();g.clear(this.id+"_text");g.clear(this.id+"_open")}})})(tinymce);(function(k){var l=k.DOM,g=k.dom.Event,j=k.each,h=k.util.Dispatcher,m;k.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(a,b){this.parent(a,b);this.classPrefix="mceNativeListBox"},setDisabled:function(a){l.get(this.id).disabled=a;this.setAriaProperty("disabled",a)},isDisabled:function(){return l.get(this.id).disabled},select:function(c){var d=this,a,b;if(c==m){return d.selectByIndex(-1)}if(c&&typeof(c)=="function"){b=c}else{b=function(e){return e==c}}if(c!=d.selectedValue){j(d.items,function(e,f){if(b(e.value)){a=1;d.selectByIndex(f);return false}});if(!a){d.selectByIndex(-1)}}},selectByIndex:function(a){l.get(this.id).selectedIndex=a+1;this.selectedValue=this.items[a]?this.items[a].value:null},add:function(a,d,e){var b,c=this;e=e||{};e.value=d;if(c.isRendered()){l.add(l.get(this.id),"option",e,a)}b={title:a,value:d,attribs:e};c.items.push(b);c.onAdd.dispatch(c,b)},getLength:function(){return this.items.length},renderHTML:function(){var a,b=this;a=l.createHTML("option",{value:""},"-- "+b.settings.title+" --");j(b.items,function(c){a+=l.createHTML("option",{value:c.value},c.title)});a=l.createHTML("select",{id:b.id,"class":"mceNativeListBox","aria-labelledby":b.id+"_aria"},a);a+=l.createHTML("span",{id:b.id+"_aria",style:"display: none"},b.settings.title);return a},postRender:function(){var c=this,b,a=true;c.rendered=true;function d(e){var f=c.items[e.target.selectedIndex-1];if(f&&(f=f.value)){c.onChange.dispatch(c,f);if(c.settings.onselect){c.settings.onselect(f)}}}g.add(c.id,"change",d);g.add(c.id,"keydown",function(e){var f;g.remove(c.id,"change",b);a=false;f=g.add(c.id,"blur",function(){if(a){return}a=true;g.add(c.id,"change",d);g.remove(c.id,"blur",f)});if(k.isWebKit&&(e.keyCode==37||e.keyCode==39)){return g.prevent(e)}if(e.keyCode==13||e.keyCode==32){d(e);return g.cancel(e)}});c.onPostRender.dispatch(c,l.get(c.id))}})})(tinymce);(function(h){var e=h.DOM,f=h.dom.Event,g=h.each;h.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(a,b,c){this.parent(a,b,c);this.onRenderMenu=new h.util.Dispatcher(this);b.menu_container=b.menu_container||e.doc.body},showMenu:function(){var d=this,a,b,c=e.get(d.id),k;if(d.isDisabled()){return}if(!d.isMenuRendered){d.renderMenu();d.isMenuRendered=true}if(d.isMenuVisible){return d.hideMenu()}a=e.getPos(d.settings.menu_container);b=e.getPos(c);k=d.menu;k.settings.offset_x=b.x;k.settings.offset_y=b.y;k.settings.vp_offset_x=b.x;k.settings.vp_offset_y=b.y;k.settings.keyboard_focus=d._focused;k.showMenu(0,c.firstChild.clientHeight);f.add(e.doc,"mousedown",d.hideMenu,d);d.setState("Selected",1);d.isMenuVisible=1},renderMenu:function(){var a=this,b;b=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:a.settings.icons});b.onHideMenu.add(function(){a.hideMenu();a.focus()});a.onRenderMenu.dispatch(a,b);a.menu=b},hideMenu:function(a){var b=this;if(a&&a.type=="mousedown"&&e.getParent(a.target,function(c){return c.id===b.id||c.id===b.id+"_open"})){return}if(!a||!e.getParent(a.target,".mceMenu")){b.setState("Selected",0);f.remove(e.doc,"mousedown",b.hideMenu,b);if(b.menu){b.menu.hideMenu()}}b.isMenuVisible=0},postRender:function(){var b=this,a=b.settings;f.add(b.id,"click",function(){if(!b.isDisabled()){if(a.onclick){a.onclick(b.value)}b.showMenu()}})}})})(tinymce);(function(h){var e=h.DOM,f=h.dom.Event,g=h.each;h.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(a,b,c){this.parent(a,b,c);this.classPrefix="mceSplitButton"},renderHTML:function(){var a,c=this,b=c.settings,d;a="<tbody><tr>";if(b.image){d=e.createHTML("img ",{src:b.image,role:"presentation","class":"mceAction "+b["class"]})}else{d=e.createHTML("span",{"class":"mceAction "+b["class"]},"")}d+=e.createHTML("span",{"class":"mceVoiceLabel mceIconOnly",id:c.id+"_voice",style:"display:none;"},b.title);a+="<td >"+e.createHTML("a",{role:"button",id:c.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+b["class"],onclick:"return false;",onmousedown:"return false;",title:b.title},d)+"</td>";d=e.createHTML("span",{"class":"mceOpen "+b["class"]},'<span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25BC</span>');a+="<td >"+e.createHTML("a",{role:"button",id:c.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+b["class"],onclick:"return false;",onmousedown:"return false;",title:b.title},d)+"</td>";a+="</tr></tbody>";a=e.createHTML("table",{role:"presentation","class":"mceSplitButton mceSplitButtonEnabled "+b["class"],cellpadding:"0",cellspacing:"0",title:b.title},a);return e.createHTML("div",{id:c.id,role:"button",tabindex:"0","aria-labelledby":c.id+"_voice","aria-haspopup":"true"},a)},postRender:function(){var c=this,a=c.settings,b;if(a.onclick){b=function(d){if(!c.isDisabled()){a.onclick(c.value);f.cancel(d)}};f.add(c.id+"_action","click",b);f.add(c.id,["click","keydown"],function(r){var o=32,d=14,q=13,p=38,n=40;if((r.keyCode===32||r.keyCode===13||r.keyCode===14)&&!r.altKey&&!r.ctrlKey&&!r.metaKey){b();f.cancel(r)}else{if(r.type==="click"||r.keyCode===n){c.showMenu();f.cancel(r)}}})}f.add(c.id+"_open","click",function(d){c.showMenu();f.cancel(d)});f.add([c.id,c.id+"_open"],"focus",function(){c._focused=1});f.add([c.id,c.id+"_open"],"blur",function(){c._focused=0});if(h.isIE6||!e.boxModel){f.add(c.id,"mouseover",function(){if(!e.hasClass(c.id,"mceSplitButtonDisabled")){e.addClass(c.id,"mceSplitButtonHover")}});f.add(c.id,"mouseout",function(){if(!e.hasClass(c.id,"mceSplitButtonDisabled")){e.removeClass(c.id,"mceSplitButtonHover")}})}},destroy:function(){this.parent();f.clear(this.id+"_action");f.clear(this.id+"_open");f.clear(this.id)}})})(tinymce);(function(j){var k=j.DOM,g=j.dom.Event,f=j.is,h=j.each;j.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(a,b,d){var c=this;c.parent(a,b,d);c.settings=b=j.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"},c.settings);c.onShowMenu=new j.util.Dispatcher(c);c.onHideMenu=new j.util.Dispatcher(c);c.value=b.default_color},showMenu:function(){var e=this,d,a,b,c;if(e.isDisabled()){return}if(!e.isMenuRendered){e.renderMenu();e.isMenuRendered=true}if(e.isMenuVisible){return e.hideMenu()}b=k.get(e.id);k.show(e.id+"_menu");k.addClass(b,"mceSplitButtonSelected");c=k.getPos(b);k.setStyles(e.id+"_menu",{left:c.x,top:c.y+b.firstChild.clientHeight,zIndex:200000});b=0;g.add(k.doc,"mousedown",e.hideMenu,e);e.onShowMenu.dispatch(e);if(e._focused){e._keyHandler=g.add(e.id+"_menu","keydown",function(l){if(l.keyCode==27){e.hideMenu()}});k.select("a",e.id+"_menu")[0].focus()}e.isMenuVisible=1},hideMenu:function(a){var b=this;if(b.isMenuVisible){if(a&&a.type=="mousedown"&&k.getParent(a.target,function(c){return c.id===b.id+"_open"})){return}if(!a||!k.getParent(a.target,".mceSplitButtonMenu")){k.removeClass(b.id,"mceSplitButtonSelected");g.remove(k.doc,"mousedown",b.hideMenu,b);g.remove(b.id+"_menu","keydown",b._keyHandler);k.hide(b.id+"_menu")}b.isMenuVisible=0;b.onHideMenu.dispatch()}},renderMenu:function(){var b=this,n,e=0,a=b.settings,r,m,d,c,s;c=k.add(a.menu_container,"div",{role:"listbox",id:b.id+"_menu","class":a.menu_class+" "+a["class"],style:"position:absolute;left:0;top:-1000px;"});n=k.add(c,"div",{"class":a["class"]+" mceSplitButtonMenu"});k.add(n,"span",{"class":"mceMenuLine"});r=k.add(n,"table",{role:"presentation","class":"mceColorSplitMenu"});m=k.add(r,"tbody");e=0;h(f(a.colors,"array")?a.colors:a.colors.split(","),function(l){l=l.replace(/^#/,"");if(!e--){d=k.add(m,"tr");e=a.grid_width-1}r=k.add(d,"td");var o={href:"javascript:;",style:{backgroundColor:"#"+l},title:b.editor.getLang("colors."+l,l),"data-mce-color":"#"+l};if(!j.isIE){o.role="option"}r=k.add(r,"a",o);if(b.editor.forcedHighContrastMode){r=k.add(r,"canvas",{width:16,height:16,"aria-hidden":"true"});if(r.getContext&&(s=r.getContext("2d"))){s.fillStyle="#"+l;s.fillRect(0,0,16,16)}else{k.remove(r)}}});if(a.more_colors_func){r=k.add(m,"tr");r=k.add(r,"td",{colspan:a.grid_width,"class":"mceMoreColors"});r=k.add(r,"a",{role:"option",id:b.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"},a.more_colors_title);g.add(r,"click",function(l){a.more_colors_func.call(a.more_colors_scope||this);return g.cancel(l)})}k.addClass(n,"mceColorSplitMenu");new j.ui.KeyboardNavigation({root:b.id+"_menu",items:k.select("a",b.id+"_menu"),onCancel:function(){b.hideMenu();b.focus()}});g.add(b.id+"_menu","mousedown",function(l){return g.cancel(l)});g.add(b.id+"_menu","click",function(o){var l;o=k.getParent(o.target,"a",m);if(o&&o.nodeName.toLowerCase()=="a"&&(l=o.getAttribute("data-mce-color"))){b.setColor(l)}return false});return c},setColor:function(a){this.displayColor(a);this.hideMenu();this.settings.onselect(a)},displayColor:function(a){var b=this;k.setStyle(b.id+"_preview","backgroundColor",a);b.value=a},postRender:function(){var b=this,a=b.id;b.parent();k.add(a+"_action","div",{id:a+"_preview","class":"mceColorPreview"});k.setStyle(b.id+"_preview","backgroundColor",b.value)},destroy:function(){this.parent();g.clear(this.id+"_menu");g.clear(this.id+"_more");k.remove(this.id+"_menu")}})})(tinymce);(function(e){var g=e.DOM,h=e.each,f=e.dom.Event;e.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var d=this,b=[],k=d.controls,a=e.each,c=d.settings;b.push('<div id="'+d.id+'" role="group" aria-labelledby="'+d.id+'_voice">');b.push("<span role='application'>");b.push('<span id="'+d.id+'_voice" class="mceVoiceLabel" style="display:none;">'+g.encode(c.name)+"</span>");a(k,function(j){b.push(j.renderHTML())});b.push("</span>");b.push("</div>");return b.join("")},focus:function(){var a=this;g.get(a.id).focus()},postRender:function(){var a=this,b=[];h(a.controls,function(c){h(c.controls,function(d){if(d.id){b.push(d)}})});a.keyNav=new e.ui.KeyboardNavigation({root:a.id,items:b,onCancel:function(){if(e.isWebKit){g.get(a.editor.id+"_ifr").focus()}a.editor.focus()},excludeFromTabOrder:!a.settings.tab_focus_toolbar})},destroy:function(){var a=this;a.parent();a.keyNav.destroy();f.clear(a.id)}})})(tinymce);(function(e){var f=e.DOM,d=e.each;e.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var b=this,q="",o,h,a=b.settings,r,s,p,c;c=b.controls;for(r=0;r<c.length;r++){h=c[r];s=c[r-1];p=c[r+1];if(r===0){o="mceToolbarStart";if(h.Button){o+=" mceToolbarStartButton"}else{if(h.SplitButton){o+=" mceToolbarStartSplitButton"}else{if(h.ListBox){o+=" mceToolbarStartListBox"}}}q+=f.createHTML("td",{"class":o},f.createHTML("span",null,"<!-- IE -->"))}if(s&&h.ListBox){if(s.Button||s.SplitButton){q+=f.createHTML("td",{"class":"mceToolbarEnd"},f.createHTML("span",null,"<!-- IE -->"))}}if(f.stdMode){q+='<td style="position: relative">'+h.renderHTML()+"</td>"}else{q+="<td>"+h.renderHTML()+"</td>"}if(p&&h.ListBox){if(p.Button||p.SplitButton){q+=f.createHTML("td",{"class":"mceToolbarStart"},f.createHTML("span",null,"<!-- IE -->"))}}}o="mceToolbarEnd";if(h.Button){o+=" mceToolbarEndButton"}else{if(h.SplitButton){o+=" mceToolbarEndSplitButton"}else{if(h.ListBox){o+=" mceToolbarEndListBox"}}}q+=f.createHTML("td",{"class":o},f.createHTML("span",null,"<!-- IE -->"));return f.createHTML("table",{id:b.id,"class":"mceToolbar"+(a["class"]?" "+a["class"]:""),cellpadding:"0",cellspacing:"0",align:b.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+q+"</tr></tbody>")}})})(tinymce);(function(d){var e=d.util.Dispatcher,f=d.each;d.create("tinymce.AddOnManager",{AddOnManager:function(){var a=this;a.items=[];a.urls={};a.lookup={};a.onAdd=new e(a)},get:function(a){if(this.lookup[a]){return this.lookup[a].instance}else{return undefined}},dependencies:function(a){var b;if(this.lookup[a]){b=this.lookup[a].dependencies}return b||[]},requireLangPack:function(a){var b=d.settings;if(b&&b.language&&b.language_load!==false){d.ScriptLoader.add(this.urls[a]+"/langs/"+b.language+".js")}},add:function(a,b,c){this.items.push(b);this.lookup[a]={instance:b,dependencies:c};this.onAdd.dispatch(this,a,b);return b},createUrl:function(b,a){if(typeof a==="object"){return a}else{return{prefix:b.prefix,resource:a,suffix:b.suffix}}},addComponents:function(a,c){var b=this.urls[a];d.each(c,function(h){d.ScriptLoader.add(b+"/"+h)})},load:function(a,l,n,c){var k=this,m=l;function b(){var g=k.dependencies(a);d.each(g,function(h){var j=k.createUrl(l,h);k.load(j.resource,j,undefined,undefined)});if(n){if(c){n.call(c)}else{n.call(d.ScriptLoader)}}}if(k.urls[a]){return}if(typeof l==="object"){m=l.prefix+l.resource+l.suffix}if(m.indexOf("/")!==0&&m.indexOf("://")==-1){m=d.baseURL+"/"+m}k.urls[a]=m.substring(0,m.lastIndexOf("/"));if(k.lookup[a]){b()}else{d.ScriptLoader.add(m,b,c)}}});d.PluginManager=new d.AddOnManager();d.ThemeManager=new d.AddOnManager()}(tinymce));(function(m){var p=m.each,s=m.extend,l=m.DOM,n=m.dom.Event,q=m.ThemeManager,v=m.PluginManager,r=m.explode,o=m.util.Dispatcher,x,u=0;m.documentBaseURL=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");if(!/[\/\\]$/.test(m.documentBaseURL)){m.documentBaseURL+="/"}m.baseURL=new m.util.URI(m.documentBaseURL).toAbsolute(m.baseURL);m.baseURI=new m.util.URI(m.baseURL);m.onBeforeUnload=new o(m);n.add(window,"beforeunload",function(a){m.onBeforeUnload.dispatch(m,a)});m.onAddEditor=new o(m);m.onRemoveEditor=new o(m);m.EditorManager=s(m,{editors:[],i18n:{},activeEditor:null,init:function(h){var j=this,d,e=m.ScriptLoader,k,g=[],a;function b(A){var z=A.id;if(!z){z=A.name;if(z&&!l.get(z)){z=A.name}else{z=l.uniqueId()}A.setAttribute("id",z)}return z}function f(C,F,E){var D=C[F];if(!D){return}if(m.is(D,"string")){E=D.replace(/\.\w+$/,"");E=E?m.resolve(E):0;D=m.resolve(D)}return D.apply(E||this,Array.prototype.slice.call(arguments,2))}function c(A,z){return z.constructor===RegExp?z.test(A.className):l.hasClass(A,z)}h=s({theme:"simple",language:"en"},h);j.settings=h;n.bind(window,"ready",function(){var z,A;f(h,"onpageload");switch(h.mode){case"exact":z=h.elements||"";if(z.length>0){p(r(z),function(y){if(l.get(y)){a=new m.Editor(y,h);g.push(a);a.render(1)}else{p(document.forms,function(B){p(B.elements,function(C){if(C.name===y){y="mce_editor_"+u++;l.setAttrib(C,"id",y);a=new m.Editor(y,h);g.push(a);a.render(1)}})})}})}break;case"textareas":case"specific_textareas":p(l.select("textarea"),function(y){if(h.editor_deselector&&c(y,h.editor_deselector)){return}if(!h.editor_selector||c(y,h.editor_selector)){a=new m.Editor(b(y),h);g.push(a);a.render(1)}});break;default:if(h.types){p(h.types,function(y){p(l.select(y.selector),function(D){var C=new m.Editor(b(D),m.extend({},h,y));g.push(C);C.render(1)})})}else{if(h.selector){p(l.select(h.selector),function(y){var B=new m.Editor(b(y),h);g.push(B);B.render(1)})}}}if(h.oninit){z=A=0;p(g,function(y){A++;if(!y.initialized){y.onInit.add(function(){z++;if(z==A){f(h,"oninit")}})}else{z++}if(z==A){f(h,"oninit")}})}})},get:function(a){if(a===x){return this.editors}return this.editors[a]},getInstanceById:function(a){return this.get(a)},add:function(a){var b=this,c=b.editors;c[a.id]=a;c.push(a);b._setActive(a);b.onAddEditor.dispatch(b,a);return a},remove:function(d){var a=this,b,c=a.editors;if(!c[d.id]){return null}delete c[d.id];for(b=0;b<c.length;b++){if(c[b]==d){c.splice(b,1);break}}if(a.activeEditor==d){a._setActive(c[0])}d.destroy();a.onRemoveEditor.dispatch(a,d);return d},execCommand:function(c,e,f){var d=this,g=d.get(f),b;function a(){g.destroy();b.detachEvent("onunload",a);b=b.tinyMCE=b.tinymce=null}switch(c){case"mceFocus":g.focus();return true;case"mceAddEditor":case"mceAddControl":if(!d.get(f)){new m.Editor(f,d.settings).render()}return true;case"mceAddFrameControl":b=f.window;b.tinyMCE=tinyMCE;b.tinymce=m;m.DOM.doc=b.document;m.DOM.win=b;g=new m.Editor(f.element_id,f);g.render();if(m.isIE){b.attachEvent("onunload",a)}f.page_window=null;return true;case"mceRemoveEditor":case"mceRemoveControl":if(g){g.remove()}return true;case"mceToggleEditor":if(!g){d.execCommand("mceAddControl",0,f);return true}if(g.isHidden()){g.show()}else{g.hide()}return true}if(d.activeEditor){return d.activeEditor.execCommand(c,e,f)}return false},execInstanceCommand:function(c,d,e,a){var b=this.get(c);if(b){return b.execCommand(d,e,a)}return false},triggerSave:function(){p(this.editors,function(a){a.save()})},addI18n:function(d,c){var b,a=this.i18n;if(!m.is(d,"string")){p(d,function(e,f){p(e,function(g,h){p(g,function(j,k){if(h==="common"){a[f+"."+k]=j}else{a[f+"."+h+"."+k]=j}})})})}else{p(c,function(e,f){a[d+"."+f]=e})}},_setActive:function(a){this.selectedInstance=this.activeEditor=a}})})(tinymce);(function(n){var m=n.DOM,o=n.dom.Event,s=n.extend,p=n.each,z=n.isGecko,y=n.isIE,u=n.isWebKit,v=n.is,q=n.ThemeManager,x=n.PluginManager,r=n.explode;n.create("tinymce.Editor",{Editor:function(b,c){var a=this,d=true;a.settings=c=s({id:b,language:"en",theme:"simple",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:n.documentBaseURL,add_form_submit_trigger:d,submit_patch:d,add_unload_trigger:d,convert_urls:d,relative_urls:d,remove_script_host:d,table_inline_editing:false,object_resizing:d,accessibility_focus:d,doctype:n.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual:d,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",apply_source_formatting:d,directionality:"ltr",forced_root_block:"p",hidden_input:d,padd_empty_editor:d,render_ui:d,indentation:"30px",fix_table_elements:d,inline_styles:d,convert_fonts_to_spans:d,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure",validate:d,entity_encoding:"named",url_converter:a.convertURL,url_converter_scope:a,ie7_compat:d},c);a.id=a.editorId=b;a.isNotDirty=false;a.plugins={};a.documentBaseURI=new n.util.URI(c.document_base_url||n.documentBaseURL,{base_uri:tinyMCE.baseURI});a.baseURI=n.baseURI;a.contentCSS=[];a.setupEvents();a.execCommands={};a.queryStateCommands={};a.queryValueCommands={};a.execCallback("setup",a)},render:function(e){var d=this,c=d.settings,b=d.id,a=n.ScriptLoader;if(!o.domLoaded){o.add(window,"ready",function(){d.render()});return}tinyMCE.settings=c;if(!d.getElement()){return}if(n.isIDevice&&!n.isIOS5){return}if(!/TEXTAREA|INPUT/i.test(d.getElement().nodeName)&&c.hidden_input&&m.getParent(b,"form")){m.insertAfter(m.create("input",{type:"hidden",name:b}),b)}if(n.WindowManager){d.windowManager=new n.WindowManager(d)}if(c.encoding=="xml"){d.onGetContent.add(function(h,g){if(g.save){g.content=m.encode(g.content)}})}if(c.add_form_submit_trigger){d.onSubmit.addToTop(function(){if(d.initialized){d.save();d.isNotDirty=1}})}if(c.add_unload_trigger){d._beforeUnload=tinyMCE.onBeforeUnload.add(function(){if(d.initialized&&!d.destroyed&&!d.isHidden()){d.save({format:"raw",no_events:true})}})}n.addUnload(d.destroy,d);if(c.submit_patch){d.onBeforeRenderUI.add(function(){var g=d.getElement().form;if(!g){return}if(g._mceOldSubmit){return}if(!g.submit.nodeType&&!g.submit.length){d.formElement=g;g._mceOldSubmit=g.submit;g.submit=function(){n.triggerSave();d.isNotDirty=1;return d.formElement._mceOldSubmit(d.formElement)}}g=null})}function f(){if(c.language&&c.language_load!==false){a.add(n.baseURL+"/langs/"+c.language+".js")}if(c.theme&&c.theme.charAt(0)!="-"&&!q.urls[c.theme]){q.load(c.theme,"themes/"+c.theme+"/editor_template"+n.suffix+".js")}p(r(c.plugins),function(g){if(g&&!x.urls[g]){if(g.charAt(0)=="-"){g=g.substr(1,g.length);var h=x.dependencies(g);p(h,function(j){var k={prefix:"plugins/",resource:j,suffix:"/editor_plugin"+n.suffix+".js"};j=x.createUrl(k,j);x.load(j.resource,j)})}else{if(g=="safari"){return}x.load(g,{prefix:"plugins/",resource:g,suffix:"/editor_plugin"+n.suffix+".js"})}}});a.loadQueue(function(){if(!d.removed){d.init()}})}f()},init:function(){var d,J=this,I=J.settings,c,k,e=J.getElement(),f,h,b,H,g,K,l,a=[];n.add(J);I.aria_label=I.aria_label||m.getAttrib(e,"aria-label",J.getLang("aria.rich_text_area"));if(I.theme){I.theme=I.theme.replace(/-/,"");f=q.get(I.theme);J.theme=new f();if(J.theme.init){J.theme.init(J,q.urls[I.theme]||n.documentBaseURL.replace(/\/$/,""))}}function j(B){var A=x.get(B),C=x.urls[B]||n.documentBaseURL.replace(/\/$/,""),D;if(A&&n.inArray(a,B)===-1){p(x.dependencies(B),function(E){j(E)});D=new A(J,C);J.plugins[B]=D;if(D.init){D.init(J,C);a.push(B)}}}p(r(I.plugins.replace(/\-/g,"")),j);if(I.popup_css!==false){if(I.popup_css){I.popup_css=J.documentBaseURI.toAbsolute(I.popup_css)}else{I.popup_css=J.baseURI.toAbsolute("themes/"+I.theme+"/skins/"+I.skin+"/dialog.css")}}if(I.popup_css_add){I.popup_css+=","+J.documentBaseURI.toAbsolute(I.popup_css_add)}J.controlManager=new n.ControlManager(J);J.onExecCommand.add(function(B,A){if(!/^(FontName|FontSize)$/.test(A)){J.nodeChanged()}});J.onBeforeRenderUI.dispatch(J,J.controlManager);if(I.render_ui&&J.theme){c=I.width||e.style.width||e.offsetWidth;k=I.height||e.style.height||e.offsetHeight;J.orgDisplay=e.style.display;K=/^[0-9\.]+(|px)$/i;if(K.test(""+c)){c=Math.max(parseInt(c,10)+(f.deltaWidth||0),100)}if(K.test(""+k)){k=Math.max(parseInt(k,10)+(f.deltaHeight||0),100)}f=J.theme.renderUI({targetNode:e,width:c,height:k,deltaWidth:I.delta_width,deltaHeight:I.delta_height});J.editorContainer=f.editorContainer}if(I.content_css){p(r(I.content_css),function(A){J.contentCSS.push(J.documentBaseURI.toAbsolute(A))})}if(I.content_editable){e=d=f=null;return J.initContentBody()}if(document.domain&&location.hostname!=document.domain){n.relaxedDomain=document.domain}m.setStyles(f.sizeContainer||f.editorContainer,{width:c,height:k});k=(f.iframeHeight||k)+(typeof(k)=="number"?(f.deltaHeight||0):"");if(k<100){k=100}J.iframeHTML=I.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';if(I.document_base_url!=n.documentBaseURL){J.iframeHTML+='<base href="'+J.documentBaseURI.getURI()+'" />'}if(I.ie7_compat){J.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'}else{J.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=edge" />'}J.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(l=0;l<J.contentCSS.length;l++){J.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+J.contentCSS[l]+'" />'}J.contentCSS=[];H=I.body_id||"tinymce";if(H.indexOf("=")!=-1){H=J.getParam("body_id","","hash");H=H[J.id]||H}g=I.body_class||"";if(g.indexOf("=")!=-1){g=J.getParam("body_class","","hash");g=g[J.id]||""}J.iframeHTML+='</head><body id="'+H+'" class="mceContentBody '+g+'" onload="window.parent.tinyMCE.get(\''+J.id+"').onLoad.dispatch();\"><br></body></html>";if(n.relaxedDomain&&(y||(n.isOpera&&parseFloat(opera.version())<11))){b='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+J.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody();})()'}d=m.add(f.iframeContainer,"iframe",{id:J.id+"_ifr",src:b||'javascript:""',frameBorder:"0",allowTransparency:"true",title:I.aria_label,style:{width:"100%",height:k,display:"block"}});J.contentAreaContainer=f.iframeContainer;m.get(f.editorContainer).style.display=J.orgDisplay;m.get(J.id).style.display="none";m.setAttrib(J.id,"aria-hidden",true);if(!n.relaxedDomain||!b){J.initContentBody()}e=d=f=null},initContentBody:function(){var f=this,d=f.settings,c=m.get(f.id),b=f.getDoc(),e,a;if((!y||!n.relaxedDomain)&&!d.content_editable){b.open();b.write(f.iframeHTML);b.close();if(n.relaxedDomain){b.domain=n.relaxedDomain}}if(d.content_editable){m.addClass(c,"mceContentBody");f.contentDocument=b=d.content_document||document;f.contentWindow=d.content_window||window;f.bodyElement=c;d.content_document=d.content_window=null}a=f.getBody();a.disabled=true;if(!d.readonly){a.contentEditable=f.getParam("content_editable_state",true)}a.disabled=false;f.schema=new n.html.Schema(d);f.dom=new n.dom.DOMUtils(b,{keep_values:true,url_converter:f.convertURL,url_converter_scope:f,hex_colors:d.force_hex_style_colors,class_filter:d.class_filter,update_styles:true,root_element:d.content_editable?f.id:null,schema:f.schema});f.parser=new n.html.DomParser(d,f.schema);f.parser.addAttributeFilter("src,href,style",function(l,k){var j=l.length,C,h=f.dom,B,g;while(j--){C=l[j];B=C.attr(k);g="data-mce-"+k;if(!C.attributes.map[g]){if(k==="style"){C.attr(g,h.serializeStyle(h.parseStyle(B),C.name))}else{C.attr(g,f.convertURL(B,k,C.name))}}}});f.parser.addNodeFilter("script",function(k,j){var h=k.length,g;while(h--){g=k[h];g.attr("type","mce-"+(g.attr("type")||"text/javascript"))}});f.parser.addNodeFilter("#cdata",function(k,j){var h=k.length,g;while(h--){g=k[h];g.type=8;g.name="#comment";g.value="[CDATA["+g.value+"]]"}});f.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(j,h){var g=j.length,l,k=f.schema.getNonEmptyElements();while(g--){l=j[g];if(l.isEmpty(k)){l.empty().append(new n.html.Node("br",1)).shortEnded=true}}});f.serializer=new n.dom.Serializer(d,f.dom,f.schema);f.selection=new n.dom.Selection(f.dom,f.getWin(),f.serializer);f.formatter=new n.Formatter(f);f.undoManager=new n.UndoManager(f);f.forceBlocks=new n.ForceBlocks(f);f.enterKey=new n.EnterKey(f);f.editorCommands=new n.EditorCommands(f);f.serializer.onPreProcess.add(function(h,g){return f.onPreProcess.dispatch(f,g,h)});f.serializer.onPostProcess.add(function(h,g){return f.onPostProcess.dispatch(f,g,h)});f.onPreInit.dispatch(f);if(!d.gecko_spellcheck){b.body.spellcheck=false}if(!d.readonly){f.bindNativeEvents()}f.controlManager.onPostRender.dispatch(f,f.controlManager);f.onPostRender.dispatch(f);f.quirks=n.util.Quirks(f);if(d.directionality){a.dir=d.directionality}if(d.nowrap){a.style.whiteSpace="nowrap"}if(d.protect){f.onBeforeSetContent.add(function(h,g){p(d.protect,function(j){g.content=g.content.replace(j,function(k){return"<!--mce:protected "+escape(k)+"-->"})})})}f.onSetContent.add(function(){f.addVisual(f.getBody())});if(d.padd_empty_editor){f.onPostProcess.add(function(h,g){g.content=g.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")})}f.load({initial:true,format:"html"});f.startContent=f.getContent({format:"raw"});f.initialized=true;f.onInit.dispatch(f);f.execCallback("setupcontent_callback",f.id,a,b);f.execCallback("init_instance_callback",f);f.focus(true);f.nodeChanged({initial:true});p(f.contentCSS,function(g){f.dom.loadCSS(g)});if(d.auto_focus){setTimeout(function(){var g=n.get(d.auto_focus);g.selection.select(g.getBody(),1);g.selection.collapse(1);g.getBody().focus();g.getWin().focus()},100)}c=b=a=null},focus:function(c){var d,g=this,h=g.selection,b=g.settings.content_editable,e,a,j=g.getDoc(),f;if(!c){e=h.getRng();if(e.item){a=e.item(0)}g._refreshContentEditable();if(!b){g.getWin().focus()}if(n.isGecko||b){f=g.getBody();if(f.setActive){f.setActive()}else{f.focus()}if(b){h.normalize()}}if(a&&a.ownerDocument==j){e=j.body.createControlRange();e.addElement(a);e.select()}}if(n.activeEditor!=g){if((d=n.activeEditor)!=null){d.onDeactivate.dispatch(d,g)}g.onActivate.dispatch(g,d)}n._setActive(g)},execCallback:function(b){var a=this,c=a.settings[b],d;if(!c){return}if(a.callbackLookup&&(d=a.callbackLookup[b])){c=d.func;d=d.scope}if(v(c,"string")){d=c.replace(/\.\w+$/,"");d=d?n.resolve(d):0;c=n.resolve(c);a.callbackLookup=a.callbackLookup||{};a.callbackLookup[b]={func:c,scope:d}}return c.apply(d||a,Array.prototype.slice.call(arguments,1))},translate:function(a){var b=this.settings.language||"en",c=n.i18n;if(!a){return""}return c[b+"."+a]||a.replace(/\{\#([^\}]+)\}/g,function(d,e){return c[b+"."+e]||"{#"+e+"}"})},getLang:function(b,a){return n.i18n[(this.settings.language||"en")+"."+b]||(v(a)?a:"{#"+b+"}")},getParam:function(b,e,a){var d=n.trim,f=v(this.settings[b])?this.settings[b]:e,c;if(a==="hash"){c={};if(v(f,"string")){p(f.indexOf("=")>0?f.split(/[;,](?![^=;,]*(?:[;,]|$))/):f.split(","),function(g){g=g.split("=");if(g.length>1){c[d(g[0])]=d(g[1])}else{c[d(g[0])]=d(g)}})}else{c=f}return c}return f},nodeChanged:function(b){var a=this,d=a.selection,c;if(a.initialized){b=b||{};d.normalize();c=d.getStart()||a.getBody();c=y&&c.ownerDocument!=a.getDoc()?a.getBody():c;b.parents=[];a.dom.getParent(c,function(e){if(e.nodeName=="BODY"){return true}b.parents.push(e)});a.onNodeChange.dispatch(a,b?b.controlManager||a.controlManager:a.controlManager,c,d.isCollapsed(),b)}},addButton:function(c,b){var a=this;a.buttons=a.buttons||{};a.buttons[c]=b},addCommand:function(a,b,c){this.execCommands[a]={func:b,scope:c||this}},addQueryStateHandler:function(a,b,c){this.queryStateCommands[a]={func:b,scope:c||this}},addQueryValueHandler:function(a,b,c){this.queryValueCommands[a]={func:b,scope:c||this}},addShortcut:function(e,c,a,d){var f=this,b;if(f.settings.custom_shortcuts===false){return false}f.shortcuts=f.shortcuts||{};if(v(a,"string")){b=a;a=function(){f.execCommand(b,false,null)}}if(v(a,"object")){b=a;a=function(){f.execCommand(b[0],b[1],b[2])}}p(r(e),function(h){var g={func:a,scope:d||this,desc:f.translate(c),alt:false,ctrl:false,shift:false};p(r(h,"+"),function(j){switch(j){case"alt":case"ctrl":case"shift":g[j]=true;break;default:g.charCode=j.charCodeAt(0);g.keyCode=j.toUpperCase().charCodeAt(0)}});f.shortcuts[(g.ctrl?"ctrl":"")+","+(g.alt?"alt":"")+","+(g.shift?"shift":"")+","+g.keyCode]=g});return true},execCommand:function(d,e,b,a){var g=this,f=0,c,h;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(d)&&(!a||!a.skip_focus)){g.focus()}a=s({},a);g.onBeforeExecCommand.dispatch(g,d,e,b,a);if(a.terminate){return false}if(g.execCallback("execcommand_callback",g.id,g.selection.getNode(),d,e,b)){g.onExecCommand.dispatch(g,d,e,b,a);return true}if(c=g.execCommands[d]){h=c.func.call(c.scope,e,b);if(h!==true){g.onExecCommand.dispatch(g,d,e,b,a);return h}}p(g.plugins,function(j){if(j.execCommand&&j.execCommand(d,e,b)){g.onExecCommand.dispatch(g,d,e,b,a);f=1;return false}});if(f){return true}if(g.theme&&g.theme.execCommand&&g.theme.execCommand(d,e,b)){g.onExecCommand.dispatch(g,d,e,b,a);return true}if(g.editorCommands.execCommand(d,e,b)){g.onExecCommand.dispatch(g,d,e,b,a);return true}g.getDoc().execCommand(d,e,b);g.onExecCommand.dispatch(g,d,e,b,a)},queryCommandState:function(c){var e=this,b,d;if(e._isHidden()){return}if(b=e.queryStateCommands[c]){d=b.func.call(b.scope);if(d!==true){return d}}b=e.editorCommands.queryCommandState(c);if(b!==-1){return b}try{return this.getDoc().queryCommandState(c)}catch(a){}},queryCommandValue:function(b){var e=this,c,d;if(e._isHidden()){return}if(c=e.queryValueCommands[b]){d=c.func.call(c.scope);if(d!==true){return d}}c=e.editorCommands.queryCommandValue(b);if(v(c)){return c}try{return this.getDoc().queryCommandValue(b)}catch(a){}},show:function(){var a=this;m.show(a.getContainer());m.hide(a.id);a.load()},hide:function(){var a=this,b=t.getDoc();if(y&&b){b.execCommand("SelectAll")}a.save();m.hide(a.getContainer());m.setStyle(a.id,"display",a.orgDisplay)},isHidden:function(){return !m.isHidden(this.id)},setProgressState:function(a,c,b){this.onSetProgressState.dispatch(this,a,c,b);return a},load:function(b){var a=this,c=a.getElement(),d;if(c){b=b||{};b.load=true;d=a.setContent(v(c.value)?c.value:c.innerHTML,b);b.element=c;if(!b.no_events){a.onLoadContent.dispatch(a,b)}b.element=c=null;return d}},save:function(b){var a=this,c=a.getElement(),e,d;if(!c||!a.initialized){return}b=b||{};b.save=true;b.element=c;e=b.content=a.getContent(b);if(!b.no_events){a.onSaveContent.dispatch(a,b)}e=b.content;if(!/TEXTAREA|INPUT/i.test(c.nodeName)){c.innerHTML=e;if(d=m.getParent(a.id,"form")){p(d.elements,function(f){if(f.name==a.id){f.value=e;return false}})}}else{c.value=e}b.element=c=null;return e},setContent:function(b,d){var e=this,f,a=e.getBody(),c;d=d||{};d.format=d.format||"html";d.set=true;d.content=b;if(!d.no_events){e.onBeforeSetContent.dispatch(e,d)}b=d.content;if(!n.isIE&&(b.length===0||/^\s+$/.test(b))){c=e.settings.forced_root_block;if(c){b="<"+c+'><br data-mce-bogus="1"></'+c+">"}else{b='<br data-mce-bogus="1">'}a.innerHTML=b;e.selection.select(a,true);e.selection.collapse(true);return}if(d.format!=="raw"){b=new n.html.Serializer({},e.schema).serialize(e.parser.parse(b))}d.content=n.trim(b);e.dom.setHTML(a,d.content);if(!d.no_events){e.onSetContent.dispatch(e,d)}e.selection.normalize();return d.content},getContent:function(c){var a=this,b;c=c||{};c.format=c.format||"html";c.get=true;c.getInner=true;if(!c.no_events){a.onBeforeGetContent.dispatch(a,c)}if(c.format=="raw"){b=a.getBody().innerHTML}else{b=a.serializer.serialize(a.getBody(),c)}c.content=n.trim(b);if(!c.no_events){a.onGetContent.dispatch(a,c)}return c.content},isDirty:function(){var a=this;return n.trim(a.startContent)!=n.trim(a.getContent({format:"raw",no_events:1}))&&!a.isNotDirty},getContainer:function(){var a=this;if(!a.container){a.container=m.get(a.editorContainer||a.id+"_parent")}return a.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return m.get(this.settings.content_element||this.id)},getWin:function(){var a=this,b;if(!a.contentWindow){b=m.get(a.id+"_ifr");if(b){a.contentWindow=b.contentWindow}}return a.contentWindow},getDoc:function(){var a=this,b;if(!a.contentDocument){b=a.getWin();if(b){a.contentDocument=b.document}}return a.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(d,e,b){var a=this,c=a.settings;if(c.urlconverter_callback){return a.execCallback("urlconverter_callback",d,b,true,e)}if(!c.convert_urls||(b&&b.nodeName=="LINK")||d.indexOf("file:")===0){return d}if(c.relative_urls){return a.documentBaseURI.toRelative(d)}d=a.documentBaseURI.toAbsolute(d,c.remove_script_host);return d},addVisual:function(b){var e=this,d=e.settings,c=e.dom,a;b=b||e.getBody();if(!v(e.hasVisual)){e.hasVisual=d.visual}p(c.select("table,a",b),function(f){var g;switch(f.nodeName){case"TABLE":a=d.visual_table_class||"mceItemTable";g=c.getAttrib(f,"border");if(!g||g=="0"){if(e.hasVisual){c.addClass(f,a)}else{c.removeClass(f,a)}}return;case"A":g=c.getAttrib(f,"name");a="mceItemAnchor";if(g){if(e.hasVisual){c.addClass(f,a)}else{c.removeClass(f,a)}}return}});e.onVisualAid.dispatch(e,b,e.hasVisual)},remove:function(){var a=this,b=a.getContainer();if(!a.removed){a.removed=1;a.hide();if(!a.settings.content_editable){o.clear(a.getWin());o.clear(a.getDoc())}o.clear(a.getBody());o.clear(a.formElement);o.unbind(b);a.execCallback("remove_instance_callback",a);a.onRemove.dispatch(a);a.onExecCommand.listeners=[];n.remove(a);m.remove(b)}},destroy:function(b){var a=this;if(a.destroyed){return}if(z){o.unbind(a.getDoc());o.unbind(a.getWin());o.unbind(a.getBody())}if(!b){n.removeUnload(a.destroy);tinyMCE.onBeforeUnload.remove(a._beforeUnload);if(a.theme&&a.theme.destroy){a.theme.destroy()}a.controlManager.destroy();a.selection.destroy();a.dom.destroy()}if(a.formElement){a.formElement.submit=a.formElement._mceOldSubmit;a.formElement._mceOldSubmit=null}a.contentAreaContainer=a.formElement=a.container=a.settings.content_element=a.bodyElement=a.contentDocument=a.contentWindow=null;if(a.selection){a.selection=a.selection.win=a.selection.dom=a.selection.dom.doc=null}a.destroyed=1},_refreshContentEditable:function(){var c=this,a,b;if(c._isHidden()){a=c.getBody();b=a.parentNode;b.removeChild(a);b.appendChild(a);a.focus()}},_isHidden:function(){var a;if(!z){return 0}a=this.selection.getSel();return(!a||!a.rangeCount||a.rangeCount===0)}})})(tinymce);(function(d){var c=d.each;d.Editor.prototype.setupEvents=function(){var b=this,a=b.settings;c(["onPreInit","onBeforeRenderUI","onPostRender","onLoad","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp","onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent","onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState","onSetAttrib"],function(f){b[f]=new d.util.Dispatcher(b)});if(a.cleanup_callback){b.onBeforeSetContent.add(function(h,g){g.content=h.execCallback("cleanup_callback","insert_to_editor",g.content,g)});b.onPreProcess.add(function(h,g){if(g.set){h.execCallback("cleanup_callback","insert_to_editor_dom",g.node,g)}if(g.get){h.execCallback("cleanup_callback","get_from_editor_dom",g.node,g)}});b.onPostProcess.add(function(h,g){if(g.set){g.content=h.execCallback("cleanup_callback","insert_to_editor",g.content,g)}if(g.get){g.content=h.execCallback("cleanup_callback","get_from_editor",g.content,g)}})}if(a.save_callback){b.onGetContent.add(function(h,g){if(g.save){g.content=h.execCallback("save_callback",h.id,g.content,h.getBody())}})}if(a.handle_event_callback){b.onEvent.add(function(k,j,e){if(b.execCallback("handle_event_callback",j,k,e)===false){Event.cancel(j)}})}if(a.handle_node_change_callback){b.onNodeChange.add(function(j,k,h){j.execCallback("handle_node_change_callback",j.id,h,-1,-1,true,j.selection.isCollapsed())})}if(a.save_callback){b.onSaveContent.add(function(k,h){var j=k.execCallback("save_callback",k.id,h.content,k.getBody());if(j){h.content=j}})}if(a.onchange_callback){b.onChange.add(function(g,h){g.execCallback("onchange_callback",g,h)})}};d.Editor.prototype.bindNativeEvents=function(){var q=this,n,m=q.settings,b=q.dom,a;a={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};function o(g,f){var e=g.type;if(q.removed){return}if(q.onEvent.dispatch(q,g,f)!==false){q[a[g.fakeType||g.type]].dispatch(q,g,f)}}function l(e){q.focus(true)}c(a,function(f,e){var g=m.content_editable?q.getBody():q.getDoc();switch(e){case"contextmenu":b.bind(g,e,o);break;case"paste":b.bind(q.getBody(),e,o);break;case"submit":case"reset":b.bind(q.getElement().form||d.DOM.getParent(q.id,"form"),e,o);break;default:b.bind(g,e,o)}});b.bind(m.content_editable?q.getBody():(d.isGecko?q.getDoc():q.getWin()),"focus",function(e){q.focus(true)});if(m.content_editable&&d.isOpera){b.bind(q.getBody(),"click",l);b.bind(q.getBody(),"keydown",l)}q.onMouseUp.add(q.nodeChanged);q.onKeyUp.add(function(g,e){var f=e.keyCode;if((f>=33&&f<=36)||(f>=37&&f<=40)||f==13||f==45||f==46||f==8||(d.isMac&&(f==91||f==93))||e.ctrlKey){q.nodeChanged()}});q.onReset.add(function(){q.setContent(q.startContent,{format:"raw"})});function p(e,f){if(e.altKey||e.ctrlKey||e.metaKey){c(q.shortcuts,function(g){var h=d.isMac?e.metaKey:e.ctrlKey;if(g.ctrl!=h||g.alt!=e.altKey||g.shift!=e.shiftKey){return}if(e.keyCode==g.keyCode||(e.charCode&&e.charCode==g.charCode)){e.preventDefault();if(f){g.func.call(g.scope)}return true}})}}q.onKeyUp.add(function(f,e){p(e)});q.onKeyPress.add(function(f,e){p(e)});q.onKeyDown.add(function(f,e){p(e,true)});if(d.isOpera){q.onClick.add(function(f,e){e.preventDefault()})}}})(tinymce);(function(j){var h=j.each,f,g=true,k=false;j.EditorCommands=function(e){var x=e.dom,c=e.selection,A={state:{},exec:{},value:{}},z=e.settings,b=e.formatter,d;function a(m,n,o){var l;m=m.toLowerCase();if(l=A.exec[m]){l(m,n,o);return g}return k}function y(m){var l;m=m.toLowerCase();if(l=A.state[m]){return l(m)}return -1}function C(m){var l;m=m.toLowerCase();if(l=A.value[m]){return l(m)}return k}function F(l,m){m=m||"exec";h(l,function(n,o){h(o.toLowerCase().split(","),function(p){A[m][p]=n})})}j.extend(this,{execCommand:a,queryCommandState:y,queryCommandValue:C,addCommands:F});function E(m,n,l){if(n===f){n=k}if(l===f){l=null}return e.getDoc().execCommand(m,n,l)}function G(l){return b.match(l)}function H(l,m){b.toggle(l,m?{value:m}:f)}function B(l){d=c.getBookmark(l)}function D(){c.moveToBookmark(d)}F({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(m){var n=e.getDoc(),l;try{E(m)}catch(o){l=g}if(l||!n.queryCommandSupported(m)){if(j.isGecko){e.windowManager.confirm(e.getLang("clipboard_msg"),function(p){if(p){open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")}})}else{e.windowManager.alert(e.getLang("clipboard_no_support"))}}},unlink:function(l){if(c.isCollapsed()){c.select(c.getNode())}E(l);c.collapse(k)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(l){var m=l.substring(7);h("left,center,right,full".split(","),function(n){if(m!=n){b.remove("align"+n)}});H("align"+m);a("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(m){var l,n;E(m);l=x.getParent(c.getNode(),"ol,ul");if(l){n=l.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(n.nodeName)){B();x.split(n,l);D()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(l){H(l)},"ForeColor,HiliteColor,FontName":function(m,n,l){H(m,l)},FontSize:function(m,n,p){var l,o;if(p>=1&&p<=7){o=j.explode(z.font_size_style_values);l=j.explode(z.font_size_classes);if(l){p=l[p-1]||p}else{p=o[p-1]||p}}H(m,p)},RemoveFormat:function(l){b.remove(l)},mceBlockQuote:function(l){H("blockquote")},FormatBlock:function(m,n,l){return H(l||"p")},mceCleanup:function(){var l=c.getBookmark();e.setContent(e.getContent({cleanup:g}),{cleanup:g});c.moveToBookmark(l)},mceRemoveNode:function(m,n,o){var l=o||c.getNode();if(l!=e.getBody()){B();e.dom.remove(l,g);D()}},mceSelectNodeDepth:function(m,n,o){var l=0;x.getParent(c.getNode(),function(p){if(p.nodeType==1&&l++==o){c.select(p);return k}},e.getBody())},mceSelectNode:function(m,n,l){c.select(l)},mceInsertContent:function(m,P,s){var r,v,T,o,S,R,U,l,q,u,n,p,O,Q;r=e.parser;v=new j.html.Serializer({},e.schema);O='<span id="mce_marker" data-mce-type="bookmark">\uFEFF</span>';R={content:s,format:"html"};c.onBeforeSetContent.dispatch(c,R);s=R.content;if(s.indexOf("{$caret}")==-1){s+="{$caret}"}s=s.replace(/\{\$caret\}/,O);if(!c.isCollapsed()){e.getDoc().execCommand("Delete",false,null)}T=c.getNode();R={context:T.nodeName.toLowerCase()};S=r.parse(s,R);n=S.lastChild;if(n.attr("id")=="mce_marker"){U=n;for(n=n.prev;n;n=n.walk(true)){if(n.type==3||!x.isBlock(n.name)){n.parent.insert(U,n,n.name==="br");break}}}if(!R.invalid){s=v.serialize(S);n=T.firstChild;p=T.lastChild;if(!n||(n===p&&n.nodeName==="BR")){x.setHTML(T,s)}else{c.setContent(s)}}else{c.setContent(O);T=e.selection.getNode();o=e.getBody();if(T.nodeType==9){T=n=o}else{n=T}while(n!==o){T=n;n=n.parentNode}s=T==o?o.innerHTML:x.getOuterHTML(T);s=v.serialize(r.parse(s.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return v.serialize(S)})));if(T==o){x.setHTML(o,s)}else{x.setOuterHTML(T,s)}}U=x.get("mce_marker");l=x.getRect(U);q=x.getViewPort(e.getWin());if((l.y+l.h>q.y+q.h||l.y<q.y)||(l.x>q.x+q.w||l.x<q.x)){Q=j.isIE?e.getDoc().documentElement:e.getBody();Q.scrollLeft=l.x;Q.scrollTop=l.y-q.h+25}u=x.createRng();n=U.previousSibling;if(n&&n.nodeType==3){u.setStart(n,n.nodeValue.length)}else{u.setStartBefore(U);u.setEndBefore(U)}x.remove(U);c.setRng(u);c.onSetContent.dispatch(c,R);e.addVisual()},mceInsertRawHTML:function(m,n,l){c.setContent("tiny_mce_marker");e.setContent(e.getContent().replace(/tiny_mce_marker/g,function(){return l}))},mceSetContent:function(m,n,l){e.setContent(l)},"Indent,Outdent":function(m){var o,l,n;o=z.indentation;l=/[a-z%]+$/i.exec(o);o=parseInt(o);if(!y("InsertUnorderedList")&&!y("InsertOrderedList")){if(!z.forced_root_block&&!x.getParent(c.getNode(),x.isBlock)){b.apply("div")}h(c.getSelectedBlocks(),function(p){if(m=="outdent"){n=Math.max(0,parseInt(p.style.paddingLeft||0)-o);x.setStyle(p,"paddingLeft",n?n+l:"")}else{x.setStyle(p,"paddingLeft",(parseInt(p.style.paddingLeft||0)+o)+l)}})}else{E(m)}},mceRepaint:function(){var m;if(j.isGecko){try{B(g);if(c.getSel()){c.getSel().selectAllChildren(e.getBody())}c.collapse(g);D()}catch(l){}}},mceToggleFormat:function(m,n,l){b.toggle(l)},InsertHorizontalRule:function(){e.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual;e.addVisual()},mceReplaceContent:function(m,n,l){e.execCommand("mceInsertContent",false,l.replace(/\{\$selection\}/g,c.getContent({format:"text"})))},mceInsertLink:function(m,n,o){var l;if(typeof(o)=="string"){o={href:o}}l=x.getParent(c.getNode(),"a");o.href=o.href.replace(" ","%20");if(!l||!o.href){b.remove("link")}if(o.href){b.apply("link",o,l)}},selectAll:function(){var m=x.getRoot(),l=x.createRng();l.setStart(m,0);l.setEnd(m,m.childNodes.length);e.selection.setRng(l)}});F({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(m){var o="align"+m.substring(7);var l=c.isCollapsed()?[c.getNode()]:c.getSelectedBlocks();var n=j.map(l,function(p){return !!b.matchNode(p,o)});return j.inArray(n,g)!==-1},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(l){return G(l)},mceBlockQuote:function(){return G("blockquote")},Outdent:function(){var l;if(z.inline_styles){if((l=x.getParent(c.getStart(),x.isBlock))&&parseInt(l.style.paddingLeft)>0){return g}if((l=x.getParent(c.getEnd(),x.isBlock))&&parseInt(l.style.paddingLeft)>0){return g}}return y("InsertUnorderedList")||y("InsertOrderedList")||(!z.inline_styles&&!!x.getParent(c.getNode(),"BLOCKQUOTE"))},"InsertUnorderedList,InsertOrderedList":function(l){return x.getParent(c.getNode(),l=="insertunorderedlist"?"UL":"OL")}},"state");F({"FontSize,FontName":function(m){var n=0,l;if(l=x.getParent(c.getNode(),"span")){if(m=="fontsize"){n=l.style.fontSize}else{n=l.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()}}return n}},"value");F({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}})}})(tinymce);(function(c){var d=c.util.Dispatcher;c.UndoManager=function(o){var a,n=0,r=[],p,b,m,q;function u(){return c.trim(o.getContent({format:"raw",no_events:1}).replace(/<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\/span>/g,""))}function s(){a.typing=false;a.add()}b=new d(a);m=new d(a);q=new d(a);b.add(function(e,f){if(e.hasUndo()){return o.onChange.dispatch(o,f,e)}});m.add(function(e,f){return o.onUndo.dispatch(o,f,e)});q.add(function(e,f){return o.onRedo.dispatch(o,f,e)});o.onInit.add(function(){a.add()});o.onBeforeExecCommand.add(function(e,g,h,f,j){if(g!="Undo"&&g!="Redo"&&g!="mceRepaint"&&(!j||!j.skip_undo)){a.beforeChange()}});o.onExecCommand.add(function(e,g,h,f,j){if(g!="Undo"&&g!="Redo"&&g!="mceRepaint"&&(!j||!j.skip_undo)){a.add()}});o.onSaveContent.add(s);o.dom.bind(o.dom.getRoot(),"dragend",s);o.dom.bind(o.getDoc(),c.isGecko?"blur":"focusout",function(e){if(!o.removed&&a.typing){s()}});o.onKeyUp.add(function(e,f){var g=f.keyCode;if((g>=33&&g<=36)||(g>=37&&g<=40)||g==45||g==13||f.ctrlKey){s()}});o.onKeyDown.add(function(e,f){var g=f.keyCode;if((g>=33&&g<=36)||(g>=37&&g<=40)||g==45){if(a.typing){s()}return}if((g<16||g>20)&&g!=224&&g!=91&&!a.typing){a.beforeChange();a.typing=true;a.add()}});o.onMouseDown.add(function(e,f){if(a.typing){s()}});o.addShortcut("ctrl+z","undo_desc","Undo");o.addShortcut("ctrl+y","redo_desc","Redo");a={data:r,typing:false,onAdd:b,onUndo:m,onRedo:q,beforeChange:function(){p=o.selection.getBookmark(2,true)},add:function(f){var e,h=o.settings,g;f=f||{};f.content=u();g=r[n];if(g&&g.content==f.content){return null}if(r[n]){r[n].beforeBookmark=p}if(h.custom_undo_redo_levels){if(r.length>h.custom_undo_redo_levels){for(e=0;e<r.length-1;e++){r[e]=r[e+1]}r.length--;n=r.length}}f.bookmark=o.selection.getBookmark(2,true);if(n<r.length-1){r.length=n+1}r.push(f);n=r.length-1;a.onAdd.dispatch(a,f);o.isNotDirty=0;return f},undo:function(){var f,e;if(a.typing){a.add();a.typing=false}if(n>0){f=r[--n];o.setContent(f.content,{format:"raw"});o.selection.moveToBookmark(f.beforeBookmark);a.onUndo.dispatch(a,f)}return f},redo:function(){var e;if(n<r.length-1){e=r[++n];o.setContent(e.content,{format:"raw"});o.selection.moveToBookmark(e.bookmark);a.onRedo.dispatch(a,e)}return e},clear:function(){r=[];n=0;a.typing=false},hasUndo:function(){return n>0||this.typing},hasRedo:function(){return n<r.length-1&&!this.typing}};return a}})(tinymce);tinymce.ForceBlocks=function(m){var g=m.settings,k=m.dom,h=m.selection,l=m.schema.getBlockElements();function j(){var s=h.getStart(),v=m.getBody(),x,r,c,a,b,u,f,e=-16777215;if(!s||s.nodeType!==1||!g.forced_root_block){return}while(s!=v){if(l[s.nodeName]){return}s=s.parentNode}x=h.getRng();if(x.setStart){r=x.startContainer;c=x.startOffset;a=x.endContainer;b=x.endOffset}else{if(x.item){s=x.item(0);x=m.getDoc().body.createTextRange();x.moveToElementText(s)}tmpRng=x.duplicate();tmpRng.collapse(true);c=tmpRng.move("character",e)*-1;if(!tmpRng.collapsed){tmpRng=x.duplicate();tmpRng.collapse(false);b=(tmpRng.move("character",e)*-1)-c}}s=v.firstChild;while(s){if(s.nodeType===3||(s.nodeType==1&&!l[s.nodeName])){if(!u){u=k.create(g.forced_root_block);s.parentNode.insertBefore(u,s)}f=s;s=s.nextSibling;u.appendChild(f)}else{u=null;s=s.nextSibling}}if(x.setStart){x.setStart(r,c);x.setEnd(a,b);h.setRng(x)}else{try{x=m.getDoc().body.createTextRange();x.moveToElementText(v);x.collapse(true);x.moveStart("character",c);if(b>0){x.moveEnd("character",b)}x.select()}catch(d){}}m.nodeChanged()}if(g.forced_root_block){m.onKeyUp.add(j);m.onClick.add(j)}};(function(k){var f=k.DOM,g=k.dom.Event,j=k.each,h=k.extend;k.create("tinymce.ControlManager",{ControlManager:function(d,a){var b=this,c;a=a||{};b.editor=d;b.controls={};b.onAdd=new k.util.Dispatcher(b);b.onPostRender=new k.util.Dispatcher(b);b.prefix=a.prefix||d.id+"_";b._cls={};b.onPostRender.add(function(){j(b.controls,function(e){e.postRender()})})},get:function(a){return this.controls[this.prefix+a]||this.controls[a]},setActive:function(a,c){var b=null;if(b=this.get(a)){b.setActive(c)}return b},setDisabled:function(a,c){var b=null;if(b=this.get(a)){b.setDisabled(c)}return b},add:function(a){var b=this;if(a){b.controls[a.id]=a;b.onAdd.dispatch(a,b)}return a},createControl:function(a){var b,c=this,d=c.editor;j(d.plugins,function(e){if(e.createControl){b=e.createControl(a,c);if(b){return false}}});switch(a){case"|":case"separator":return c.createSeparator()}if(!b&&d.buttons&&(b=d.buttons[a])){return c.createButton(a,b)}return c.add(b)},createDropMenu:function(r,a,p){var b=this,o=b.editor,e,q,d,c;a=h({"class":"mceDropDown",constrain:o.settings.constrain_menus},a);a["class"]=a["class"]+" "+o.getParam("skin")+"Skin";if(d=o.getParam("skin_variant")){a["class"]+=" "+o.getParam("skin")+"Skin"+d.substring(0,1).toUpperCase()+d.substring(1)}r=b.prefix+r;c=p||b._cls.dropmenu||k.ui.DropMenu;e=b.controls[r]=new c(r,a);e.onAddItem.add(function(l,m){var n=m.settings;n.title=o.getLang(n.title,n.title);if(!n.onclick){n.onclick=function(s){if(n.cmd){o.execCommand(n.cmd,n.ui||false,n.value)}}}});o.onRemove.add(function(){e.destroy()});if(k.isIE){e.onShowMenu.add(function(){o.focus();q=o.selection.getBookmark(1)});e.onHideMenu.add(function(){if(q){o.selection.moveToBookmark(q);q=0}})}return b.add(e)},createListBox:function(r,a,p){var c=this,e=c.editor,o,d,b;if(c.get(r)){return null}a.title=e.translate(a.title);a.scope=a.scope||e;if(!a.onselect){a.onselect=function(l){e.execCommand(a.cmd,a.ui||false,l||a.value)}}a=h({title:a.title,"class":"mce_"+r,scope:a.scope,control_manager:c},a);r=c.prefix+r;function q(l){return l.settings.use_accessible_selects&&!k.isGecko}if(e.settings.use_native_selects||q(e)){d=new k.ui.NativeListBox(r,a)}else{b=p||c._cls.listbox||k.ui.ListBox;d=new b(r,a,e)}c.controls[r]=d;if(k.isWebKit){d.onPostRender.add(function(l,m){g.add(m,"mousedown",function(){e.bookmark=e.selection.getBookmark(1)});g.add(m,"focus",function(){e.selection.moveToBookmark(e.bookmark);e.bookmark=null})})}if(d.hideMenu){e.onMouseDown.add(d.hideMenu,d)}return c.add(d)},createButton:function(a,e,b){var n=this,o=n.editor,d,c,p;if(n.get(a)){return null}e.title=o.translate(e.title);e.label=o.translate(e.label);e.scope=e.scope||o;if(!e.onclick&&!e.menu_button){e.onclick=function(){o.execCommand(e.cmd,e.ui||false,e.value)}}e=h({title:e.title,"class":"mce_"+a,unavailable_prefix:o.getLang("unavailable",""),scope:e.scope,control_manager:n},e);a=n.prefix+a;if(e.menu_button){p=b||n._cls.menubutton||k.ui.MenuButton;c=new p(a,e,o);o.onMouseDown.add(c.hideMenu,c)}else{p=n._cls.button||k.ui.Button;c=new p(a,e,o)}return n.add(c)},createMenuButton:function(a,c,b){c=c||{};c.menu_button=1;return this.createButton(a,c,b)},createSplitButton:function(a,e,b){var n=this,o=n.editor,d,c,p;if(n.get(a)){return null}e.title=o.translate(e.title);e.scope=e.scope||o;if(!e.onclick){e.onclick=function(l){o.execCommand(e.cmd,e.ui||false,l||e.value)}}if(!e.onselect){e.onselect=function(l){o.execCommand(e.cmd,e.ui||false,l||e.value)}}e=h({title:e.title,"class":"mce_"+a,scope:e.scope,control_manager:n},e);a=n.prefix+a;p=b||n._cls.splitbutton||k.ui.SplitButton;c=n.add(new p(a,e,o));o.onMouseDown.add(c.hideMenu,c);return c},createColorSplitButton:function(r,a,p){var c=this,e=c.editor,o,d,b,q;if(c.get(r)){return null}a.title=e.translate(a.title);a.scope=a.scope||e;if(!a.onclick){a.onclick=function(l){if(k.isIE){q=e.selection.getBookmark(1)}e.execCommand(a.cmd,a.ui||false,l||a.value)}}if(!a.onselect){a.onselect=function(l){e.execCommand(a.cmd,a.ui||false,l||a.value)}}a=h({title:a.title,"class":"mce_"+r,menu_class:e.getParam("skin")+"Skin",scope:a.scope,more_colors_title:e.getLang("more_colors")},a);r=c.prefix+r;b=p||c._cls.colorsplitbutton||k.ui.ColorSplitButton;d=new b(r,a,e);e.onMouseDown.add(d.hideMenu,d);e.onRemove.add(function(){d.destroy()});if(k.isIE){d.onShowMenu.add(function(){e.focus();q=e.selection.getBookmark(1)});d.onHideMenu.add(function(){if(q){e.selection.moveToBookmark(q);q=0}})}return c.add(d)},createToolbar:function(a,d,b){var c,e=this,l;a=e.prefix+a;l=b||e._cls.toolbar||k.ui.Toolbar;c=new l(a,d,e.editor);if(e.get(a)){return null}return e.add(c)},createToolbarGroup:function(a,d,b){var c,e=this,l;a=e.prefix+a;l=b||this._cls.toolbarGroup||k.ui.ToolbarGroup;c=new l(a,d,e.editor);if(e.get(a)){return null}return e.add(c)},createSeparator:function(a){var b=a||this._cls.separator||k.ui.Separator;return new b()},setControlType:function(a,b){return this._cls[a.toLowerCase()]=b},destroy:function(){j(this.controls,function(a){a.destroy()});this.controls=null}})})(tinymce);(function(j){var g=j.util.Dispatcher,h=j.each,k=j.isIE,f=j.isOpera;j.create("tinymce.WindowManager",{WindowManager:function(b){var a=this;a.editor=b;a.onOpen=new g(a);a.onClose=new g(a);a.params={};a.features={}},open:function(B,y){var C=this,s="",d,e,x=C.editor.settings.dialog_type=="modal",b,c,u,A=j.DOM.getViewPort(),a;B=B||{};y=y||{};c=f?A.w:screen.width;u=f?A.h:screen.height;B.name=B.name||"mc_"+new Date().getTime();B.width=parseInt(B.width||320);B.height=parseInt(B.height||240);B.resizable=true;B.left=B.left||parseInt(c/2)-(B.width/2);B.top=B.top||parseInt(u/2)-(B.height/2);y.inline=false;y.mce_width=B.width;y.mce_height=B.height;y.mce_auto_focus=B.auto_focus;if(x){if(k){B.center=true;B.help=false;B.dialogWidth=B.width+"px";B.dialogHeight=B.height+"px";B.scroll=B.scrollbars||false}}h(B,function(m,l){if(j.is(m,"boolean")){m=m?"yes":"no"}if(!/^(name|url)$/.test(l)){if(k&&x){s+=(s?";":"")+l+":"+m}else{s+=(s?",":"")+l+"="+m}}});C.features=B;C.params=y;C.onOpen.dispatch(C,B,y);a=B.url||B.file;a=j._addVer(a);try{if(k&&x){b=1;window.showModalDialog(a,window,s)}else{b=window.open(a,B.name,s)}}catch(p){}if(!b){alert(C.editor.getLang("popup_blocked"))}},close:function(a){a.close();this.onClose.dispatch(this)},createInstance:function(e,n,o,a,b,c){var d=j.resolve(e);return new d(n,o,a,b,c)},confirm:function(b,d,a,c){c=c||window;d.call(a||this,c.confirm(this._decode(this.editor.getLang(b,b))))},alert:function(c,e,a,d){var b=this;d=d||window;d.alert(b._decode(b.editor.getLang(c,c)));if(e){e.call(a||b)}},resizeBy:function(c,b,a){a.resizeBy(c,b)},_decode:function(a){return j.DOM.decode(a).replace(/\\n/g,"\n")}})}(tinymce));(function(b){b.Formatter=function(a){var aj={},ag=b.each,aV=a.dom,aG=a.selection,aE=b.dom.TreeWalker,al=new b.dom.RangeUtils(aV),aU=a.schema.isValidChild,aq=aV.isBlock,aL=a.settings.forced_root_block,aF=aV.nodeIndex,ar=b.isGecko?"\u200B":"\uFEFF",aT=/^(src|href|style)$/,ac=false,aw=true,av,aB=aV.getContentEditable;function ay(c){return c instanceof Array}function aK(c,d){return aV.getParents(c,d,aV.getRoot())}function aW(c){return c.nodeType===1&&c.id==="_mce_caret"}function aO(){aM({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"right"}}],alignfull:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:false},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(c){return true},onformat:function(c,e,d){ag(d,function(f,g){aV.setAttrib(c,g,f)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});ag("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(c){aM(c,{block:c,remove:"all"})});aM(a.settings.formats)}function ad(){a.addShortcut("ctrl+b","bold_desc","Bold");a.addShortcut("ctrl+i","italic_desc","Italic");a.addShortcut("ctrl+u","underline_desc","Underline");for(var c=1;c<=6;c++){a.addShortcut("ctrl+"+c,"",["FormatBlock",false,"h"+c])}a.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);a.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);a.addShortcut("ctrl+9","",["FormatBlock",false,"address"])}function ae(c){return c?aj[c]:aj}function aM(d,c){if(d){if(typeof(d)!=="string"){ag(d,function(e,f){aM(f,e)})}else{c=c.length?c:[c];ag(c,function(e){if(e.deep===av){e.deep=!e.selector}if(e.split===av){e.split=!e.selector||e.inline}if(e.remove===av&&e.selector&&!e.inline){e.remove="none"}if(e.selector&&e.inline){e.mixed=true;e.block_expand=true}if(typeof(e.classes)==="string"){e.classes=e.classes.split(/\s+/)}});aj[d]=c}}}var aP=function(c){var d;a.dom.getParent(c,function(e){d=a.dom.getStyle(e,"text-decoration");return d&&d!=="none"});return d};var an=function(d){var c;if(d.nodeType===1&&d.parentNode&&d.parentNode.nodeType===1){c=aP(d.parentNode);if(a.dom.getStyle(d,"color")&&c){a.dom.setStyle(d,"text-decoration",c)}else{if(a.dom.getStyle(d,"textdecoration")===c){a.dom.setStyle(d,"text-decoration",null)}}}};function ab(o,g,m){var l=ae(o),f=l[0],h,q,j,k=aG.isCollapsed();function c(r,s){s=s||f;if(r){if(s.onformat){s.onformat(r,s,g,m)}ag(s.styles,function(u,v){aV.setStyle(r,v,aH(u,g))});ag(s.attributes,function(u,v){aV.setAttrib(r,v,aH(u,g))});ag(s.classes,function(u){u=aH(u,g);if(!aV.hasClass(r,u)){aV.addClass(r,u)}})}}function n(){function u(z,B){var A=new aE(B);for(m=A.current();m;m=A.prev()){if(m.childNodes.length>1||m==z||m.tagName=="BR"){return m}}}var v=a.selection.getRng();var y=v.startContainer;var x=v.endContainer;if(y!=x&&v.endOffset===0){var r=u(y,x);var s=r.nodeType==3?r.length:r.childNodes.length;v.setEnd(r,s)}return v}function p(y,r,u,v,A){var B=[],z=-1,s,C=-1,x=-1,D;ag(y.childNodes,function(E,F){if(E.nodeName==="UL"||E.nodeName==="OL"){z=F;s=E;return false}});ag(y.childNodes,function(E,F){if(E.nodeName==="SPAN"&&aV.getAttrib(E,"data-mce-type")=="bookmark"){if(E.id==r.id+"_start"){C=F}else{if(E.id==r.id+"_end"){x=F}}}});if(z<=0||(C<z&&x>z)){ag(b.grep(y.childNodes),A);return 0}else{D=aV.clone(u,ac);ag(b.grep(y.childNodes),function(E,F){if((C<z&&F<z)||(C>z&&F>z)){B.push(E);E.parentNode.removeChild(E)}});if(C<z){y.insertBefore(D,s)}else{if(C>z){y.insertBefore(D,s.nextSibling)}}v.push(D);ag(B,function(E){D.appendChild(E)});return D}}function e(v,s,y){var x=[],z,u,r=true;z=f.inline||f.block;u=aV.create(z);c(u);al.walk(v,function(C){var B;function A(G){var D,F,I,H,E;E=r;D=G.nodeName.toLowerCase();F=G.parentNode.nodeName.toLowerCase();if(G.nodeType===1&&aB(G)){E=r;r=aB(G)==="true";H=true}if(aR(D,"br")){B=0;if(f.block){aV.remove(G)}return}if(f.wrapper&&aA(G,o,g)){B=0;return}if(r&&!H&&f.block&&!f.wrapper&&ap(D)){G=aV.rename(G,z);c(G);x.push(G);B=0;return}if(f.selector){ag(l,function(J){if("collapsed" in J&&J.collapsed!==k){return}if(aV.is(G,J.selector)&&!aW(G)){c(G,J);I=true}});if(!f.inline||I){B=0;return}}if(r&&!H&&aU(z,D)&&aU(F,z)&&!(!y&&G.nodeType===3&&G.nodeValue.length===1&&G.nodeValue.charCodeAt(0)===65279)&&!aW(G)){if(!B){B=aV.clone(u,ac);G.parentNode.insertBefore(B,G);x.push(B)}B.appendChild(G)}else{if(D=="li"&&s){B=p(G,s,u,x,A)}else{B=0;ag(b.grep(G.childNodes),A);if(H){r=E}B=0}}}ag(C,A)});if(f.wrap_links===false){ag(x,function(B){function A(E){var F,C,D;if(E.nodeName==="A"){C=aV.clone(u,ac);x.push(C);D=b.grep(E.childNodes);for(F=0;F<D.length;F++){C.appendChild(D[F])}E.appendChild(C)}ag(b.grep(E.childNodes),A)}A(B)})}ag(x,function(B){var D;function A(E){var F=0;ag(E.childNodes,function(G){if(!aS(G)&&!ao(G)){F++}});return F}function C(G){var E,F;ag(G.childNodes,function(H){if(H.nodeType==1&&!ao(H)&&!aW(H)){E=H;return ac}});if(E&&aQ(E,f)){F=aV.clone(E,ac);c(F);aV.replace(F,G,aw);aV.remove(E,1)}return F||G}D=A(B);if((x.length>1||!aq(B))&&D===0){aV.remove(B,1);return}if(f.inline||f.wrapper){if(!f.exact&&D===1){B=C(B)}ag(l,function(E){ag(aV.select(E.inline,B),function(F){var G;if(E.wrap_links===false){G=F.parentNode;do{if(G.nodeName==="A"){return}}while(G=G.parentNode)}aa(E,g,F,E.exact?F:null)})});if(aA(B.parentNode,o,g)){aV.remove(B,1);B=0;return aw}if(f.merge_with_parents){aV.getParent(B.parentNode,function(E){if(aA(E,o,g)){aV.remove(B,1);B=0;return aw}})}if(B&&f.merge_siblings!==false){B=aD(au(B),B);B=aD(B,au(B,aw))}}})}if(f){if(m){if(m.nodeType){q=aV.createRng();q.setStartBefore(m);q.setEndAfter(m);e(aI(q,l),null,true)}else{e(m,null,true)}}else{if(!k||!f.inline||aV.select("td.mceSelected,th.mceSelected").length){var d=a.selection.getNode();if(!aL&&l[0].defaultBlock&&!aV.getParent(d,aV.isBlock)){ab(l[0].defaultBlock)}a.selection.setRng(n());h=aG.getBookmark();e(aI(aG.getRng(aw),l),h);if(f.styles&&(f.styles.color||f.styles.textDecoration)){b.walk(d,an,"childNodes");an(d)}aG.moveToBookmark(h);ai(aG.getRng(aw));a.nodeChanged()}else{af("apply",o,g)}}}}function ax(q,g,o){var n=ae(q),e=n[0],j,k,r,h=true;function p(A){var s,u,v,x,y,z;if(A.nodeType===1&&aB(A)){y=h;h=aB(A)==="true";z=true}s=b.grep(A.childNodes);if(h&&!z){for(u=0,v=n.length;u<v;u++){if(aa(n[u],g,A,A)){break}}}if(e.deep){if(s.length){for(u=0,v=s.length;u<v;u++){p(s[u])}if(z){h=y}}}}function m(u){var s;ag(aK(u.parentNode).reverse(),function(x){var v;if(!s&&x.id!="_start"&&x.id!="_end"){v=aA(x,q,g);if(v&&v.split!==false){s=x}}});return s}function c(y,B,v,D){var C,s,u,z,x,A;if(y){A=y.parentNode;for(C=B.parentNode;C&&C!=A;C=C.parentNode){s=aV.clone(C,ac);for(x=0;x<n.length;x++){if(aa(n[x],g,s,s)){s=0;break}}if(s){if(u){s.appendChild(u)}if(!z){z=s}u=s}}if(D&&(!e.mixed||!aq(y))){B=aV.split(y,B)}if(u){v.parentNode.insertBefore(u,v);z.appendChild(v)}}return B}function f(s){return c(m(s),s,s,true)}function l(s){var u=aV.get(s?"_start":"_end"),v=u[s?"firstChild":"lastChild"];if(ao(v)){v=v[s?"firstChild":"lastChild"]}aV.remove(u,true);return v}function d(x){var u,s,v;x=aI(x,n,aw);if(e.split){u=am(x,aw);s=am(x);if(u!=s){v=u.firstChild;if(u.nodeName=="TD"&&v){u=v}u=ah(u,"span",{id:"_start","data-mce-type":"bookmark"});s=ah(s,"span",{id:"_end","data-mce-type":"bookmark"});f(u);f(s);u=l(aw);s=l()}else{u=s=f(u)}x.startContainer=u.parentNode;x.startOffset=aF(u);x.endContainer=s.parentNode;x.endOffset=aF(s)+1}al.walk(x,function(y){ag(y,function(z){p(z);if(z.nodeType===1&&a.dom.getStyle(z,"text-decoration")==="underline"&&z.parentNode&&aP(z.parentNode)==="underline"){aa({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,z)}})})}if(o){if(o.nodeType){r=aV.createRng();r.setStartBefore(o);r.setEndAfter(o);d(r)}else{d(o)}return}if(!aG.isCollapsed()||!e.inline||aV.select("td.mceSelected,th.mceSelected").length){j=aG.getBookmark();d(aG.getRng(aw));aG.moveToBookmark(j);if(e.inline&&aN(q,g,aG.getStart())){ai(aG.getRng(true))}a.nodeChanged()}else{af("remove",q,g)}}function at(e,c,d){var f=ae(e);if(aN(e,c,d)&&(!("toggle" in f[0])||f[0].toggle)){ax(e,c,d)}else{ab(e,c,d)}}function aA(l,c,f,h){var k=ae(c),e,g,j;function d(p,n,m){var q,o,s=n[m],r;if(n.onmatch){return n.onmatch(p,n,m)}if(s){if(s.length===av){for(q in s){if(s.hasOwnProperty(q)){if(m==="attributes"){o=aV.getAttrib(p,q)}else{o=ak(p,q)}if(h&&!o&&!n.exact){return}if((!h||n.exact)&&!aR(o,aH(s[q],f))){return}}}}else{for(r=0;r<s.length;r++){if(m==="attributes"?aV.getAttrib(p,s[r]):ak(p,s[r])){return n}}}}return n}if(k&&l){for(g=0;g<k.length;g++){e=k[g];if(aQ(l,e)&&d(l,e,"attributes")&&d(l,e,"styles")){if(j=e.classes){for(g=0;g<j.length;g++){if(!aV.hasClass(l,j[g])){return}}}return e}}}}function aN(e,c,d){var f;function g(h){h=aV.getParent(h,function(j){return !!aA(j,e,c,true)});return aA(h,e,c)}if(d){return g(d)}d=aG.getNode();if(g(d)){return aw}f=aG.getStart();if(f!=d){if(g(f)){return aw}}return ac}function aC(c,d){var f,e=[],g={},h,j,k;f=aG.getStart();aV.getParent(f,function(m){var n,l;for(n=0;n<c.length;n++){l=c[n];if(!g[l]&&aA(m,l,d)){g[l]=true;e.push(l)}}});return e}function az(e){var c=ae(e),f,g,d,h,j;if(c){f=aG.getStart();g=aK(f);for(h=c.length-1;h>=0;h--){j=c[h].selector;if(!j){return aw}for(d=g.length-1;d>=0;d--){if(aV.is(g[d],j)){return aw}}}}return ac}b.extend(this,{get:ae,register:aM,apply:ab,remove:ax,toggle:at,match:aN,matchAll:aC,matchNode:aA,canApply:az});aO();ad();function aQ(d,c){if(aR(d,c.inline)){return aw}if(aR(d,c.block)){return aw}if(c.selector){return aV.is(d,c.selector)}}function aR(c,d){c=c||"";d=d||"";c=""+(c.nodeName||c);d=""+(d.nodeName||d);return c.toLowerCase()==d.toLowerCase()}function ak(d,e){var c=aV.getStyle(d,e);if(e=="color"||e=="backgroundColor"){c=aV.toHex(c)}if(e=="fontWeight"&&c==700){c="bold"}return""+c}function aH(d,c){if(typeof(d)!="string"){d=d(c)}else{if(c){d=d.replace(/%(\w+)/g,function(e,f){return c[f]||e})}}return d}function aS(c){return c&&c.nodeType===3&&/^([\t \r\n]+|)$/.test(c.nodeValue)}function ah(d,e,f){var c=aV.create(e,f);d.parentNode.insertBefore(c,d);c.appendChild(d);return c}function aI(c,j,r){var f,h,o,k,s=c.startContainer,n=c.startOffset,d=c.endContainer,l=c.endOffset;function g(y){var v,A,z,B,C,x;v=A=y?s:d;C=y?"previousSibling":"nextSibling";x=aV.getRoot();if(v.nodeType==3&&!aS(v)){if(y?n>0:l<v.nodeValue.length){return v}}for(;;){if(!j[0].block_expand&&aq(A)){return A}for(B=A[C];B;B=B[C]){if(!ao(B)&&!aS(B)){return A}}if(A.parentNode==x){v=A;break}A=A.parentNode}return v}function p(x,v){if(v===av){v=x.nodeType===3?x.length:x.childNodes.length}while(x&&x.hasChildNodes()){x=x.childNodes[v];if(x){v=x.nodeType===3?x.length:x.childNodes.length}}return{node:x,offset:v}}if(s.nodeType==1&&s.hasChildNodes()){h=s.childNodes.length-1;s=s.childNodes[n>h?h:n];if(s.nodeType==3){n=0}}if(d.nodeType==1&&d.hasChildNodes()){h=d.childNodes.length-1;d=d.childNodes[l>h?h:l-1];if(d.nodeType==3){l=d.nodeValue.length}}function e(v){var x=v;while(x){if(x.nodeType===1&&aB(x)){return aB(x)==="false"?x:v}x=x.parentNode}return v}function m(v,A,y){var B,D,z,x;function C(H,F){var E,I,G=H.nodeValue;if(typeof(F)=="undefined"){F=y?G.length:0}if(y){E=G.lastIndexOf(" ",F);I=G.lastIndexOf("\u00a0",F);E=E>I?E:I;if(E!==-1&&!r){E++}}else{E=G.indexOf(" ",F);I=G.indexOf("\u00a0",F);E=E!==-1&&(I===-1||E<I)?E:I}return E}if(v.nodeType===3){z=C(v,A);if(z!==-1){return{container:v,offset:z}}x=v}B=new aE(v,aV.getParent(v,aq)||a.getBody());while(D=B[y?"prev":"next"]()){if(D.nodeType===3){x=D;z=C(D);if(z!==-1){return{container:D,offset:z}}}else{if(aq(D)){break}}}if(x){if(y){A=0}else{A=x.length}return{container:x,offset:A}}}function q(v,x){var B,A,y,z;if(v.nodeType==3&&v.nodeValue.length===0&&v[x]){v=v[x]}B=aK(v);for(A=0;A<B.length;A++){for(y=0;y<j.length;y++){z=j[y];if("collapsed" in z&&z.collapsed!==c.collapsed){continue}if(aV.is(B[A],z.selector)){return B[A]}}}return v}function u(v,x,y){var z;if(!j[0].wrapper){z=aV.getParent(v,j[0].block)}if(!z){z=aV.getParent(v.nodeType==3?v.parentNode:v,aq)}if(z&&j[0].wrapper){z=aK(z,"ul,ol").reverse()[0]||z}if(!z){z=v;while(z[x]&&!aq(z[x])){z=z[x];if(aR(z,"br")){break}}}return z||v}s=e(s);d=e(d);if(ao(s.parentNode)||ao(s)){s=ao(s)?s:s.parentNode;s=s.nextSibling||s;if(s.nodeType==3){n=0}}if(ao(d.parentNode)||ao(d)){d=ao(d)?d:d.parentNode;d=d.previousSibling||d;if(d.nodeType==3){l=d.length}}if(j[0].inline){if(c.collapsed){k=m(s,n,true);if(k){s=k.container;n=k.offset}k=m(d,l);if(k){d=k.container;l=k.offset}}o=p(d,l);if(o.node){while(o.node&&o.offset===0&&o.node.previousSibling){o=p(o.node.previousSibling)}if(o.node&&o.offset>0&&o.node.nodeType===3&&o.node.nodeValue.charAt(o.offset-1)===" "){if(o.offset>1){d=o.node;d.splitText(o.offset-1)}}}}if(j[0].inline||j[0].block_expand){if(!j[0].inline||(s.nodeType!=3||n===0)){s=g(true)}if(!j[0].inline||(d.nodeType!=3||l===d.nodeValue.length)){d=g()}}if(j[0].selector&&j[0].expand!==ac&&!j[0].inline){s=q(s,"previousSibling");d=q(d,"nextSibling")}if(j[0].block||j[0].selector){s=u(s,"previousSibling");d=u(d,"nextSibling");if(j[0].block){if(!aq(s)){s=g(true)}if(!aq(d)){d=g()}}}if(s.nodeType==1){n=aF(s);s=s.parentNode}if(d.nodeType==1){l=aF(d)+1;d=d.parentNode}return{startContainer:s,startOffset:n,endContainer:d,endOffset:l}}function aa(c,d,f,j){var g,h,e;if(!aQ(f,c)){return ac}if(c.remove!="all"){ag(c.styles,function(k,l){k=aH(k,d);if(typeof(l)==="number"){l=k;j=0}if(!j||aR(ak(j,l),k)){aV.setStyle(f,l,"")}e=1});if(e&&aV.getAttrib(f,"style")==""){f.removeAttribute("style");f.removeAttribute("data-mce-style")}ag(c.attributes,function(m,l){var k;m=aH(m,d);if(typeof(l)==="number"){l=m;j=0}if(!j||aR(aV.getAttrib(j,l),m)){if(l=="class"){m=aV.getAttrib(f,l);if(m){k="";ag(m.split(/\s+/),function(n){if(/mce\w+/.test(n)){k+=(k?" ":"")+n}});if(k){aV.setAttrib(f,l,k);return}}}if(l=="class"){f.removeAttribute("className")}if(aT.test(l)){f.removeAttribute("data-mce-"+l)}f.removeAttribute(l)}});ag(c.classes,function(k){k=aH(k,d);if(!j||aV.hasClass(j,k)){aV.removeClass(f,k)}});h=aV.getAttribs(f);for(g=0;g<h.length;g++){if(h[g].nodeName.indexOf("_")!==0){return ac}}}if(c.remove!="none"){aJ(f,c);return aw}}function aJ(e,d){var g=e.parentNode,f;function c(j,k,h){j=au(j,k,h);return !j||(j.nodeName=="BR"||aq(j))}if(d.block){if(!aL){if(aq(e)&&!aq(g)){if(!c(e,ac)&&!c(e.firstChild,aw,1)){e.insertBefore(aV.create("br"),e.firstChild)}if(!c(e,aw)&&!c(e.lastChild,ac,1)){e.appendChild(aV.create("br"))}}}else{if(g==aV.getRoot()){if(!d.list_block||!aR(e,d.list_block)){ag(b.grep(e.childNodes),function(h){if(aU(aL,h.nodeName.toLowerCase())){if(!f){f=ah(h,aL)}else{f.appendChild(h)}}else{f=0}})}}}}if(d.selector&&d.inline&&!aR(d.inline,e)){return}aV.remove(e,1)}function au(d,e,c){if(d){e=e?"nextSibling":"previousSibling";for(d=c?d:d[e];d;d=d[e]){if(d.nodeType==1||!aS(d)){return d}}}}function ao(c){return c&&c.nodeType==1&&c.getAttribute("data-mce-type")=="bookmark"}function aD(e,f){var j,g,h;function c(n,k){if(n.nodeName!=k.nodeName){return ac}function l(p){var o={};ag(aV.getAttribs(p),function(r){var q=r.nodeName.toLowerCase();if(q.indexOf("_")!==0&&q!=="style"){o[q]=aV.getAttrib(p,q)}});return o}function m(o,p){var q,r;for(r in o){if(o.hasOwnProperty(r)){q=p[r];if(q===av){return ac}if(o[r]!=q){return ac}delete p[r]}}for(r in p){if(p.hasOwnProperty(r)){return ac}}return aw}if(!m(l(n),l(k))){return ac}if(!m(aV.parseStyle(aV.getAttrib(n,"style")),aV.parseStyle(aV.getAttrib(k,"style")))){return ac}return aw}function d(k,l){for(g=k;g;g=g[l]){if(g.nodeType==3&&g.nodeValue.length!==0){return k}if(g.nodeType==1&&!ao(g)){return g}}return k}if(e&&f){e=d(e,"previousSibling");f=d(f,"nextSibling");if(c(e,f)){for(g=e.nextSibling;g&&g!=f;){h=g;g=g.nextSibling;e.appendChild(h)}aV.remove(f);ag(b.grep(f.childNodes),function(k){e.appendChild(k)});return e}}return f}function ap(c){return/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(c)}function am(g,c){var h,d,f,e;h=g[c?"startContainer":"endContainer"];d=g[c?"startOffset":"endOffset"];if(h.nodeType==1){f=h.childNodes.length-1;if(!c&&d){d--}h=h.childNodes[d>f?f:d]}if(h.nodeType===3&&c&&d>=h.nodeValue.length){h=new aE(h,a.getBody()).next()||h}if(h.nodeType===3&&!c&&d===0){h=new aE(h,a.getBody()).prev()||h}return h}function af(f,c,h){var e="_mce_caret",o=a.settings.caret_debug;function n(p){var q=aV.create("span",{id:e,"data-mce-bogus":true,style:o?"color:red":""});if(p){q.appendChild(a.getDoc().createTextNode(ar))}return q}function g(p,q){while(p){if((p.nodeType===3&&p.nodeValue!==ar)||p.childNodes.length>1){return false}if(q&&p.nodeType===1){q.push(p)}p=p.firstChild}return true}function k(p){while(p){if(p.id===e){return p}p=p.parentNode}}function l(q){var p;if(q){p=new aE(q,q);for(q=p.current();q;q=p.next()){if(q.nodeType===3){return q}}}}function m(q,r){var p,s;if(!q){q=k(aG.getStart());if(!q){while(q=aV.get(e)){m(q,false)}}}else{s=aG.getRng(true);if(g(q)){if(r!==false){s.setStartBefore(q);s.setEndBefore(q)}aV.remove(q)}else{p=l(q);if(p.nodeValue.charAt(0)===ar){p=p.deleteData(0,1)}aV.remove(q,1)}aG.setRng(s)}}function j(){var u,x,p,q,s,v,r;u=aG.getRng(true);q=u.startOffset;v=u.startContainer;r=v.nodeValue;x=k(aG.getStart());if(x){p=l(x)}if(r&&q>0&&q<r.length&&/\w/.test(r.charAt(q))&&/\w/.test(r.charAt(q-1))){s=aG.getBookmark();u.collapse(true);u=aI(u,ae(c));u=al.split(u);ab(c,h,u);aG.moveToBookmark(s)}else{if(!x||p.nodeValue!==ar){x=n(true);p=x.firstChild;u.insertNode(x);q=1;ab(c,h,x)}else{ab(c,h,x)}aG.setCursorLocation(p,q)}}function d(){var A=aG.getRng(true),z,x,s,u,y,p,q=[],v,r;z=A.startContainer;x=A.startOffset;y=z;if(z.nodeType==3){if(x!=z.nodeValue.length||z.nodeValue===ar){u=true}y=y.parentNode}while(y){if(aA(y,c,h)){p=y;break}if(y.nextSibling){u=true}q.push(y);y=y.parentNode}if(!p){return}if(u){s=aG.getBookmark();A.collapse(true);A=aI(A,ae(c),true);A=al.split(A);ax(c,h,A);aG.moveToBookmark(s)}else{r=n();y=r;for(v=q.length-1;v>=0;v--){y.appendChild(aV.clone(q[v],false));y=y.firstChild}y.appendChild(aV.doc.createTextNode(ar));y=y.firstChild;aV.insertAfter(r,p);aG.setCursorLocation(y,1)}}if(!self._hasCaretEvents){a.onBeforeGetContent.addToTop(function(){var q=[],p;if(g(k(aG.getStart()),q)){p=q.length;while(p--){aV.setAttrib(q[p],"data-mce-bogus","1")}}});b.each("onMouseUp onKeyUp".split(" "),function(p){a[p].addToTop(function(){m()})});a.onKeyDown.addToTop(function(r,p){var q=p.keyCode;if(q==8||q==37||q==39){m(k(aG.getStart()))}});self._hasCaretEvents=true}if(f=="apply"){j()}else{d()}}function ai(j){var k=j.startContainer,c=j.startOffset,g,d,e,h,f;if(k.nodeType==3&&c>=k.nodeValue.length){c=aF(k);k=k.parentNode;g=true}if(k.nodeType==1){h=k.childNodes;k=h[Math.min(c,h.length-1)];d=new aE(k,aV.getParent(k,aV.isBlock));if(c>h.length-1||g){d.next()}for(e=d.current();e;e=d.next()){if(e.nodeType==3&&!aS(e)){f=aV.create("a",null,ar);e.parentNode.insertBefore(f,e);j.setStart(e,0);aG.setRng(j);aV.remove(f);return}}}}}})(tinymce);tinymce.onAddEditor.add(function(o,k){var p,l,m,q=k.settings;function j(a,b){o.each(b,function(c,d){if(c){m.setStyle(a,d,c)}});m.rename(a,"span")}function n(b,a){m=b.dom;if(q.convert_fonts_to_spans){o.each(m.select("font,u,strike",a.node),function(c){p[c.nodeName.toLowerCase()](k.dom,c)})}}if(q.inline_styles){l=o.explode(q.font_size_legacy_values);p={font:function(a,b){j(b,{backgroundColor:b.style.backgroundColor,color:b.color,fontFamily:b.face,fontSize:l[parseInt(b.size,10)-1]})},u:function(a,b){j(b,{textDecoration:"underline"})},strike:function(a,b){j(b,{textDecoration:"line-through"})}};k.onPreProcess.add(n);k.onSetContent.add(n);k.onInit.add(function(){k.selection.onSetContent.add(n)})}});(function(c){var d=c.dom.TreeWalker;c.EnterKey=function(k){var a=k.dom,l=k.selection,m=k.settings,b=k.undoManager;function j(e){var L=l.getRng(true),Q,ad,f,N,X,g,Y,ac,aa,P,M,h,W;function S(n){return n&&a.isBlock(n)&&!/^(TD|TH|CAPTION)$/.test(n.nodeName)&&!/^(fixed|absolute)/i.test(n.style.position)&&a.getContentEditable(n)!=="true"}function Z(o){var r,u,p,q,s,v=o,n;p=a.createRng();if(o.hasChildNodes()){r=new d(o,o);while(u=r.current()){if(u.nodeType==3){p.setStart(u,0);p.setEnd(u,0);break}if(/^(BR|IMG)$/.test(u.nodeName)){p.setStartBefore(u);p.setEndBefore(u);break}v=u;u=r.next()}if(!u){p.setStart(v,0);p.setEnd(v,0)}}else{if(o.nodeName=="BR"){if(o.nextSibling&&a.isBlock(o.nextSibling)){if(!g||g<9){n=a.create("br");o.parentNode.insertBefore(n,o)}p.setStartBefore(o);p.setEndBefore(o)}else{p.setStartAfter(o);p.setEndAfter(o)}}else{p.setStart(o,0);p.setEnd(o,0)}}l.setRng(p);a.remove(n);s=a.getViewPort(k.getWin());q=a.getPos(o).y;if(q<s.y||q+25>s.y+s.h){k.getWin().scrollTo(0,q<s.y?q:q-s.h+25)}}function U(o){var n=f,q,r,p;q=o||P=="TABLE"?a.create(o||h):X.cloneNode(false);p=q;if(m.keep_styles!==false){do{if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(n.nodeName)){r=n.cloneNode(false);a.setAttrib(r,"id","");if(q.hasChildNodes()){r.appendChild(q.firstChild);q.appendChild(r)}else{p=r;q.appendChild(r)}}}while(n=n.parentNode)}if(!c.isIE){p.innerHTML="<br>"}return q}function V(q){var n,o,p;if(f.nodeType==3&&(q?N>0:N<f.nodeValue.length)){return false}if(f.parentNode==X&&W&&!q){return true}if(f.nodeName==="TABLE"||(f.previousSibling&&f.previousSibling.nodeName=="TABLE")){return(W&&!q)||(!W&&q)}n=new d(f,X);while(o=(q?n.prev():n.next())){if(o.nodeType===1){if(o.getAttribute("data-mce-bogus")){continue}p=o.nodeName.toLowerCase();if(p==="IMG"){return false}}else{if(o.nodeType===3&&!/^[ \t\r\n]*$/.test(o.nodeValue)){return false}}}return true}function ab(p,r){var q,s,n,u,v,o=h||"P";s=a.getParent(p,a.isBlock);if(!s||!S(s)){s=s||ad;if(!s.hasChildNodes()){q=a.create(o);s.appendChild(q);L.setStart(q,0);L.setEnd(q,0);return q}u=p;while(u.parentNode!=s){u=u.parentNode}while(u&&!a.isBlock(u)){n=u;u=u.previousSibling}if(n){q=a.create(o);n.parentNode.insertBefore(q,n);u=n;while(u&&!a.isBlock(u)){v=u.nextSibling;q.appendChild(u);u=v}L.setStart(p,r);L.setEnd(p,r)}}return p}function O(){function n(o){var p=aa[o?"firstChild":"lastChild"];while(p){if(p.nodeType==1){break}p=p[o?"nextSibling":"previousSibling"]}return p===X}Y=h?U(h):a.create("BR");if(n(true)&&n()){a.replace(Y,aa)}else{if(n(true)){aa.parentNode.insertBefore(Y,aa)}else{if(n()){a.insertAfter(Y,aa)}else{Q=L.cloneRange();Q.setStartAfter(X);Q.setEndAfter(aa);ac=Q.extractContents();a.insertAfter(ac,aa);a.insertAfter(Y,aa)}}}a.remove(X);Z(Y);b.add()}function T(){var n=new d(f,X),o;while(o=n.current()){if(o.nodeName=="BR"){return true}o=n.next()}}function J(){var n,o;if(f&&f.nodeType==3&&N>=f.nodeValue.length){if(!c.isIE&&!T()){n=a.create("br");L.insertNode(n);L.setStartAfter(n);L.setEndAfter(n);o=true}}n=a.create("br");L.insertNode(n);if(c.isIE&&P=="PRE"&&(!g||g<8)){n.parentNode.insertBefore(a.doc.createTextNode("\r"),n)}if(!o){L.setStartAfter(n);L.setEndAfter(n)}else{L.setStartBefore(n);L.setEndBefore(n)}l.setRng(L);b.add()}function R(n){do{if(n.nodeType===3){n.nodeValue=n.nodeValue.replace(/^[\r\n]+/,"")}n=n.firstChild}while(n)}function K(n){var p=a.getRoot(),o,q;o=n;while(o!==p&&a.getContentEditable(o)!=="false"){if(a.getContentEditable(o)==="true"){q=o}o=o.parentNode}return o!==p?q:p}if(!L.collapsed){k.execCommand("Delete");return}if(e.isDefaultPrevented()){return}f=L.startContainer;N=L.startOffset;h=m.forced_root_block;h=h?h.toUpperCase():"";g=a.doc.documentMode;if(f.nodeType==1&&f.hasChildNodes()){W=N>f.childNodes.length-1;f=f.childNodes[Math.min(N,f.childNodes.length-1)]||f;N=0}ad=K(f);if(!ad){return}b.beforeChange();if(!a.isBlock(ad)&&ad!=a.getRoot()){if(!h||e.shiftKey){J()}return}if((h&&!e.shiftKey)||(!h&&e.shiftKey)){f=ab(f,N)}X=a.getParent(f,a.isBlock);aa=X?a.getParent(X.parentNode,a.isBlock):null;P=X?X.nodeName.toUpperCase():"";M=aa?aa.nodeName.toUpperCase():"";if(P=="LI"&&a.isEmpty(X)){if(/^(UL|OL|LI)$/.test(aa.parentNode.nodeName)){return false}O();return}if(P=="PRE"&&m.br_in_pre!==false){if(!e.shiftKey){J();return}}else{if((!h&&!e.shiftKey&&P!="LI")||(h&&e.shiftKey)){J();return}}h=h||"P";if(V()){if(/^(H[1-6]|PRE)$/.test(P)&&M!="HGROUP"){Y=U(h)}else{Y=U()}if(m.end_container_on_empty_block&&S(aa)&&a.isEmpty(X)){Y=a.split(aa,X)}else{a.insertAfter(Y,X)}}else{if(V(true)){Y=X.parentNode.insertBefore(U(),X)}else{Q=L.cloneRange();Q.setEndAfter(X);ac=Q.extractContents();R(ac);Y=ac.firstChild;a.insertAfter(ac,X)}}a.setAttrib(Y,"id","");Z(Y);b.add()}k.onKeyDown.add(function(e,f){if(f.keyCode==13){if(j(f)!==false){f.preventDefault()}}})}})(tinymce);Ext.define("OPF.core.model.Culture",{extend:Ext.data.Model,fields:[{name:"country",type:"string"},{name:"culture",type:"string"},{name:"countryLC",mapping:"country",convert:function(b,a){return b.toLowerCase()}}]});Ext.define("OPF.core.model.Field",{extend:Ext.data.Model,fields:[{name:"id",type:"int",useNull:true},{name:"inherited",type:"boolean"},{name:"autoGenerated",type:"boolean"},{name:"name",type:"string"},{name:"displayName",type:"string"},{name:"displayDescription",type:"string"},{name:"fieldType",type:"string"},{name:"fieldTypeName",type:"string"},{name:"customFieldType",type:"string"},{name:"required",type:"boolean"},{name:"searchable",type:"boolean"},{name:"defaultValue",type:"string",useNull:true},{name:"description",type:"string",useNull:true},{name:"allowedValues",useNull:true},{name:"parentId",type:"int"},{name:"created",type:"int"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"}],associations:[{type:"belongsTo",model:"OPF.console.directory.model.Directory",primaryKey:"id",foreignKey:"parentId"}]});Ext.define("OPF.core.model.FileTreeModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:null,restSuffixUrl:"registry",editorClassName:null,constraintName:null},fields:[{name:"id",type:"string"},{name:"path",type:"string"},{name:"text",type:"string"},{name:"icon",type:"string"},{name:"cls",type:"string"},{name:"iconCls",type:"string"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"leaf",type:"boolean"},{name:"allowDrag",type:"boolean"},{name:"allowDrop",type:"boolean"},{name:"expanded",type:"boolean"},{name:"children",useNull:true}]});Ext.define("OPF.core.model.RegistryNodeTreeModel",{extend:Ext.data.Model,statics:{pageSuffixUrl:null,restSuffixUrl:"registry",editorClassName:null,constraintName:null},fields:[{name:"id",type:"string",convert:function(c,a){if(Ext.isNumber(c)){var b=a.get("type");return"xnode-"+b.toLowerCase()+"-"+c}else{return c}}},{name:"name",type:"string"},{name:"text",type:"string",convert:function(b,a){return OPF.ifBlank(b,a.get("name"))}},{name:"icon",type:"string"},{name:"cls",type:"string"},{name:"iconCls",type:"string",convert:function(b,a){return OPF.ifBlank(b,"tricon-"+a.get("type").toLowerCase())}},{name:"urlPath",type:"string",useNull:true},{name:"realId",type:"int"},{name:"shortDescription",type:"string"},{name:"lookup",type:"string"},{name:"path",type:"string"},{name:"parentId",type:"int"},{name:"type",type:"string"},{name:"entityType",type:"string"},{name:"entitySubType",type:"string"},{name:"sortPosition",type:"int"},{name:"dropContainer"},{name:"canUpdate",type:"boolean"},{name:"canDelete",type:"boolean"},{name:"leaf",type:"boolean"},{name:"allowDrag",type:"boolean"},{name:"allowDrop",type:"boolean"},{name:"expanded",type:"boolean"},{name:"children",useNull:true},{name:"parameters",type:"auto",useNull:true}]});var AUTHENTICATION_OPF="authentication_opf";var AUTHENTICATION_OPENID1="authentication_openid1";var AUTHENTICATION_OPENID2="authentication_openid2";Ext.define("OPF.core.utils.AuthenticationProvider",{constructor:function(d,a,e,c,b){b=b||{};this.longName=d;this.shortName=a;this.icon=OPF.Cfg.fullUrl(e);this.url=c;this.authenticationType=AUTHENTICATION_OPF},getLongName:function(){return this.longName},getShortName:function(){return this.shortName},getIcon:function(){return this.icon},getUrl:function(){return this.url},getAuthenticationType:function(){return this.authenticationType},prepareForm:function(a){a.setCurrentAuthenticationProvider(this);a.setOpenFlameForm()}});Ext.define("OPF.core.utils.OpenIdProvider",{extend:OPF.core.utils.AuthenticationProvider,constructor:function(c,j,h,f,g,b,a,d,k,e){e=e||{};OPF.core.utils.OpenIdProvider.superclass.constructor.call(this,c,j,g,a,e);this.urlSuffix=h;this.idParameter=f;this.urlPrefix=d;this.authenticationType=k},getUrlSuffix:function(){return this.urlSuffix},getIdParameter:function(){return this.idParameter},getUrlPrefix:function(){return this.urlPrefix},prepareForm:function(a){a.setCurrentAuthenticationProvider(this);a.setOpenIdForm();if(this.isOpenId2Supported()&&!this.isOpenId1Supported()){a.prepareOpenId2FieldSet(this)}else{a.prepareOpenId1FieldSet(this)}}});OPF.capitalise=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};OPF.isNotEmpty=function(a){return a!=undefined&&a!=null};OPF.isEmpty=function(a){return a==undefined||a==null};OPF.isBlank=function(a){return OPF.isEmpty(a)||a.length==0};OPF.isNotBlank=function(a){return OPF.isNotEmpty(a)&&a.length>0};OPF.ifBlank=function(b,a){if(OPF.isNotBlank(b)){return b}return a};OPF.ifEmpty=function(b,a){if(OPF.isNotEmpty(b)){return b}return a};OPF.getSimpleClassName=function(b){var a=b.lastIndexOf(".");return b.substring(a+1)};OPF.findPackageLookup=function(b){var a=/^[\w\-]+\.[\w\-]+\.[\w\-]+/g;return a.exec(b)[0]};OPF.findPathFromLookup=function(a){return a.substring(0,a.lastIndexOf("."))};OPF.generateUrlByLookup=function(d,b){var c=OPF.findPackageLookup(d);var e=d.substring(c.length);var a=e.replace(/\./g,"/");return OPF.Cfg.fullUrl((b||"")+a,true)};OPF.cutting=function(a,b){if(OPF.isNotEmpty(a)){if(a.length>b){a=a.substring(0,b-3)+"..."}}return a};OPF.convertTime=function(a){if(Ext.isNumeric(a)){var b=new Date();b.setTime(a);a=Ext.Date.format(b,"g:i A")}return a};OPF.convertDate=function(a){if(Ext.isNumeric(a)){var b=new Date();b.setTime(a);a=Ext.Date.format(b,"Y-m-d")}return a};OPF.convertDatetime=function(a){if(Ext.isNumeric(a)){var b=new Date();b.setTime(a);a=Ext.Date.format(b,"Y-m-d g:i:s A")}return a};OPF.calculateColumnWidth=function(a){return a.length*8+25};OPF.getQueryParam=function gup(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+b+"=([^&#]*)";var d=new RegExp(a);var c=d.exec(window.location.href);if(c==null){return null}else{return c[1]}};OPF.copyStore=function(b,d){var a=[];var c=new Ext.data.ArrayStore({model:b.model});b.each(function(e){if(d(e)){a.push(e.copy())}});c.loadRecords(a);return c};OPF.loadJsFile=function(a){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",a);document.getElementsByTagName("head")[0].appendChild(b)};OPF.loadCssFile=function(a){var b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(b)};OPF.windowSize=function(){var b=0,a=0;if(typeof(window.innerWidth)=="number"){b=window.innerWidth;a=window.innerHeight}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){b=document.documentElement.clientWidth;a=document.documentElement.clientHeight}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){b=document.body.clientWidth;a=document.body.clientHeight}}}return{width:b,height:a}};OPF.getScrollXY=function(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft}}}return{scrOfX:b,scrOfY:a}};OPF.randomUUID=function(){var b=[],c="0123456789ABCDEF";for(var a=0;a<36;a++){b[a]=Math.floor(Math.random()*16)}b[14]=4;b[19]=(b[19]&3)|8;for(var a=0;a<36;a++){b[a]=c[b[a]]}b[8]=b[13]=b[18]=b[23]="-";return b.join("")};OPF.textToImage=function(f,e){f="{"+f+"}";var a=document.createElement("div");document.body.appendChild(a);a.innerHTML=f;a.style.position="absolute";a.style.visibility="hidden";a.style.top="-1000";a.style.left="-1000";if(!e){e="12px Tahoma"}a.style.font=e;var j=a.style.fontSize;if(j.match(/\d+px/g)){j=parseInt(j.replace(/px/g,""))}var g=a.clientHeight+1;var b=a.clientWidth+1;document.body.removeChild(a);var c=document.createElement("canvas");c.width=b;c.height=g;var h=c.getContext("2d");h.strokeStyle="#FF0000";h.lineWidth=1;h.fillStyle="#DEFCFA";h.fillRect(0,0,b,g);h.fillStyle="#000000";h.font=e;h.fillText(f,1,g-j/3);var d=c.toDataURL("image/png");return{base64Src:d,width:b,height:g}};OPF.htmlToText=function(c,e){if(OPF.isBlank(c)){return c}var b,f,g=c;if(e&&e.preprocessing){g=e.preprocessing(g)}g=g.replace(/(?:\n|\r\n|\r)/ig," ").replace(/<\s*script[^>]*>[\s\S]*?<\/script>/mig,"").replace(/<\s*style[^>]*>[\s\S]*?<\/style>/mig,"").replace(/<!--.*?-->/mig,"").replace(/<!DOCTYPE.*?>/ig,"");if(e&&e.tagreplacement){g=e.tagreplacement(g)}var h=["p","h[1-6]","dl","dt","dd","ol","ul","dir","address","blockquote","center","div","hr","pre","form","textarea","table"];var d=["li","del","ins","fieldset","legend","tr","th","caption","thead","tbody","tfoot"];for(b=0;b<h.length;b++){f=new RegExp("</?\\s*"+h[b]+"[^>]*>","ig");g=g.replace(f,"\n\n")}for(b=0;b<d.length;b++){f=new RegExp("<\\s*"+d[b]+"[^>]*>","ig");g=g.replace(f,"\n")}g=g.replace(/<\s*br[^>]*\/?\s*>/ig,"\n");function a(j,l){var k;if(l.substr(0,1)=="#"){if(l.substr(1,1)=="x"){k=parseInt(l.substr(2),16)}else{k=parseInt(l.substr(1),10)}}else{k=OPF.ENTITIES_MAP[l]}return(k===undefined||k===NaN)?"&"+l+";":String.fromCharCode(k)}g=g.replace(/(<([^>]+)>)/ig,"").replace(/([^\n\S]+)\n/g,"\n").replace(/([^\n\S]+)$/,"").replace(/\n{2,}/g,"\n\n").replace(/^\n+/,"").replace(/\n+$/,"").replace(/&([^;]+);/g,a);if(e&&e.postprocessing){g=e.postprocessing(g)}return g};OPF.calculateLookup=function(c,a){c=OPF.ifBlank(c,"");a=OPF.ifBlank(a,"");var d=a.replace(/[\s!"#$%&'()*+,-./:;<=>?@\[\\\]^_`{|}~]+/g,"-");var b=(OPF.isNotBlank(c)?c+".":"")+d;return b.toLowerCase()};OPF.ENTITIES_MAP={nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,quot:34,amp:38,lt:60,gt:62,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,circ:710,tilde:732,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,permil:8240,lsaquo:8249,rsaquo:8250,euro:8364};Date.prototype.getWeek=function(){var a=new Date(this.getFullYear(),0,1);return Math.ceil((((this-a)/86400000)+a.getDay()+1)/7)};Date.prototype.addDays=function(b){if(b){var a=this.getTime();a=a+(b*86400000);this.setTime(a)}};Date.prototype.getLastDateOfMonth=function(){return Ext.Date.getLastDateOfMonth(this)};Ext.override(Ext.data.Store,{exportExcel:function(b){var c=this;b=b||{};Ext.applyIf(b,{groupers:c.groupers.items,page:c.currentPage,start:(c.currentPage-1)*c.pageSize,limit:c.pageSize,addRecords:false,action:"read",filters:c.filters.items,sorters:c.getSorters()});Ext.apply(b.headers,c.proxy.headers);Ext.apply(b.headers,{Accept:"application/xls"});var a=Ext.create("Ext.data.Operation",b);c.proxy.processResponse=function(j,e,h,d,k,g){var f=this;c.unmask();if(typeof k=="function"){k(e,j,d)}f.afterRequest(h,j)};if(c.fireEvent("beforeload",c,a)!==false){c.loading=true;c.masked=true;c.proxy.headers=b.headers;c.proxy.read(a,b.callback,c)}return c}});Ext.define("OPF.core.utils.MessageUtils",{extend:Ext.util.Observable,alternateClassName:["OPF.Msg"],STATUS_EXCEPTION:"exception",STATUS_VALIDATION_ERROR:"validation",STATUS_ERROR:"error",STATUS_NOTICE:"notice",STATUS_OK:"ok",STATUS_HELP:"help",msgCt:null,constructor:function(a){Ext.onReady(this.onReady,this);OPF.core.utils.MessageUtils.superclass.constructor.call(this,a)},onReady:function(){this.msgCt=Ext.DomHelper.insertFirst(document.body,{id:"msg-div"},true);this.msgCt.setStyle("position","absolute");this.msgCt.setStyle("z-index",99999);this.msgCt.setWidth(300)},setAlert:function(a,d){if(OPF.Cfg.DEBUG_MODE&&OPF.isNotBlank(d)){var c="<ul>";if(Ext.isArray(d)){Ext.each(d,function(e){c+="<li>"+e+"</li>"})}else{c="<li>"+d+"</li>"}c+="</ul>";var b=d.length/13.3;if(b<3){b=3}else{if(b>9){b=9}}b=b*1000;this.msgCt.alignTo(document,"t-t");Ext.DomHelper.append(this.msgCt,{html:this.buildMessageBox(a,c)},true).slideIn("t").ghost("t",{delay:b,remove:true})}},buildMessageBox:function(b,a){switch(b){case true:b=this.STATUS_OK;break;case false:b=this.STATUS_ERROR;break}return['<div class="app-msg">','<div class="x-box-tl"><div class="x-box-tr"><div class="x-box-tc"></div></div></div>','<div class="x-box-ml"><div class="x-box-mr"><div class="x-box-mc"><h3 class="x-icon-text icon-status-'+b+'">',b,"</h3>",a,"</div></div></div>",'<div class="x-box-bl"><div class="x-box-br"><div class="x-box-bc"></div></div></div>',"</div>"].join("")},decodeStatusIcon:function(a){var b="";switch(a){case true:case this.STATUS_OK:b=this.ICON_OK;break;case this.STATUS_NOTICE:b=this.ICON_NOTICE;break;case false:case this.STATUS_ERROR:b=this.ICON_ERROR;break;case this.STATUS_HELP:b=this.ICON_HELP;break}return b}});OPF.Msg=new OPF.core.utils.MessageUtils({});Ext.define("OPF.core.utils.ModelHelper",{statics:{getCompositeId:function(a,d,c){var b=[];if(a){if(c&&a.raw){a=this.createModelFromData(a,a.raw)}Ext.each(d,function(g){var f=a.associations.get(g);if(f){b.push(g);var e=Ext.create(f.model);var h=OPF.ModelHelper.getFk(a,g,e.idProperty);b.push(h)}})}return b.join("/")},getProperty:function(c,a){if(!a){Ext.log.warn("Empty complex property sent in for a getRecord call!");return}var d;if(Ext.isArray(a)){d=a}else{d=a.split(".")}if(d.length==1){var f=c.get(d[0]);if(f===null||f===undefined){f=OPF.ModelHelper.getFk(c,d[0],null)}return f}else{var b=c.associations.get(d[0]);if(b){var e=c[b.instanceName];if(e){d=d.splice(1);return OPF.ModelHelper.getProperty(e,d)}}}},getFk:function(c,d,b){if(!c){return}var a=c.associations.get(d);if(a){if(a.instanceName&&c[a.instanceName]){var f=c["get"+d]();if(f&&b){var e=f.get(b);if(e===null||e===undefined){e=OPF.ModelHelper.getFk(f,b)}return e}else{return f}}}},setFk:function(c,e,b,d){if(!c){return}var a=c.associations.get(e);if(a){if(a.instanceName&&c["get"+e]){var f=c["get"+e]();f.set(b,d);return}}Ext.log.warn("Could not find an appropriate record in the store to set!")},setFkModel:function(b,e,d,c){if(!b){return}var a=b.associations.get(e);if(a&&a.instanceName&&b["get"+e]){if(c){b[a.instanceName]=d}else{b[a.instanceName]=OPF.ModelHelper.createModelFromData(a.model,d)}}},createModelFromData:function(b,d){if(Ext.isString(b)){var a=Ext.create("Ext.data.reader.Json",{model:b});var c=a.read(d);b=c.records[0]}Ext.each(b.associations.items,function(f){var e=Ext.create(f.model);var j=d[f.name];if(j){if(f.type=="belongsTo"){b[f.instanceName]=OPF.ModelHelper.createModelFromData(f.model,j)}else{if(f.type=="hasMany"){var h=[];Ext.each(j,function(l){var k=OPF.ModelHelper.createModelFromData(f.model,l);h.push(k)});var g=Ext.create("Ext.data.Store",{model:f.model});g.add(h);b[f.name+"Store"]=g}}}});return b},createAssociationProperty:function(){},getModelDataFromStore:function(b){var d=[];var a=b.getRange();for(var c=0;c<a.length;c++){d.push(a[c].getData(true))}return d},getData:function(b,d,h){var a=b.fields.items,j=a.length,g={},c,e;for(e=0;e<j;e++){if(a[e].persist!==false||h){c=a[e].name;g[c]=b.get(c)}}if(d===true){Ext.apply(g,OPF.ModelHelper.getAssociatedData(b,{},1,h))}return g},getAssociatedData:function(c,z,B,n){var v=c.associations.items,f=v.length,A={},r=[],y=[],m=[],q,b,a,p,g,l,k,x,h,d,u,s,e,C;for(u=0;u<f;u++){d=v[u];x=d.associationId;k=z[x];if(k&&k!==B){continue}z[x]=B;e=d.type;C=d.name;if(e=="hasMany"){q=c[d.storeName];A[C]=[];if(q&&q.getCount()>0){b=q.data.items;h=b.length;for(s=0;s<h;s++){a=b[s];A[C][s]=OPF.ModelHelper.getData(a,false,n);r.push(a);y.push(C);m.push(s)}}}else{if(e=="belongsTo"||e=="hasOne"){a=c[d.instanceName];if(a!==undefined){A[C]=OPF.ModelHelper.getData(a,false,n);r.push(a);y.push(C);m.push(-1)}}}}for(u=0,h=r.length;u<h;++u){a=r[u];p=A[y[u]];g=m[u];l=OPF.ModelHelper.getAssociatedData(a,z,B+1,n);if(g===-1){Ext.apply(p,l)}else{Ext.apply(p[g],l)}}return A}}});OPF.ModelHelper=OPF.core.utils.ModelHelper;Ext.define("OPF.core.utils.NavigationMenuRegister",{navigationElements:[],add:function(a){this.navigationElements.push(a)},findByLookup:function(a){var b=null;Ext.each(this.navigationElements,function(c){if(c.lookup==a){b=c}});return b}});OPF.NavigationMenuRegister=new OPF.core.utils.NavigationMenuRegister();Ext.data.Connection.securedCallback=function(b,d,a){if(a.status==403||a.status==406){var c=a.status==403?"Guest user tries to perform secured action</br>or Your session has timed out.</br> Please, login to the system.":"You are no longer logged in to the system.</br>Please, provide your username and password to resume work.";Ext.MessageBox.show({title:"Warning",msg:c,closable:false,buttons:Ext.MessageBox.OK,fn:function(){document.location=OPF.Cfg.OPF_CONSOLE_URL+"/console/logout"},animEl:"elId",icon:Ext.MessageBox.WARNING})}else{if(a.status==401){Ext.Msg.show({title:"Warning",msg:"Not enough permissions.",closable:false,buttons:Ext.Msg.OK,fn:function(){},animEl:"elId",icon:Ext.MessageBox.WARNING})}else{if(OPF.isNotEmpty(b.clientCallback)){Ext.callback(b.clientCallback,this,arguments)}}}};Ext.override(Ext.data.Connection,{request:function(k){k=k||{};if(OPF.isNotEmpty(k.callback)){k.clientCallback=k.callback}k.callback=Ext.data.Connection.securedCallback;var f=this,j=k.scope||window,e=k.username||f.username,g=k.password||f.password||"",b,c,d,a,h;if(f.fireEvent("beforerequest",f,k)!==false){c=f.setOptions(k,j);if(this.isFormUpload(k)===true){this.upload(k.form,c.url,c.data,k);return null}if(k.autoAbort===true||f.autoAbort){f.abort()}if((k.cors===true||f.cors===true)&&Ext.isIE&&Ext.ieVersion>=8){h=new XDomainRequest()}else{h=this.getXhrInstance()}b=k.async!==false?(k.async||f.async):false;if(e){h.open(c.method,c.url,b,e,g)}else{h.open(c.method,c.url,b)}if(k.withCredentials===true||f.withCredentials===true){h.withCredentials=true}a=f.setupHeaders(h,k,c.data,c.params);d={id:++Ext.data.Connection.requestId,xhr:h,headers:a,options:k,async:b,timeout:setTimeout(function(){d.timedout=true;f.abort(d)},k.timeout||f.timeout)};f.requests[d.id]=d;f.latestId=d.id;if(b){h.onreadystatechange=Ext.Function.bind(f.onStateChange,f,[d])}if((k.cors===true||f.cors===true)&&Ext.isIE&&Ext.ieVersion>=8){h.onload=function(){f.onComplete(d)}}h.send(c.data);if(!b){return this.onComplete(d)}return d}else{Ext.callback(k.callback,k.scope,[k,undefined,undefined]);return null}}});String.prototype.startsWith=function(a){return(this.match("^"+a)==a)};String.prototype.trim=function(){return(this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,""))};SQGetIntValue=function(c){var b=Ext.getCmp(c);try{return parseInt(b.getValue())}catch(a){return 0}};SQCopyValue=function(c,d){var b=SQGetIntValue(c);var a=Ext.getCmp(d);a.setValue(b)};SQSetAsRequired=function(c,a){var b=Ext.getCmp(c);b.allowBlank=false;if(a){b.setValue(a)}};SQSetAsOptional=function(c,a){var b=Ext.getCmp(c);b.allowBlank=true;if(a){b.setValue(a)}};var sqCopyObjectValue=function(d,e){var c=Ext.getCmp(d);var a=Ext.getCmp(e);try{a.setValue(c.getValue())}catch(b){a.setValue(null)}};var sqUnmaskForm=function(a){if(OPF.isNotEmpty(a)&&OPF.isNotEmpty(a.getEl())&&a.getEl().isMasked()){a.getEl().unmask()}};var sqUnmaskAndResetForm=function(a){if(OPF.isNotEmpty(a)){sqUnmaskForm(a);a.getForm().reset()}};var sqTrim=function(a){return OPF.isEmpty(a)?a:a.replace(/^\s*/,"").replace(/\s*$/,"")};var cutting=function(a,b){if(OPF.isNotEmpty(a)){if(a.length>b){a=a.substring(0,b-3)+"..."}}return a};var reverse=function(d){if(d==null){return}var c=0;var a=d.length-1;var b;while(a>c){b=d[a];d[a]=d[c];d[c]=b;a--;c++}return d};var URL_CHECK_REGEXP=new RegExp().compile("^(http|https)://([\\w-]+\\.)+[\\w-]+(:\\d{1,5})?(/[\\w- ./?%&=]*)?$");function urlCheck(a){return URL_CHECK_REGEXP.test(a)}var cloneDate=function(a){if(isEmpty(a)){return null}var b=new Date();b.setTime(a.getTime());return b};var sqDateFromHidden=function(a){if(isEmpty(a)){return null}return sqStrToDate(Ext.getCmp(a).getValue())};var sqStrToDate=function(c){var b=Date.parse(c);var a=new Date();a.setTime(b);return a};var sqMillisecondToDate=function(b){var a=new Date();a.setTime(b);return a};var sqStrToInt=function(c){var a;try{a=parseInt(c)}catch(b){a=0}return a};var sqTranslatedDate=function(a,c){if(isEmpty(a)){return null}if(isNotEmpty(c)&&Ext.isString(c)&&sqTrim(c)!=""){var b=sqFormattedDate(a)+" "+c;return sqStrToDate(b)}else{return a}};var sqGetTime=function(a){if(isEmpty(a)||!Ext.isDate(a)){return null}return sqFormattedDate(a,"h:i A")};var sqFormattedDate=function(){if(arguments.length==0){return(new Date()).format("m/d/Y")}else{if(arguments.length<=2){if(Ext.isDate(arguments[0])){var a=arguments.length==2&&Ext.isString(arguments[1])?arguments[1]:"m/d/Y";return Ext.Date.format(arguments[0],a)}}}return null};var sqFormatDateInMillis=function(a,b){if(isEmpty(a)){return""}return sqFormattedDate(new Date(a),b)};var sqFormatDateForJerseyParser=function(a){if(!Ext.isDate(a)){a=new Date(a)}return a.format("Y-m-d\\TH:i:s.000O")};SqParseTreeEntityId=function(b){var a=new RegExp(/xnode-(\w+)-(\d+)/g);return a.exec(b)};SqGetIdFromTreeEntityId=function(b){var a=SqParseTreeEntityId(b);if(a!=null&&a.length==3){return a[2]}return null};SqGetTypeFromTreeEntityId=function(b){var a=SqParseTreeEntityId(b);if(a!=null&&a.length==3){return a[1]}return null};var sqSetValue=function(c,a){if(isNotEmpty(c)){var b=Ext.getCmp(c);b.setValue(a)}};var sqValueToNull=function(a){sqSetValue(a,null)};var sqSetDisabled=function(c,a){if(isNotEmpty(c)&&isNotEmpty(a)){var b;if(isNotEmpty(b=Ext.getCmp(c))){b.setDisabled(a);return true}}return false};var sqSetBatchEnabled=function(b,a){if(isNotEmpty(b)&&Ext.isArray(a)){var c=b!=true;for(i=0;i<a.length;i++){sqSetDisabled(a[i],c)}}};var sqIndexOf=function(c,b){for(var a=0;a<c.length;a++){if(c[a]==b){return a}}return -1};var sqSetFormFieldVisibility=function(b,c){if(isNotEmpty(b)&&isNotEmpty(c)){if(c){b.enable()}else{b.disable()}b.show();var a=b.getEl();if(a){b.getEl().up(".x-form-item").setDisplayed(c)}}};var sqSetComboValue=function(a,b){if(isNotEmpty(b)){var c=Ext.getCmp(a);if(isNotEmpty(c)){c.store.load();c.setValue(b);return true}}return false};var sqInitializeTabbedFormPanel=function(e,c){if(isNotEmpty(e)){var d=Ext.getCmp(e);if(isNotEmpty(d)){var f=d.items;if(isNotEmpty(f)&&f.length>0){Ext.each(f,function(h,g){d.setActiveTab(h)});var b=isEmpty(c)||c<0||c>=f.length?0:c;var a=d.getComponent(b);d.setActiveTab(a)}}}};var sqAjaxGETRequest=function(b,a,c){Ext.Ajax.request({url:b,method:"GET",success:function(d,e){if(isNotEmpty(a)){a(d)}},failure:function(d){if(isNotEmpty(c)){c(d)}sqShowFailureResponseStatus(d)}})};var sqAjaxPOSTRequest=function(c,b,a,d){sqAjaxRequest(c,b,"POST",a,d)};var sqAjaxPOSTRequest2=function(c,b,a,d){sqAjaxRequest2(c,b,"POST",a,d)};var sqAjaxPUTRequest=function(c,b,a,d){sqAjaxRequest(c,b,"PUT",a,d)};var sqAjaxDELETERequest=function(c,b,a,d){sqAjaxRequest(c,b,"DELETE",a,d)};var sqAjaxRequest=function(c,b,e,a,d){b=isEmpty(b)?"[]":b;Ext.Ajax.request({url:c,method:e,jsonData:b,success:function(f,g){if(isNotEmpty(a)){a(f)}},failure:function(f){if(isNotEmpty(d)){d(f)}sqShowFailureResponseStatus(f)}})};var sqAjaxRequest2=function(c,b,e,a,d){b=isEmpty(b)?"[]":b;Ext.Ajax.request({url:c,method:e,jsonData:b,success:function(f,g){if(isNotEmpty(a)){a(f)}},failure:function(f){if(isNotEmpty(d)){d(f)}sqShowFailureResponseStatus2(f)}})};var sqShowFailureResponseStatus=function(d){if(isNotEmpty(d)){var c;var a=Ext.decode(d.responseText);if(isNotEmpty(a)){if(isNotEmpty(a.errors)){if(Ext.isArray(a.errors)){c="Error"+(a.errors.length==1?"":"s")+":\n";for(var b=0;b<a.errors.length;b++){c+=a.errors[b].msg+"\n"}}else{c="Error:\n"+a.errors.msg}}else{c=a.toString()}}else{c="Error occurred."}Ext.MessageBox.alert("Failure",c)}};var sqShowFailureResponseStatus2=function(d){if(isNotEmpty(d)){var c;var e=Ext.decode(d.responseText);if(isNotEmpty(e)){var a=e.responseStatus;if(isNotEmpty(a)){if(isNotEmpty(a.errors)){if(Ext.isArray(a.errors)){c="Error"+(a.errors.length==1?"":"s")+":\n";for(var b=0;b<a.errors.length;b++){c+=a.errors[b].msg+"\n"}}else{c="Error:\n"+a.errors.msg}}else{c=a.toString()}}else{c="Error occurred."}}Ext.MessageBox.alert("Failure",c)}};var sqDialogCancelAction=function(b,a){Ext.MessageBox.confirm("Cancel Action","All changes will be lost, are you sure?",function(c){if(c[0]=="y"){if(a!=undefined&&a!=null){a()}b.form.getForm().reset();b.contentManager.showGrid()}})};SQCopyMapCoords=function(h,f,a,k,j){var d=Ext.getCmp(h);if(d.getValue()==null){d.setValue(SQMapDefault.lat)}var c=Ext.getCmp(f);if(c.getValue()==null){c.setValue(SQMapDefault.lng)}var e=Ext.getCmp(a);var b=Ext.getCmp(k);var g=Ext.getCmp(j);g.setLatLng(parseFloat(d.getValue()),parseFloat(c.getValue()))};function capitaliseFirstLetter(a){return a.charAt(0).toUpperCase()+a.slice(1)}function isNotEmpty(a){return a!=undefined&&a!=null}function isEmpty(a){return a==undefined||a==null}function isBlank(a){return isEmpty(a)||a.length==0}function isNotBlank(a){return isNotEmpty(a)&&a.length>0}function ifBlank(b,a){if(isNotBlank(b)){return b}return a}function ifEmpty(b,a){if(isNotEmpty(b)){return b}return a}function getJsonOfStore(b){var d=new Array();var a=b.getRange();for(var c=0;c<a.length;c++){d.push(a[c].data)}return d}function shortenTextToDotSeparator(h,b){var e=h;if(h.length>b){var g=h.split(".");var a="";for(var d=g.length-1;d>-1;d--){var c=g[d];var f=(d==g.length-1)?c:c+"."+a;if(f.length<b){a=f}else{break}}if(a!=h){e="..."+a}}return e}function calculateLookup(c,a){var c=ifBlank(c,"");var a=ifBlank(a,"");var d=a.replace(/[\s!"#$%&'()*+,-./:;<=>?@\[\\\]^_`{|}~]+/g,"-");var b=(isNotBlank(c)?c+".":"")+d;return b.toLowerCase()}Ext.define("OPF.core.utils.StoreHelper",{statics:{cloneStore:function(f,e,c,a){if(Ext.isString(f)){f=Ext.StoreManager.get(f)}var b=f.model.modelName;var d=new Ext.data.Store(Ext.apply({model:b,storeId:c},e));OPF.core.utils.StoreHelper.delayUntilLoaded(f,function(){var h=[];var g={};f.each(function(j){if(a){var o=j.get(a);if(g[o]){return}else{g[o]=true}}var k=j.copy();var m=k.associations.items,p,l,q,n,s;for(p=0;p<m.length;p++){l=m[p];s=l.instanceName;n=j[s];if(n){k[s]=n}}h.push(k)});d.loadRecords(h)});return d},copyRecords:function(d,a){if(Ext.isString(d)){d=Ext.StoreManager.get(d)}if(Ext.isString(a)){a=Ext.StoreManager.get(a)}var c=[];var b={};d.each(function(j){var l=j.copy();var h=l.associations.items,g,f,k,e;for(g=0;g<h.length;g++){f=h[g];e=f.instanceName;k=j[e];if(k){l[e]=k}}c.push(l)});a.loadRecords(c)},delayUntilLoaded:function(a,f,e){var b=0;if(!Ext.isArray(a)){a=[a]}function g(){b--;if(b<=0){f.apply(e,a)}}for(var c=0;c<a.length;c++){var d=a[c];if(Ext.isString(d)){d=Ext.StoreManager.get(d)}else{if(Ext.isFunction(d)){if(!d(g,undefiend)){b++}break}}if(d.getCount()==0||d.loading){b++;d.on("load",g,undefined,{single:true})}}if(b==0){f.apply(e,a)}}}});OPF.StoreHelper=OPF.core.utils.StoreHelper;Ext.override(Ext.data.Model,{copy:function(){var a=this,b=this.callParent(arguments);Ext.each(this.associations.items,function(d){if(d.type=="belongsTo"){var c=Ext.create(d.model);b[d.instanceName]=a[d.instanceName]}else{if(d.type=="hasMany"){var f=a[d.name+"Store"].getRange();var e=Ext.create("Ext.data.Store",{model:d.model});e.add(f);b[d.name+"Store"]=e}}});return b}});Ext.define("OPF.core.utils.progressbar.ProgressBarDialog",{extend:Ext.window.Window,id:"socketProgressBar",modal:true,closable:true,closeAction:"hide",resizable:false,cls:"wizard-progress-bar",width:400,title:"Progress ...",logs:[],constructor:function(b,a){a=a||{};OPF.core.utils.progressbar.ProgressBarDialog.superclass.constructor.call(this,Ext.apply({},a))},initComponent:function(){var a=this;this.progressBar=new Ext.ProgressBar({text:"Initializing..."});this.logStatusField=Ext.create("Ext.container.Container",{height:200,autoScroll:true});this.logStatusPanel=Ext.create("Ext.panel.Panel",{title:"More information",collapsible:true,width:388,layout:"fit",hidden:true,items:[this.logStatusField]});this.items=[this.progressBar,this.logStatusPanel];this.setupComponent();this.callParent(arguments)},listeners:{beforeshow:function(a){a.resetProgressBar()},beforeclose:function(a){a.resetProgressBar();interruptProgress()}},setupComponent:function(){},showStatus:function(c,b,a){if(!this.isVisible()){this.show()}consoleLog("Progress status is "+c+"% - "+a+": "+b);c=c/100;if(c>1){c=1}this.progressBar.updateProgress(c,b,true);this.addLog(b,a)},showCompletedStatus:function(b,a){if(!this.isVisible()){this.show()}consoleLog("Progress status is 100% - "+a+": "+b);this.progressBar.updateProgress(1,b,true);this.addLog(b,a);if(this.logStatusPanel.collapsed||!this.logStatusPanel.isVisible()){this.resetProgressBar();this.close()}},showErrorMessage:function(a){if(this.logStatusPanel.collapsed){this.resetProgressBar();this.close();OPF.Msg.setAlert(false,a)}else{this.addLog(a,"ERROR")}},resetProgressBar:function(){this.logs=[];this.progressBar.reset();this.logStatusField.removeAll()},addLog:function(d,a){var c=this;if(this.logStatusPanel.isVisible()){var e=OPF.isNotBlank(a)?a.toLowerCase():"none";var b=Ext.create("Ext.container.Container",{autoEl:{tag:"div",html:d},cls:"progress-bar-"+e});this.logs.push(b);if(OPF.isNotEmpty(this.logStatusField.el)){Ext.each(this.logs,function(g){c.logStatusField.add(g)});this.logs=[];var f=this.logStatusField.el.dom;f.scrollTop=f.scrollHeight}}},setLogVisible:function(a){this.logStatusPanel.setVisible(a&&OPF.Cfg.DEBUG_MODE)}});OPF.core.utils.progressbar.ProgressBarDialog.get=function(){var a=Ext.WindowMgr.get("socketProgressBar");if(OPF.isEmpty(a)){a=Ext.create("OPF.core.utils.progressbar.ProgressBarDialog");Ext.WindowMgr.register(a)}return a};var ajaxSuccessFunction;var ajaxFailureFunction;var isInterrupted=false;var AJAX_STRATEGY="ajax";var FLASH_STRATEGY="flash";var PROGRESS_BAR_STRATEGY=AJAX_STRATEGY;function consoleLog(a){if((Ext.isGecko||Ext.isChrome)&&OPF.Cfg.DEBUG_MODE){console.log(a)}}function onConnected(){PROGRESS_BAR_STRATEGY=FLASH_STRATEGY;consoleLog("onConnected "+new Date())}function onDisconnected(){PROGRESS_BAR_STRATEGY=AJAX_STRATEGY;consoleLog("onDisconnected "+new Date())}function onError(a){consoleLog("onError: "+a)}function onMessage(data){var responseData=eval("("+data+")");consoleLog("onMessage: "+data);performProgressBar(responseData)}function loadProgress(b,a){if(!isInterrupted||a){isInterrupted=false;Ext.Ajax.request({url:OPF.Cfg.restUrl("progress/status",b),method:"GET",success:function(c,g){consoleLog("Load Progress success: "+c.responseText);var e=Ext.decode(c.responseText);var d=e.data;var f=!isInterrupted;Ext.each(d,function(j){f&=performProgressBar(j)});if(f){new Ext.util.DelayedTask(function(){loadProgress(b,false)}).delay(500)}else{consoleLog("Close progress bar");var h=OPF.core.utils.progressbar.ProgressBarDialog.get();h.close()}},failure:function(c){consoleLog("Load Progress failure: "+c);OPF.Msg.setAlert(false,c.message);var d=OPF.core.utils.progressbar.ProgressBarDialog.get();d.close();ajaxFailureFunction(c)}})}else{isInterrupted=false}}function interruptProgress(){isInterrupted=true}function performProgressBar(c){var a;var d=OPF.core.utils.progressbar.ProgressBarDialog.get();if(c.data&&c.data[0].dtoName=="net.firejack.platform.web.mina.bean.Status"){if(c.data[0].type=="ERROR"){d.showErrorMessage(c.message);ajaxFailureFunction({message:c.message,success:false});a=false}else{if(c.data[0].type=="STARTED"){d.setLogVisible(c.data[0].showLogs)}d.showStatus(c.data[0].percent,c.data[0].title,c.data[0].logLevel);a=true}}else{var b={responseText:"("+Ext.JSON.encode(c)+")"};consoleLog("Execute ajax function: "+c.success);if(c.success){d.showCompletedStatus(c.message,null);ajaxSuccessFunction(b)}else{d.showErrorMessage(c.message);ajaxFailureFunction(b)}a=false}return a}Ext.override(Ext.form.Basic,{doAction:function(b,a){if(!(/Page-UID=/g.test(this.url))){this.url+=/\?/g.test(this.url)?"&":"?";this.url+="Page-UID="+OPF.Cfg.PAGE_UID}if(Ext.isString(b)){b=Ext.ClassManager.instantiateByAlias("formaction."+b,Ext.apply({},a,{form:this}))}if(this.fireEvent("beforeaction",this,b)!==false){b.options=a;this.beforeAction(b);Ext.defer(b.run,100,b)}return this},beforeAction:function(g){if(OPF.isNotEmpty(this.items)){for(var d=0;d<this.items.length;d++){for(var c=0;c<this.items[d].length;c++){var e=this.items[d][c];if(e.isFormField&&e.syncValue){e.syncValue()}}}}var b=g.options;if(b){if(b.waitMsg){if(this.waitMsgTarget===true){this.el.mask(b.waitMsg,"x-mask-loading")}else{if(this.waitMsgTarget){this.waitMsgTarget=Ext.get(this.waitMsgTarget);this.waitMsgTarget.mask(b.waitMsg,"x-mask-loading")}else{Ext.MessageBox.wait(b.waitMsg,b.waitTitle||this.waitTitle)}}}if(b.success){ajaxSuccessFunction=function(f){var j={response:f};b.success(this,j)}}if(b.failure){ajaxFailureFunction=function(f){var j={response:f};b.failure(this,j)}}if(PROGRESS_BAR_STRATEGY==AJAX_STRATEGY){var h=g.form.url.startsWith(OPF.Cfg.BASE_URL);var a=g.form.url.startsWith(OPF.Cfg.OPF_CONSOLE_URL);loadProgress(h&&!a,true)}}},afterAction:function(c,e){this.activeAction=null;var a=c.options;if(a.waitMsg){if(this.waitMsgTarget===true){this.el.unmask()}else{if(this.waitMsgTarget){this.waitMsgTarget.unmask()}else{Ext.MessageBox.updateProgress(1);Ext.MessageBox.hide()}}}var d=OPF.core.utils.progressbar.ProgressBarDialog.get();var b=Ext.decode(c.response.responseText);if(b.data&&b.data[0].dtoName=="net.firejack.platform.web.mina.bean.Status"){if(b.data[0].type=="ERROR"){if(PROGRESS_BAR_STRATEGY==AJAX_STRATEGY){interruptProgress()}d.showErrorMessage(b.message)}else{if(b.data[0].type=="STARTED"){d.setLogVisible(b.data[0].showLogs)}d.showStatus(b.data[0].percent,b.data[0].title,b.data[0].logLevel)}}else{if(e){if(a.reset){this.reset()}d.showCompletedStatus(b.message,"UPLOAD");Ext.callback(a.success,a.scope,[this,c]);this.fireEvent("actioncomplete",this,c)}else{d.showErrorMessage(b.message);Ext.callback(a.failure,a.scope,[this,c]);this.fireEvent("actionfailed",this,c)}if(PROGRESS_BAR_STRATEGY==AJAX_STRATEGY){interruptProgress()}}}});Ext.override(Ext.data.Connection,{onComplete:function(request){var me=this,options=request.options,result,success,response;try{result=me.parseStatus(request.xhr.status)}catch(e){result={success:false,isException:false}}success=result.success;if(success){response=me.createResponse(request);me.fireEvent("requestcomplete",me,response,options);var responseData=eval("("+OPF.ifBlank(response.responseText,"{}")+")");var progressData;if(OPF.isNotEmpty(responseData.data)){progressData=responseData.data[0]}if(OPF.isNotEmpty(progressData)&&progressData.dtoName=="net.firejack.platform.web.mina.bean.Status"){var progressBar=OPF.core.utils.progressbar.ProgressBarDialog.get();if(progressData.type=="ERROR"){progressBar.showErrorMessage(responseData.message)}else{if(responseData.data[0].type=="STARTED"){progressBar.setLogVisible(responseData.data[0].showLogs)}progressBar.showStatus(progressData.percent,progressData.title,progressData.logLevel);if(PROGRESS_BAR_STRATEGY==AJAX_STRATEGY){var isBaseUrl=options.url.startsWith(OPF.Cfg.BASE_URL);var isOPFUrl=options.url.startsWith(OPF.Cfg.OPF_CONSOLE_URL);loadProgress(isBaseUrl&&!isOPFUrl,true)}}if(options.success){ajaxSuccessFunction=options.success}if(options.failure){ajaxFailureFunction=options.failure}}else{Ext.callback(options.success,options.scope,[response,options])}}else{if(result.isException||request.aborted||request.timedout){response=me.createException(request)}else{response=me.createResponse(request)}me.fireEvent("requestexception",me,response,options);Ext.callback(options.failure,options.scope,[response,options])}Ext.callback(options.callback,options.scope,[options,success,response]);delete me.requests[request.id];return response}});var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(e,d,f){if(e!=null){if("number"==typeof e){this.fromNumber(e,d,f)}else{if(d==null&&"string"!=typeof e){this.fromString(e,256)}else{this.fromString(e,d)}}}}function nbi(){return new BigInteger(null)}function am1(f,a,b,e,h,g){while(--g>=0){var d=a*this[f++]+b[e]+h;h=Math.floor(d/67108864);b[e++]=d&67108863}return h}function am2(f,q,r,e,o,a){var k=q&32767,p=q>>15;while(--a>=0){var d=this[f]&32767;var g=this[f++]>>15;var b=p*d+g*k;d=k*d+((b&32767)<<15)+r[e]+(o&1073741823);o=(d>>>30)+(b>>>15)+p*g+(o>>>30);r[e++]=d&1073741823}return o}function am3(f,q,r,e,o,a){var k=q&16383,p=q>>14;while(--a>=0){var d=this[f]&16383;var g=this[f++]>>14;var b=p*d+g*k;d=k*d+((b&16383)<<14)+r[e]+o;o=(d>>28)+(b>>14)+p*g;r[e++]=d&268435455}return o}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(a){return BI_RM.charAt(a)}function intAt(b,a){var d=BI_RC[b.charCodeAt(a)];return(d==null)?-1:d}function bnpCopyTo(b){for(var a=this.t-1;a>=0;--a){b[a]=this[a]}b.t=this.t;b.s=this.s}function bnpFromInt(a){this.t=1;this.s=(a<0)?-1:0;if(a>0){this[0]=a}else{if(a<-1){this[0]=a+DV}else{this.t=0}}}function nbv(a){var b=nbi();b.fromInt(a);return b}function bnpFromString(h,c){var e;if(c==16){e=4}else{if(c==8){e=3}else{if(c==256){e=8}else{if(c==2){e=1}else{if(c==32){e=5}else{if(c==4){e=2}else{this.fromRadix(h,c);return}}}}}}this.t=0;this.s=0;var g=h.length,d=false,f=0;while(--g>=0){var a=(e==8)?h[g]&255:intAt(h,g);if(a<0){if(h.charAt(g)=="-"){d=true}continue}d=false;if(f==0){this[this.t++]=a}else{if(f+e>this.DB){this[this.t-1]|=(a&((1<<(this.DB-f))-1))<<f;this[this.t++]=(a>>(this.DB-f))}else{this[this.t-1]|=a<<f}}f+=e;if(f>=this.DB){f-=this.DB}}if(e==8&&(h[0]&128)!=0){this.s=-1;if(f>0){this[this.t-1]|=((1<<(this.DB-f))-1)<<f}}this.clamp();if(d){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var a=this.s&this.DM;while(this.t>0&&this[this.t-1]==a){--this.t}}function bnToString(c){if(this.s<0){return"-"+this.negate().toString(c)}var e;if(c==16){e=4}else{if(c==8){e=3}else{if(c==2){e=1}else{if(c==32){e=5}else{if(c==4){e=2}else{return this.toRadix(c)}}}}}var g=(1<<e)-1,l,a=false,h="",f=this.t;var j=this.DB-(f*this.DB)%e;if(f-->0){if(j<this.DB&&(l=this[f]>>j)>0){a=true;h=int2char(l)}while(f>=0){if(j<e){l=(this[f]&((1<<j)-1))<<(e-j);l|=this[--f]>>(j+=this.DB-e)}else{l=(this[f]>>(j-=e))&g;if(j<=0){j+=this.DB;--f}}if(l>0){a=true}if(a){h+=int2char(l)}}}return a?h:"0"}function bnNegate(){var a=nbi();BigInteger.ZERO.subTo(this,a);return a}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(b){var d=this.s-b.s;if(d!=0){return d}var c=this.t;d=c-b.t;if(d!=0){return d}while(--c>=0){if((d=this[c]-b[c])!=0){return d}}return 0}function nbits(a){var c=1,b;if((b=a>>>16)!=0){a=b;c+=16}if((b=a>>8)!=0){a=b;c+=8}if((b=a>>4)!=0){a=b;c+=4}if((b=a>>2)!=0){a=b;c+=2}if((b=a>>1)!=0){a=b;c+=1}return c}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(c,b){var a;for(a=this.t-1;a>=0;--a){b[a+c]=this[a]}for(a=c-1;a>=0;--a){b[a]=0}b.t=this.t+c;b.s=this.s}function bnpDRShiftTo(c,b){for(var a=c;a<this.t;++a){b[a-c]=this[a]}b.t=Math.max(this.t-c,0);b.s=this.s}function bnpLShiftTo(j,e){var b=j%this.DB;var a=this.DB-b;var g=(1<<a)-1;var f=Math.floor(j/this.DB),h=(this.s<<b)&this.DM,d;for(d=this.t-1;d>=0;--d){e[d+f+1]=(this[d]>>a)|h;h=(this[d]&g)<<b}for(d=f-1;d>=0;--d){e[d]=0}e[f]=h;e.t=this.t+f+1;e.s=this.s;e.clamp()}function bnpRShiftTo(g,d){d.s=this.s;var e=Math.floor(g/this.DB);if(e>=this.t){d.t=0;return}var b=g%this.DB;var a=this.DB-b;var f=(1<<b)-1;d[0]=this[e]>>b;for(var c=e+1;c<this.t;++c){d[c-e-1]|=(this[c]&f)<<a;d[c-e]=this[c]>>b}if(b>0){d[this.t-e-1]|=(this.s&f)<<a}d.t=this.t-e;d.clamp()}function bnpSubTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]-d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g-=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g-=d[e];f[e++]=g&this.DM;g>>=this.DB}g-=d.s}f.s=(g<0)?-1:0;if(g<-1){f[e++]=this.DV+g}else{if(g>0){f[e++]=g}}f.t=e;f.clamp()}function bnpMultiplyTo(c,e){var b=this.abs(),f=c.abs();var d=b.t;e.t=d+f.t;while(--d>=0){e[d]=0}for(d=0;d<f.t;++d){e[d+b.t]=b.am(0,f[d],e,d,0,b.t)}e.s=0;e.clamp();if(this.s!=c.s){BigInteger.ZERO.subTo(e,e)}}function bnpSquareTo(d){var a=this.abs();var b=d.t=2*a.t;while(--b>=0){d[b]=0}for(b=0;b<a.t-1;++b){var e=a.am(b,a[b],d,2*b,0,1);if((d[b+a.t]+=a.am(b+1,2*a[b],d,2*b+1,e,a.t-b-1))>=a.DV){d[b+a.t]-=a.DV;d[b+a.t+1]=1}}if(d.t>0){d[d.t-1]+=a.am(b,a[b],d,2*b,0,1)}d.s=0;d.clamp()}function bnpDivRemTo(n,h,g){var x=n.abs();if(x.t<=0){return}var k=this.abs();if(k.t<x.t){if(h!=null){h.fromInt(0)}if(g!=null){this.copyTo(g)}return}if(g==null){g=nbi()}var d=nbi(),a=this.s,l=n.s;var v=this.DB-nbits(x[x.t-1]);if(v>0){x.lShiftTo(v,d);k.lShiftTo(v,g)}else{x.copyTo(d);k.copyTo(g)}var p=d.t;var b=d[p-1];if(b==0){return}var o=b*(1<<this.F1)+((p>1)?d[p-2]>>this.F2:0);var B=this.FV/o,A=(1<<this.F1)/o,z=1<<this.F2;var u=g.t,s=u-p,f=(h==null)?nbi():h;d.dlShiftTo(s,f);if(g.compareTo(f)>=0){g[g.t++]=1;g.subTo(f,g)}BigInteger.ONE.dlShiftTo(p,f);f.subTo(d,d);while(d.t<p){d[d.t++]=0}while(--s>=0){var c=(g[--u]==b)?this.DM:Math.floor(g[u]*B+(g[u-1]+z)*A);if((g[u]+=d.am(0,c,g,s,0,p))<c){d.dlShiftTo(s,f);g.subTo(f,g);while(g[u]<--c){g.subTo(f,g)}}}if(h!=null){g.drShiftTo(p,h);if(a!=l){BigInteger.ZERO.subTo(h,h)}}g.t=p;g.clamp();if(v>0){g.rShiftTo(v,g)}if(a<0){BigInteger.ZERO.subTo(g,g)}}function bnMod(b){var c=nbi();this.abs().divRemTo(b,null,c);if(this.s<0&&c.compareTo(BigInteger.ZERO)>0){b.subTo(c,c)}return c}function Classic(a){this.m=a}function cConvert(a){if(a.s<0||a.compareTo(this.m)>=0){return a.mod(this.m)}else{return a}}function cRevert(a){return a}function cReduce(a){a.divRemTo(this.m,null,a)}function cMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}function cSqrTo(a,b){a.squareTo(b);this.reduce(b)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var a=this[0];if((a&1)==0){return 0}var b=a&3;b=(b*(2-(a&15)*b))&15;b=(b*(2-(a&255)*b))&255;b=(b*(2-(((a&65535)*b)&65535)))&65535;b=(b*(2-a*b%this.DV))%this.DV;return(b>0)?this.DV-b:-b}function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(a.DB-15))-1;this.mt2=2*a.t}function montConvert(a){var b=nbi();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);if(a.s<0&&b.compareTo(BigInteger.ZERO)>0){this.m.subTo(b,b)}return b}function montRevert(a){var b=nbi();a.copyTo(b);this.reduce(b);return b}function montReduce(a){while(a.t<=this.mt2){a[a.t++]=0}for(var c=0;c<this.m.t;++c){var b=a[c]&32767;var d=(b*this.mpl+(((b*this.mph+(a[c]>>15)*this.mpl)&this.um)<<15))&a.DM;b=c+this.m.t;a[b]+=this.m.am(0,d,a,c,0,this.m.t);while(a[b]>=a.DV){a[b]-=a.DV;a[++b]++}}a.clamp();a.drShiftTo(this.m.t,a);if(a.compareTo(this.m)>=0){a.subTo(this.m,a)}}function montSqrTo(a,b){a.squareTo(b);this.reduce(b)}function montMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(h,j){if(h>4294967295||h<1){return BigInteger.ONE}var f=nbi(),a=nbi(),d=j.convert(this),c=nbits(h)-1;d.copyTo(f);while(--c>=0){j.sqrTo(f,a);if((h&(1<<c))>0){j.mulTo(a,d,f)}else{var b=f;f=a;a=b}}return j.revert(f)}function bnModPowInt(b,a){var c;if(b<256||a.isEven()){c=new Classic(a)}else{c=new Montgomery(a)}return this.exp(b,c)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var a=nbi();this.copyTo(a);return a}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(c){if(c==null){c=10}if(this.signum()==0||c<2||c>36){return"0"}var f=this.chunkSize(c);var e=Math.pow(c,f);var j=nbv(e),k=nbi(),h=nbi(),g="";this.divRemTo(j,k,h);while(k.signum()>0){g=(e+h.intValue()).toString(c).substr(1)+g;k.divRemTo(j,k,h)}return h.intValue().toString(c)+g}function bnpFromRadix(m,h){this.fromInt(0);if(h==null){h=10}var f=this.chunkSize(h);var g=Math.pow(h,f),e=false,a=0,l=0;for(var c=0;c<m.length;++c){var k=intAt(m,c);if(k<0){if(m.charAt(c)=="-"&&this.signum()==0){e=true}continue}l=h*l+k;if(++a>=f){this.dMultiply(g);this.dAddOffset(l,0);a=0;l=0}}if(a>0){this.dMultiply(Math.pow(h,a));this.dAddOffset(l,0)}if(e){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(f,e,h){if("number"==typeof e){if(f<2){this.fromInt(1)}else{this.fromNumber(f,h);if(!this.testBit(f-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>f){this.subTo(BigInteger.ONE.shiftLeft(f-1),this)}}}}else{var d=new Array(),g=f&7;d.length=(f>>3)+1;e.nextBytes(d);if(g>0){d[0]&=((1<<g)-1)}else{d[0]=0}this.fromString(d,256)}}function bnToByteArray(){var b=this.t,c=new Array();c[0]=this.s;var e=this.DB-(b*this.DB)%8,f,a=0;if(b-->0){if(e<this.DB&&(f=this[b]>>e)!=(this.s&this.DM)>>e){c[a++]=f|(this.s<<(this.DB-e))}while(b>=0){if(e<8){f=(this[b]&((1<<e)-1))<<(8-e);f|=this[--b]>>(e+=this.DB-8)}else{f=(this[b]>>(e-=8))&255;if(e<=0){e+=this.DB;--b}}if((f&128)!=0){f|=-256}if(a==0&&(this.s&128)!=(f&128)){++a}if(a>0||f!=this.s){c[a++]=f}}}return c}function bnEquals(b){return(this.compareTo(b)==0)}function bnMin(b){return(this.compareTo(b)<0)?this:b}function bnMax(b){return(this.compareTo(b)>0)?this:b}function bnpBitwiseTo(c,h,e){var d,g,b=Math.min(c.t,this.t);for(d=0;d<b;++d){e[d]=h(this[d],c[d])}if(c.t<this.t){g=c.s&this.DM;for(d=b;d<this.t;++d){e[d]=h(this[d],g)}e.t=this.t}else{g=this.s&this.DM;for(d=b;d<c.t;++d){e[d]=h(g,c[d])}e.t=c.t}e.s=h(this.s,c.s);e.clamp()}function op_and(a,b){return a&b}function bnAnd(b){var c=nbi();this.bitwiseTo(b,op_and,c);return c}function op_or(a,b){return a|b}function bnOr(b){var c=nbi();this.bitwiseTo(b,op_or,c);return c}function op_xor(a,b){return a^b}function bnXor(b){var c=nbi();this.bitwiseTo(b,op_xor,c);return c}function op_andnot(a,b){return a&~b}function bnAndNot(b){var c=nbi();this.bitwiseTo(b,op_andnot,c);return c}function bnNot(){var b=nbi();for(var a=0;a<this.t;++a){b[a]=this.DM&~this[a]}b.t=this.t;b.s=~this.s;return b}function bnShiftLeft(b){var a=nbi();if(b<0){this.rShiftTo(-b,a)}else{this.lShiftTo(b,a)}return a}function bnShiftRight(b){var a=nbi();if(b<0){this.lShiftTo(-b,a)}else{this.rShiftTo(b,a)}return a}function lbit(a){if(a==0){return -1}var b=0;if((a&65535)==0){a>>=16;b+=16}if((a&255)==0){a>>=8;b+=8}if((a&15)==0){a>>=4;b+=4}if((a&3)==0){a>>=2;b+=2}if((a&1)==0){++b}return b}function bnGetLowestSetBit(){for(var a=0;a<this.t;++a){if(this[a]!=0){return a*this.DB+lbit(this[a])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(a){var b=0;while(a!=0){a&=a-1;++b}return b}function bnBitCount(){var c=0,a=this.s&this.DM;for(var b=0;b<this.t;++b){c+=cbit(this[b]^a)}return c}function bnTestBit(b){var a=Math.floor(b/this.DB);if(a>=this.t){return(this.s!=0)}return((this[a]&(1<<(b%this.DB)))!=0)}function bnpChangeBit(c,b){var a=BigInteger.ONE.shiftLeft(c);this.bitwiseTo(a,b,a);return a}function bnSetBit(a){return this.changeBit(a,op_or)}function bnClearBit(a){return this.changeBit(a,op_andnot)}function bnFlipBit(a){return this.changeBit(a,op_xor)}function bnpAddTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]+d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g+=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g+=d[e];f[e++]=g&this.DM;g>>=this.DB}g+=d.s}f.s=(g<0)?-1:0;if(g>0){f[e++]=g}else{if(g<-1){f[e++]=this.DV+g}}f.t=e;f.clamp()}function bnAdd(b){var c=nbi();this.addTo(b,c);return c}function bnSubtract(b){var c=nbi();this.subTo(b,c);return c}function bnMultiply(b){var c=nbi();this.multiplyTo(b,c);return c}function bnDivide(b){var c=nbi();this.divRemTo(b,c,null);return c}function bnRemainder(b){var c=nbi();this.divRemTo(b,null,c);return c}function bnDivideAndRemainder(b){var d=nbi(),c=nbi();this.divRemTo(b,d,c);return new Array(d,c)}function bnpDMultiply(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(b,a){while(this.t<=a){this[this.t++]=0}this[a]+=b;while(this[a]>=this.DV){this[a]-=this.DV;if(++a>=this.t){this[this.t++]=0}++this[a]}}function NullExp(){}function nNop(a){return a}function nMulTo(a,c,b){a.multiplyTo(c,b)}function nSqrTo(a,b){a.squareTo(b)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(a){return this.exp(a,new NullExp())}function bnpMultiplyLowerTo(b,f,e){var d=Math.min(this.t+b.t,f);e.s=0;e.t=d;while(d>0){e[--d]=0}var c;for(c=e.t-this.t;d<c;++d){e[d+this.t]=this.am(0,b[d],e,d,0,this.t)}for(c=Math.min(b.t,f);d<c;++d){this.am(0,b[d],e,d,0,f-d)}e.clamp()}function bnpMultiplyUpperTo(b,e,d){--e;var c=d.t=this.t+b.t-e;d.s=0;while(--c>=0){d[c]=0}for(c=Math.max(e-this.t,0);c<b.t;++c){d[this.t+c-e]=this.am(e-c,b[c],d,0,0,this.t+c-e)}d.clamp();d.drShiftTo(1,d)}function Barrett(a){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}function barrettConvert(a){if(a.s<0||a.t>2*this.m.t){return a.mod(this.m)}else{if(a.compareTo(this.m)<0){return a}else{var b=nbi();a.copyTo(b);this.reduce(b);return b}}}function barrettRevert(a){return a}function barrettReduce(a){a.drShiftTo(this.m.t-1,this.r2);if(a.t>this.m.t+1){a.t=this.m.t+1;a.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(a.compareTo(this.r2)<0){a.dAddOffset(1,this.m.t+1)}a.subTo(this.r2,a);while(a.compareTo(this.m)>=0){a.subTo(this.m,a)}}function barrettSqrTo(a,b){a.squareTo(b);this.reduce(b)}function barrettMulTo(a,c,b){a.multiplyTo(c,b);this.reduce(b)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(q,f){var o=q.bitLength(),h,b=nbv(1),v;if(o<=0){return b}else{if(o<18){h=1}else{if(o<48){h=3}else{if(o<144){h=4}else{if(o<768){h=5}else{h=6}}}}}if(o<8){v=new Classic(f)}else{if(f.isEven()){v=new Barrett(f)}else{v=new Montgomery(f)}}var p=new Array(),d=3,s=h-1,a=(1<<h)-1;p[1]=v.convert(this);if(h>1){var A=nbi();v.sqrTo(p[1],A);while(d<=a){p[d]=nbi();v.mulTo(A,p[d-2],p[d]);d+=2}}var l=q.t-1,x,u=true,c=nbi(),y;o=nbits(q[l])-1;while(l>=0){if(o>=s){x=(q[l]>>(o-s))&a}else{x=(q[l]&((1<<(o+1))-1))<<(s-o);if(l>0){x|=q[l-1]>>(this.DB+o-s)}}d=h;while((x&1)==0){x>>=1;--d}if((o-=d)<0){o+=this.DB;--l}if(u){p[x].copyTo(b);u=false}else{while(d>1){v.sqrTo(b,c);v.sqrTo(c,b);d-=2}if(d>0){v.sqrTo(b,c)}else{y=b;b=c;c=y}v.mulTo(c,p[x],b)}while(l>=0&&(q[l]&(1<<o))==0){v.sqrTo(b,c);y=b;b=c;c=y;if(--o<0){o=this.DB-1;--l}}}return v.revert(b)}function bnGCD(c){var b=(this.s<0)?this.negate():this.clone();var h=(c.s<0)?c.negate():c.clone();if(b.compareTo(h)<0){var e=b;b=h;h=e}var d=b.getLowestSetBit(),f=h.getLowestSetBit();if(f<0){return b}if(d<f){f=d}if(f>0){b.rShiftTo(f,b);h.rShiftTo(f,h)}while(b.signum()>0){if((d=b.getLowestSetBit())>0){b.rShiftTo(d,b)}if((d=h.getLowestSetBit())>0){h.rShiftTo(d,h)}if(b.compareTo(h)>=0){b.subTo(h,b);b.rShiftTo(1,b)}else{h.subTo(b,h);h.rShiftTo(1,h)}}if(f>0){h.lShiftTo(f,h)}return h}function bnpModInt(e){if(e<=0){return 0}var c=this.DV%e,b=(this.s<0)?e-1:0;if(this.t>0){if(c==0){b=this[0]%e}else{for(var a=this.t-1;a>=0;--a){b=(c*b+this[a])%e}}}return b}function bnModInverse(f){var k=f.isEven();if((this.isEven()&&k)||f.signum()==0){return BigInteger.ZERO}var j=f.clone(),h=this.clone();var g=nbv(1),e=nbv(0),n=nbv(0),l=nbv(1);while(j.signum()!=0){while(j.isEven()){j.rShiftTo(1,j);if(k){if(!g.isEven()||!e.isEven()){g.addTo(this,g);e.subTo(f,e)}g.rShiftTo(1,g)}else{if(!e.isEven()){e.subTo(f,e)}}e.rShiftTo(1,e)}while(h.isEven()){h.rShiftTo(1,h);if(k){if(!n.isEven()||!l.isEven()){n.addTo(this,n);l.subTo(f,l)}n.rShiftTo(1,n)}else{if(!l.isEven()){l.subTo(f,l)}}l.rShiftTo(1,l)}if(j.compareTo(h)>=0){j.subTo(h,j);if(k){g.subTo(n,g)}e.subTo(l,e)}else{h.subTo(j,h);if(k){n.subTo(g,n)}l.subTo(e,l)}}if(h.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(l.compareTo(f)>=0){return l.subtract(f)}if(l.signum()<0){l.addTo(f,l)}else{return l}if(l.signum()<0){return l.add(f)}else{return l}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var d,b=this.abs();if(b.t==1&&b[0]<=lowprimes[lowprimes.length-1]){for(d=0;d<lowprimes.length;++d){if(b[0]==lowprimes[d]){return true}}return false}if(b.isEven()){return false}d=1;while(d<lowprimes.length){var a=lowprimes[d],c=d+1;while(c<lowprimes.length&&a<lplim){a*=lowprimes[c++]}a=b.modInt(a);while(d<c){if(a%lowprimes[d++]==0){return false}}}return b.millerRabin(e)}function bnpMillerRabin(f){var g=this.subtract(BigInteger.ONE);var c=g.getLowestSetBit();if(c<=0){return false}var h=g.shiftRight(c);f=(f+1)>>1;if(f>lowprimes.length){f=lowprimes.length}var b=nbi();for(var e=0;e<f;++e){b.fromInt(lowprimes[e]);var l=b.modPow(h,this);if(l.compareTo(BigInteger.ONE)!=0&&l.compareTo(g)!=0){var d=1;while(d++<c&&l.compareTo(g)!=0){l=l.modPowInt(2,this);if(l.compareTo(BigInteger.ONE)==0){return false}}if(l.compareTo(g)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;var RSAPublicKey=function(b,a){this.modulus=new BigInteger(Hex.encode(b),16);this.encryptionExponent=new BigInteger(Hex.encode(a),16)};var UTF8={encode:function(d){d=d.replace(/\r\n/g,"\n");var c="";for(var b=0;b<d.length;b++){var a=d.charCodeAt(b);if(a<128){c+=String.fromCharCode(a)}else{if((a>127)&&(a<2048)){c+=String.fromCharCode((a>>6)|192);c+=String.fromCharCode((a&63)|128)}else{c+=String.fromCharCode((a>>12)|224);c+=String.fromCharCode(((a>>6)&63)|128);c+=String.fromCharCode((a&63)|128)}}}return c},decode:function(d){var b="";var c=0;var a=$c1=$c2=0;while(c<d.length){a=d.charCodeAt(c);if(a<128){b+=String.fromCharCode(a);c++}else{if((a>191)&&(a<224)){$c2=d.charCodeAt(c+1);b+=String.fromCharCode(((a&31)<<6)|($c2&63));c+=2}else{$c2=d.charCodeAt(c+1);$c3=d.charCodeAt(c+2);b+=String.fromCharCode(((a&15)<<12)|(($c2&63)<<6)|($c3&63));c+=3}}}return b}};var Base64={base64:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(b){if(!b){return false}var d="";var j,f,c;var h,g,e,a;var k=0;do{j=b.charCodeAt(k++);f=b.charCodeAt(k++);c=b.charCodeAt(k++);h=j>>2;g=((j&3)<<4)|(f>>4);e=((f&15)<<2)|(c>>6);a=c&63;if(isNaN(f)){e=a=64}else{if(isNaN(c)){a=64}}d+=this.base64.charAt(h)+this.base64.charAt(g)+this.base64.charAt(e)+this.base64.charAt(a)}while(k<b.length);return d},decode:function(g){if(!g){return false}g=g.replace(/[^A-Za-z0-9\+\/\=]/g,"");var d="";var e,c,b,a;var f=0;do{e=this.base64.indexOf(g.charAt(f++));c=this.base64.indexOf(g.charAt(f++));b=this.base64.indexOf(g.charAt(f++));a=this.base64.indexOf(g.charAt(f++));d+=String.fromCharCode((e<<2)|(c>>4));if(b!=64){d+=String.fromCharCode(((c&15)<<4)|(b>>2))}if(a!=64){d+=String.fromCharCode(((b&3)<<6)|a)}}while(f<g.length);return d}};var Hex={hex:"0123456789abcdef",encode:function(d){if(!d){return false}var a="";var b;var c=0;do{b=d.charCodeAt(c++);a+=this.hex.charAt((b>>4)&15)+this.hex.charAt(b&15)}while(c<d.length);return a},decode:function(c){if(!c){return false}c=c.replace(/[^0-9abcdef]/g,"");var a="";var b=0;do{a+=String.fromCharCode(((this.hex.indexOf(c.charAt(b++))<<4)&240)|(this.hex.indexOf(c.charAt(b++))&15))}while(b<c.length);return a}};var ASN1Data=function(a){this.error=false;this.parse=function(d){if(!d){this.error=true;return null}var c=[];while(d.length>0){var b=d.charCodeAt(0);d=d.substr(1);var g=0;if((b&31)==5){d=d.substr(1)}else{if(d.charCodeAt(0)&128){var f=d.charCodeAt(0)&127;d=d.substr(1);if(f>0){g=d.charCodeAt(0)}if(f>1){g=((g<<8)|d.charCodeAt(1))}if(f>2){this.error=true;return null}d=d.substr(f)}else{g=d.charCodeAt(0);d=d.substr(1)}}var e="";if(g){if(g>d.length){this.error=true;return null}e=d.substr(0,g);d=d.substr(g)}if(b&32){c.push(this.parse(e))}else{c.push(this.value((b&128)?4:(b&31),e))}}return c};this.value=function(f,e){if(f==1){return e?true:false}else{if(f==2){return e}else{if(f==3){return this.parse(e.substr(1))}else{if(f==5){return null}else{if(f==6){var c=[];var l=e.charCodeAt(0);c.push(Math.floor(l/40));c.push(l-c[0]*40);var g=[];var h=0;var k;for(k=1;k<e.length;k++){var d=e.charCodeAt(k);g.push(d&127);if(d&128){h++}else{var j;var b=0;for(j=0;j<g.length;j++){b+=g[j]*Math.pow(128,h--)}c.push(b);h=0;g=[]}}return c.join(".")}}}}}return null};this.data=this.parse(a)};var RSA={getPublicKey:function(a){if(a.length<50){return false}if(a.substr(0,26)=="-----BEGIN PUBLIC KEY-----"){a=a.substr(26)}if(a.substr(a.length-24)=="-----END PUBLIC KEY-----"){a=a.substr(0,a.length-24)}a=new ASN1Data(Base64.decode(a));if(a.error){return false}a=a.data;if(a[0][0][0]=="1.2.840.113549.1.1.1"){return new RSAPublicKey(a[0][1][0][0],a[0][1][0][1])}return false},encrypt:function(b,c){if(!c){return false}var a=(c.modulus.bitLength()+7)>>3;b=this.pkcs1pad2(b,a);if(!b){return false}b=b.modPowInt(c.encryptionExponent,c.modulus);if(!b){return false}b=b.toString(16);while(b.length<a*2){b="0"+b}return Base64.encode(Hex.decode(b))},pkcs1pad2:function(a,c){if(c<a.length+11){return null}var b=[];var d=a.length-1;while(d>=0&&c>0){b[--c]=a.charCodeAt(d--)}b[--c]=0;while(c>2){b[--c]=Math.floor(Math.random()*254)+1}b[--c]=2;b[--c]=0;return new BigInteger(b)}};function sha1(h){var o=[1518500249,1859775393,2400959708,3395469782];h+=String.fromCharCode(128);var B=Math.ceil(h.length/4)+2;var k=Math.ceil(B/16);var n=new Array(k);for(var D=0;D<k;D++){n[D]=new Array(16);for(var C=0;C<16;C++){n[D][C]=(h.charCodeAt(D*64+C*4)<<24)|(h.charCodeAt(D*64+C*4+1)<<16)|(h.charCodeAt(D*64+C*4+2)<<8)|(h.charCodeAt(D*64+C*4+3))}}n[k-1][14]=((h.length-1)*8)/Math.pow(2,32);n[k-1][14]=Math.floor(n[k-1][14]);n[k-1][15]=((h.length-1)*8)&4294967295;var y=1732584193;var u=4023233417;var r=2562383102;var q=271733878;var p=3285377520;var f=new Array(80);var I,H,G,F,E;for(var D=0;D<k;D++){for(var z=0;z<16;z++){f[z]=n[D][z]}for(var z=16;z<80;z++){f[z]=f[z-3]^f[z-8]^f[z-14]^f[z-16];f[z]=(f[z]<<1)|(f[z]>>>31)}I=y;H=u;G=r;F=q;E=p;for(var z=0;z<80;z++){var A=Math.floor(z/20);var g=((I<<5)|(I>>>27))+E+o[A]+f[z];switch(A){case 0:g+=(H&G)^(~H&F);break;case 1:g+=H^G^F;break;case 2:g+=(H&G)^(H&F)^(G&F);break;case 3:g+=H^G^F;break}E=F;F=G;G=(H<<30)|(H>>>2);H=I;I=g}y=(y+I)&4294967295;u=(u+H)&4294967295;r=(r+G)&4294967295;q=(q+F)&4294967295;p=(p+E)&4294967295}var m="";for(var D=7;D>=0;D--){var x=(y>>>(D*4))&15;m+=x.toString(16)}for(var D=7;D>=0;D--){var x=(u>>>(D*4))&15;m+=x.toString(16)}for(var D=7;D>=0;D--){var x=(r>>>(D*4))&15;m+=x.toString(16)}for(var D=7;D>=0;D--){var x=(q>>>(D*4))&15;m+=x.toString(16)}for(var D=7;D>=0;D--){var x=(p>>>(D*4))&15;m+=x.toString(16)}return m}Ext.define("OPF.core.component.utils.ui.InputTextMask",{constructor:function(a,d){if(d===undefined){this.clearWhenInvalid=true}else{this.clearWhenInvalid=d}this.rawMask=a;this.viewMask="";this.maskArray=new Array();var c=0;var e="";for(var b=0;b<a.length;b++){if(e){if(e=="X"){e=""}if(a.charAt(b)=="X"){this.maskArray[c]=e;c++;e=""}else{e+=a.charAt(b)}}else{if(a.charAt(b)=="X"){e+="X";this.viewMask+="_"}else{if(a.charAt(b)=="9"||a.charAt(b)=="L"||a.charAt(b)=="l"||a.charAt(b)=="A"){this.viewMask+="_";this.maskArray[c]=a.charAt(b);c++}else{this.viewMask+=a.charAt(b);this.maskArray[c]=RegExp.escape(a.charAt(b));c++}}}}this.specialChars=this.viewMask.replace(/(L|l|9|A|_|X)/g,"");return this},init:function(a){this.field=a;if(a.rendered){this.assignEl()}else{a.on("render",this.assignEl,this)}a.on("blur",this.removeValueWhenInvalid,this);a.on("focus",this.processMaskFocus,this)},assignEl:function(){this.inputTextElement=this.field.inputEl.dom;this.field.inputEl.on("keypress",this.processKeyPress,this);this.field.inputEl.on("keydown",this.processKeyDown,this);if(Ext.isSafari||Ext.isIE){this.field.inputEl.on("paste",this.startTask,this);this.field.inputEl.on("cut",this.startTask,this)}if(Ext.isGecko||Ext.isOpera){this.field.inputEl.on("mousedown",this.setPreviousValue,this)}if(Ext.isGecko){this.field.inputEl.on("input",this.onInput,this)}if(Ext.isOpera){this.field.inputEl.on("input",this.onInputOpera,this)}},onInput:function(){this.startTask(false)},onInputOpera:function(){if(!this.prevValueOpera){this.startTask(false)}else{this.manageBackspaceAndDeleteOpera()}},manageBackspaceAndDeleteOpera:function(){this.inputTextElement.value=this.prevValueOpera.cursorPos.previousValue;this.manageTheText(this.prevValueOpera.keycode,this.prevValueOpera.cursorPos);this.prevValueOpera=null},setPreviousValue:function(a){this.oldCursorPos=this.getCursorPosition()},getValidatedKey:function(b,a){var c=this.maskArray[a.start];if(c=="9"){return b.pressedKey.match(/[0-9]/)}else{if(c=="L"){return(b.pressedKey.match(/[A-Za-z]/))?b.pressedKey.toUpperCase():null}else{if(c=="l"){return(b.pressedKey.match(/[A-Za-z]/))?b.pressedKey.toLowerCase():null}else{if(c=="A"){return b.pressedKey.match(/[A-Za-z0-9]/)}else{if(c){return(b.pressedKey.match(new RegExp(c)))}}}}}return(null)},removeValueWhenInvalid:function(){if(this.clearWhenInvalid&&this.inputTextElement.value.indexOf("_")>-1){this.inputTextElement.value=""}},managePaste:function(){if(this.oldCursorPos==null){return}var c=this.inputTextElement.value.substring(this.oldCursorPos.start,this.inputTextElement.value.length-(this.oldCursorPos.previousValue.length-this.oldCursorPos.end));if(this.oldCursorPos.start<this.oldCursorPos.end){this.oldCursorPos.previousValue=this.oldCursorPos.previousValue.substring(0,this.oldCursorPos.start)+this.viewMask.substring(this.oldCursorPos.start,this.oldCursorPos.end)+this.oldCursorPos.previousValue.substring(this.oldCursorPos.end,this.oldCursorPos.previousValue.length);c=c.substr(0,this.oldCursorPos.end-this.oldCursorPos.start)}this.inputTextElement.value=this.oldCursorPos.previousValue;keycode={unicode:"",isShiftPressed:false,isTab:false,isBackspace:false,isLeftOrRightArrow:false,isDelete:false,pressedKey:""};var b=false;for(var a=0;a<c.length;a++){keycode.pressedKey=c.substr(a,1);keycode.unicode=c.charCodeAt(a);this.oldCursorPos=this.skipMaskCharacters(keycode,this.oldCursorPos);if(this.oldCursorPos===false){break}if(this.injectValue(keycode,this.oldCursorPos)){b=true;this.moveCursorToPosition(keycode,this.oldCursorPos);this.oldCursorPos.previousValue=this.inputTextElement.value;this.oldCursorPos.start=this.oldCursorPos.start+1}}if(!b&&this.oldCursorPos!==false){this.moveCursorToPosition(null,this.oldCursorPos)}this.oldCursorPos=null},processKeyDown:function(a){this.processMaskFormatting(a,"keydown")},processKeyPress:function(a){this.processMaskFormatting(a,"keypress")},startTask:function(a){if(this.task==undefined){this.task=new Ext.util.DelayedTask(this.managePaste,this)}if(a!==false){this.oldCursorPos=this.getCursorPosition()}this.task.delay(0)},skipMaskCharacters:function(a,b){if(b.start!=b.end&&(a.isDelete||a.isBackspace)){return(b)}while(this.specialChars.match(RegExp.escape(this.viewMask.charAt(((a.isBackspace)?b.start-1:b.start))))){if(a.isBackspace){b.dec()}else{b.inc()}if(b.start>=b.previousValue.length||b.start<0){return false}}return(b)},isManagedByKeyDown:function(a){if(a.isDelete||a.isBackspace){return(true)}return(false)},processMaskFormatting:function(c,b){this.oldCursorPos=null;var d=this.getCursorPosition();var a=this.getKeyCode(c,b);if(a.unicode==0){return}if((a.unicode==67||a.unicode==99)&&c.ctrlKey){return}if((a.unicode==88||a.unicode==120)&&c.ctrlKey){this.startTask();return}if((a.unicode==86||a.unicode==118)&&c.ctrlKey){this.startTask();return}if((a.isBackspace||a.isDelete)&&Ext.isOpera){this.prevValueOpera={cursorPos:d,keycode:a};return}if(b=="keydown"&&!this.isManagedByKeyDown(a)){return true}if(b=="keypress"&&this.isManagedByKeyDown(a)){return true}if(this.handleEventBubble(c,a,b)){return true}return(this.manageTheText(a,d))},manageTheText:function(a,b){if(this.inputTextElement.value.length===0){this.inputTextElement.value=this.viewMask}b=this.skipMaskCharacters(a,b);if(b===false){return false}if(this.injectValue(a,b)){this.moveCursorToPosition(a,b)}return(false)},processMaskFocus:function(){if(this.inputTextElement.value.length==0){var a=this.getCursorPosition();this.inputTextElement.value=this.viewMask;this.moveCursorToPosition(null,a)}},isManagedByBrowser:function(c,a,b){if(((b=="keypress"&&c.charCode===0)||b=="keydown")&&(a.unicode==Ext.EventObject.TAB||a.unicode==Ext.EventObject.RETURN||a.unicode==Ext.EventObject.ENTER||a.unicode==Ext.EventObject.SHIFT||a.unicode==Ext.EventObject.CONTROL||a.unicode==Ext.EventObject.ESC||a.unicode==Ext.EventObject.PAGEUP||a.unicode==Ext.EventObject.PAGEDOWN||a.unicode==Ext.EventObject.END||a.unicode==Ext.EventObject.HOME||a.unicode==Ext.EventObject.LEFT||a.unicode==Ext.EventObject.UP||a.unicode==Ext.EventObject.RIGHT||a.unicode==Ext.EventObject.DOWN)){return(true)}return(false)},handleEventBubble:function(c,a,b){try{if(a&&this.isManagedByBrowser(c,a,b)){return true}c.stopEvent();return false}catch(d){alert(d.message)}},getCursorPosition:function(){var a,c,b;if(this.inputTextElement.createTextRange){b=document.selection.createRange().duplicate();b.moveEnd("character",this.inputTextElement.value.length);if(b.text===""){a=this.inputTextElement.value.length}else{a=this.inputTextElement.value.lastIndexOf(b.text)}b=document.selection.createRange().duplicate();b.moveStart("character",-this.inputTextElement.value.length);c=b.text.length}else{a=this.inputTextElement.selectionStart;c=this.inputTextElement.selectionEnd}return this.CursorPosition(a,c,b,this.inputTextElement.value)},moveCursorToPosition:function(b,a){var c=(!b||(b&&b.isBackspace))?a.start:a.start+1;if(this.inputTextElement.createTextRange){a.range.move("character",c);a.range.select()}else{this.inputTextElement.selectionStart=c;this.inputTextElement.selectionEnd=c}},injectValue:function(b,a){if(!b.isDelete&&b.unicode==a.previousValue.charCodeAt(a.start)){return true}var c;if(!b.isDelete&&!b.isBackspace){c=this.getValidatedKey(b,a)}else{if(a.start==a.end){c="_";if(b.isBackspace){a.dec()}}else{c=this.viewMask.substring(a.start,a.end)}}if(c){this.inputTextElement.value=a.previousValue.substring(0,a.start)+c+a.previousValue.substring(a.start+c.length,a.previousValue.length);return true}return false},getKeyCode:function(b,c){var a={};a.unicode=b.getKey();a.isShiftPressed=b.shiftKey;a.isDelete=((b.getKey()==Ext.EventObject.DELETE&&c=="keydown")||(c=="keypress"&&b.charCode===0&&b.keyCode==Ext.EventObject.DELETE))?true:false;a.isTab=(b.getKey()==Ext.EventObject.TAB)?true:false;a.isBackspace=(b.getKey()==Ext.EventObject.BACKSPACE)?true:false;a.isLeftOrRightArrow=(b.getKey()==Ext.EventObject.LEFT||b.getKey()==Ext.EventObject.RIGHT)?true:false;a.pressedKey=String.fromCharCode(a.unicode);return(a)},CursorPosition:function(e,c,d,b){var a={};a.start=isNaN(e)?0:e;a.end=isNaN(c)?0:c;a.range=d;a.previousValue=b;a.inc=function(){a.start++;a.end++};a.dec=function(){a.start--;a.end--};return(a)}});Ext.applyIf(RegExp,{escape:function(a){return new String(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}});Ext.define("OPF.Ui",{});OPF.Ui.createBtn=function(d,b,c,a){a=a||{};return Ext.create("Ext.button.Button",Ext.apply({text:d,width:b,action:c},a))};OPF.Ui.createMenu=function(c,b,a){a=a||{};return Ext.create("Ext.menu.Item",Ext.apply({cls:"main-controls-menu",text:c,action:b},a))};OPF.Ui.createToggleButton=function(d,b,c,a){a=a||{};return Ext.create("Ext.button.Button",Ext.apply({text:d,enableToggle:true,toggleGroup:b,action:c},a))};OPF.Ui.xSpacer=function(b,a){a=a||{};return Ext.create("Ext.toolbar.Spacer",Ext.apply({width:b},a))};OPF.Ui.ySpacer=function(a,b){b=b||{};return Ext.create("Ext.toolbar.Spacer",Ext.apply({height:a},b))};OPF.Ui.spacer=function(c,a,b){b=b||{};return Ext.create("Ext.toolbar.Spacer",Ext.apply({width:c,height:a},b))};OPF.Ui.populateColumn=function(b,c,a){a=a||{};return Ext.create("Ext.grid.column.Column",Ext.apply({dataIndex:b,text:c,sortable:true},a))};OPF.Ui.populateHiddenColumn=function(b,a){a=a||{};return Ext.create("Ext.grid.column.Column",Ext.apply({dataIndex:b,hidden:true},a))};OPF.Ui.populateNumberColumn=function(b,d,c,a){a=a||{};return Ext.create("Ext.grid.column.Number",Ext.apply({dataIndex:b,text:d,sortable:true,width:c},a))};OPF.Ui.populateBooleanColumn=function(b,c,a){a=a||{};return Ext.create("Ext.grid.column.Boolean",Ext.apply({dataIndex:b,text:c,sortable:true},a))};OPF.Ui.populateCheckBoxColumn=function(b,d,c,a){a=a||{};return Ext.create("Ext.ux.CheckColumn",Ext.apply({text:d,dataIndex:b,width:c},a))};OPF.Ui.populateDateColumn=function(b,d,c,a){a=a||{};return Ext.create("Ext.grid.column.Date",Ext.apply({dataIndex:b,text:d,sortable:true,width:c,format:"M j, Y g:i A"},a))};OPF.Ui.populateIconColumn16=function(b,c,a){a=a||{};return Ext.create("Ext.grid.column.Column",Ext.apply({text:"!",sortable:true,align:"center",width:b,renderer:function(){return'<img src="'+OPF.Ui.icon16(c)+'">'}},a))};OPF.Ui.populateActionColumn=function(d,c,b,a){a=a||{};b=Ext.isArray(b)?b:[];return Ext.create("OPF.core.component.ActionColumn",Ext.apply({text:d,sortable:false,width:c,items:b},a))};OPF.Ui.createActionColumnBtn=function(b,d,c,a){a=a||{};return Ext.apply({icon:OPF.Cfg.OPF_CONSOLE_URL+b,tooltip:d,handler:c,visible:true},a)};OPF.Ui.createActionColumnBtn16=function(c,d,b,a){a=a||{};return Ext.apply({icon:OPF.Ui.icon16(c),tooltip:d,handler:b,visible:true},a)};OPF.Ui.createGridBtn=function(d,e,b,c,a){return new Ext.Button(Ext.apply({id:"btn-"+e,renderTo:e,text:d,icon:OPF.Ui.icon16(c),cls:"grid-btn"},a))};OPF.Ui.textFormField=function(c,b,a){a=a||{};return Ext.ComponentManager.create(Ext.apply({xtype:"opf-textfield",name:c,anchor:"100%",fieldLabel:b},a))};OPF.Ui.comboFormField=function(c,b,a){a=a||{};return Ext.ComponentManager.create(Ext.apply({xtype:"opf-combo",name:c,fieldLabel:b,anchor:"100%"},a))};OPF.Ui.textFormArea=function(c,b,a){a=a||{};return Ext.ComponentManager.create(Ext.apply({xtype:"opf-textarea",name:c,anchor:"100%",fieldLabel:b},a))};OPF.Ui.formCheckBox=function(c,b,a){a=a||{};return Ext.ComponentManager.create(Ext.apply({xtype:"opf-checkbox",name:c,fieldLabel:b,anchor:"100%"},a))};OPF.Ui.displayField=function(c,b,a){a=a||{};return Ext.create("OPF.core.component.Display",Ext.apply({name:c,fieldLabel:b,anchor:"100%"},a))};OPF.Ui.formDate=function(c,b,a){a=a||{};return Ext.create("Ext.form.field.Date",Ext.apply({name:c,fieldLabel:b,anchor:"100%"},a))};OPF.Ui.hiddenField=function(b,a){a=a||{};return Ext.create("Ext.form.field.Hidden",Ext.apply({name:b},a))};OPF.Ui.getCmp=function(b){var a=Ext.ComponentQuery.query(b);return a==null||!Ext.isArray(a)||a.length==0?null:a[0]};OPF.Ui.icon128=function(a){return OPF.Cfg.OPF_CONSOLE_URL+"/images/icons/128/"+a};OPF.Ui.icon16=function(a){return OPF.Cfg.OPF_CONSOLE_URL+"/images/icons/16/"+a};Ext.define("OPF.core.validation.FormValidator",{form:null,ruleId:null,messagePanel:null,suffixFieldName:null,findById:false,clearInvalidOnly:true,statics:{RULE_CACHE:new Ext.util.MixedCollection()},constructor:function(d,c,b,a){a=a||{};this.form=d;this.ruleId=c;this.messagePanel=b;this.suffixFieldName=OPF.ifEmpty(a.suffixFieldName,this.suffixFieldName);this.findById=OPF.ifEmpty(a.findById,this.findById);this.clearInvalidOnly=OPF.ifEmpty(a.clearInvalidOnly,this.clearInvalidOnly);this.useBaseUrl=OPF.ifEmpty(a.useBaseUrl,true);this.initConstraints()},initConstraints:function(){var b=this;var a=OPF.core.validation.FormValidator.RULE_CACHE.get(this.ruleId);if(a){this.initFormFields(a)}else{Ext.Ajax.request({url:OPF.Cfg.restUrl("rule",this.useBaseUrl)+"?id="+this.ruleId,method:"GET",success:function(d){var c=Ext.decode(d.responseText).data;OPF.core.validation.FormValidator.RULE_CACHE.add(b.ruleId,c);b.initFormFields(c)},failure:function(c){OPF.Msg.setAlert(false,c.message)}})}},initFormFields:function(b){var e=this;if(OPF.isEmpty(this.form)){return}var a=this.form.getForm().getFields();var d;for(var c=0;c<b.length;c++){var h=b[c];var f=h.name+OPF.ifBlank(this.suffixFieldName,"");var g=null;if(this.findById){g=Ext.getCmp(f)}else{if(OPF.isNotEmpty(this.mtype)){g=a.findBy(function(j){return(j.getId()===f||j.getName()===f)&&j.mtype==this.mtype})}else{g=a.findBy(function(j){return j.getId()===f||j.getName()===f})}}if(g!=null){g.vConstraints=h.constraints;this.setComboValues(g);this.setDefaultValue(h,g);this.setEditableMode(h,g);g.validator=function(k){var l=this;var m=[];var n;if(OPF.isNotEmpty(l.vConstraints)){for(var j=0;j<l.vConstraints.length;j++){n=e.validatorProcess(l,l.vConstraints[j],k);Ext.each(n,function(o){if(OPF.isNotBlank(l.fieldOrgLabel)){o=o.replace("'"+l.name+"'",l.fieldOrgLabel)}else{if(OPF.isNotBlank(l.fieldLabel)){o=o.replace("'"+l.name+"'",l.fieldLabel)}}m.push(o)})}}return m}}}this.form.getForm().checkValidity()},setComboValues:function(h){if(h.xtype=="opf-form-combo"||h.xtype=="opf-combo"){if(Ext.isArray(h.vConstraints)){for(var e=0;e<h.vConstraints.length;e++){var d=h.vConstraints[e];if(d.name=="EnumValue"||d.name=="QueryValues"||d.name=="AllowValue"){var b=[h.valueField,h.displayField];if(this.getParameterByKey(d.params,"hasDescription")){h.displayField="title";b=[h.valueField,h.displayField,"description"];h.listConfig={cls:"x-wizards-boundlist",getInnerTpl:function(){return'<div class="enum-item"><h3>{title}</h3>{description}</div>'}}}if(d.name=="EnumValue"||d.name=="AllowValue"){var g=[];var c=this.getParameterByKey(d.params,"values");if(d.name=="AllowValue"){Ext.each(c,function(j){g.push([j,j])})}else{g=c}h.typeAhead=true;h.triggerAction="all";h.lazyRender=true;h.mode="local";h.store=Ext.create("Ext.data.ArrayStore",{autoDestroy:true,idIndex:0,fields:b,data:g})}else{if(d.name=="QueryValues"){h.typeAhead=OPF.ifEmpty(h.typeAhead,true);h.triggerAction=OPF.ifBlank(h.triggerAction,"all");h.lazyRender=OPF.ifEmpty(h.lazyRender,true);if(OPF.isEmpty(h.mode)){h.mode="local"}if(h.store==null){h.store=new Ext.data.ArrayStore({id:0,fields:b,data:this.getParameterByKey(d.params,"values")})}else{var a=Ext.data.Record.create([h.valueField,h.displayField]);var f=this.getParameterByKey(d.params,"values");Ext.each(f,function(k,j){h.store.add(new a({id:k[0],name:k[1]},k[0]))})}}}if(OPF.isNotBlank(h.getValue())){h.setValue(h.getValue())}}}}}},setDefaultValue:function(a,b){if(OPF.isNotEmpty(a.defaultValue)&&OPF.isBlank(b.getValue())){if(b.setDefaultValue){b.setDefaultValue(a.defaultValue)}else{b.setValue(a.defaultValue)}}},setEditableMode:function(a,b){if(OPF.isNotEmpty(a.editable)){b.setReadOnly(!a.editable)}},validatorProcess:function(g,b,j){if(OPF.isEmpty(b)){return null}var h=[];var a=b.name;var f=b.errorMessage;var d=b.params;switch(a){case"NotNull":var e=g.notNullValidatorProcessor||this.notNullValidatorProcessor;e(g,j,d,f,h);break;case"NotBlank":var c=g.notBlankValidatorProcessor||this.notBlankValidatorProcessor;c(g,j,d,f,h);break;case"Match":this.matchValidatorProcessor(g,j,d,f,h);break;case"NotMatch":this.notMatchValidatorProcessor(g,j,d,f,h);break;case"Length":this.lengthValidatorProcessor(g,j,d,f,h);break;case"LessThan":this.lessThanValidatorProcessor(g,j,d,f,h);break}return h},notNullValidatorProcessor:function(c,b,e,a,f){if(!OPF.isNotEmpty(b)){var d=OPF.isNotBlank(a)?a:"'"+c.getName()+"' should not be null";f.push(d)}},notBlankValidatorProcessor:function(c,b,e,a,f){if(!OPF.isNotBlank(b)||b.replace(/\s/g,"")==""){var d=OPF.isNotBlank(a)?a:"'"+c.getName()+"' should not be blank";f.push(d)}},matchValidatorProcessor:function(d,c,g,a,h){var f=this.getParameterByKey(g,"expression");if(OPF.isNotEmpty(f)&&OPF.isNotBlank(c)){var b=new RegExp(f,"g");if(!b.test(c)){var e=OPF.isNotBlank(a)?a:"'"+d.getName()+"' should match to regexp: ["+f+"]";h.push(e)}}},notMatchValidatorProcessor:function(h,k,b,d,j){var e=this.getParameterByKey(b,"expression");if(OPF.isNotEmpty(e)&&OPF.isNotBlank(k)){var f=new RegExp(e,"g");if(f.test(k)){var a=OPF.isNotBlank(d)?d:"'"+h.getName()+"' should not match to regexp: ["+e+"]";j.push(a)}}var g=this.getParameterByKey(b,"words");if(OPF.isNotEmpty(g)&&Ext.isArray(g)&&OPF.isNotBlank(k)){for(var c=0;c<g.length;c++){if(k==g[c]){j.push("'"+h.getName()+"' should not be equal reserved word: '"+g[c]+"'")}}}},lengthValidatorProcessor:function(f,h,b,d,g){var c=this.getParameterByKey(b,"min");var j=this.getParameterByKey(b,"minMsg");var e=this.getParameterByKey(b,"max");var k=this.getParameterByKey(b,"maxMsg");var a;if((OPF.isBlank(h)&&c>0)||(OPF.isNotBlank(h)&&h.length<c)){a=OPF.isNotBlank(j)?j:"'"+f.getName()+"' should be longer or equal then "+c+"characters";g.push(a)}if(OPF.isNotBlank(h)&&h.length>e){a=OPF.isNotBlank(k)?k:"'"+f.getName()+"' should shorter or equal then "+e+"characters";g.push(a)}},lessThanValidatorProcessor:function(e,d,g,b,h){var c=this.getParameterByKey(g,"lessThanValue");var a=this.getParameterByKey(g,"checkEquality");if(OPF.isNotEmpty(c)&&OPF.isNotBlank(d)){if((d==c&&!a)||(d>c)){var f=OPF.isNotBlank(b)?b:"'"+e.getName()+"' should less then "+(a?"or equal ":"")+c;h.push(f)}}},getParameterByKey:function(c,b){if(OPF.isNotEmpty(c)&&c.length>0){for(var a=0;a<c.length;a++){if(c[a].key==b){return c[a].value}}}return null},showValidationMessages:function(c){if(OPF.isNotEmpty(this.form)){this.form.getEl().unmask()}if(OPF.isNotEmpty(c)){var a=Ext.decode(c.responseText);if(OPF.isNotEmpty(a)&&OPF.isNotEmpty(a.data)){var d=a.data;if(OPF.isNotEmpty(this.form)){var b,j,g;for(var e=0;e<d.length;e++){b=d[e].msg;j=d[e].name;if(OPF.isNotBlank(j)){g=this.form.getForm().findField(j);if(g!=null){g.markInvalid(b)}}}}if(OPF.isEmpty(this.messagePanel)){this.messagePanel=Ext.ComponentMgr.create({xtype:"notice-container",form:this.form});this.form.insert(0,this.messagePanel)}this.messagePanel.cleanActiveErrors();if(d.length>0){var h=[];Ext.each(d,function(k){if(OPF.isNotBlank(k.msg)){h.push({level:OPF.core.validation.MessageLevel.ERROR,msg:k.msg})}});this.messagePanel.setNoticeContainer(h)}}else{if(OPF.isNotEmpty(a)&&OPF.isNotEmpty(a.success)&&!a.success&&OPF.isNotEmpty(a.message)){if(OPF.isEmpty(this.messagePanel)){this.messagePanel=Ext.ComponentMgr.create({xtype:"notice-container",form:this.form});this.form.insert(0,this.messagePanel)}this.messagePanel.cleanActiveErrors();var f=[];f.push({level:OPF.core.validation.MessageLevel.ERROR,msg:a.message});this.messagePanel.setNoticeContainer(f)}}}},hideValidationMessages:function(a){if(OPF.isNotEmpty(this.messagePanel)){this.messagePanel.cleanActiveErrors()}this.form.getEl().unmask();if(this.clearInvalidOnly===true){this.form.getForm().clearInvalid()}if(OPF.isNotEmpty(a)){var b=Ext.decode(a.responseText);if(OPF.isNotBlank(b.message)){this.messagePanel.showError(OPF.core.validation.MessageLevel.ERROR,b.message)}}}});Ext.namespace("OPF.core.validation");Ext.define("OPF.core.validation.MessageLevel",{constructor:function(c,b,a){a=a||{};OPF.core.validation.MessageLevel.superclass.constructor.call(this,a);this.level=c;this.css=b},getLevel:function(){return this.level},getCSS:function(){return this.css}});OPF.core.validation.MessageLevel.TRACE=new OPF.core.validation.MessageLevel("TRACE","msg-trace");OPF.core.validation.MessageLevel.DEBUG=new OPF.core.validation.MessageLevel("DEBUG","msg-debug");OPF.core.validation.MessageLevel.INFO=new OPF.core.validation.MessageLevel("INFO","msg-info");OPF.core.validation.MessageLevel.WARN=new OPF.core.validation.MessageLevel("WARN","msg-warn");OPF.core.validation.MessageLevel.ERROR=new OPF.core.validation.MessageLevel("ERROR","msg-error");OPF.core.validation.MessageLevel.FATAL=new OPF.core.validation.MessageLevel("FATAL","msg-fatal");Ext.apply(Ext.form.field.VTypes,{password:function(d,e){var c=false;if(e.isDisabled()&&b.isDisabled()){c=true}else{if(e.compareWithId){var b=Ext.getCmp(e.compareWithId);var a=b.getValue();if(e.updateMode&&b.updateMode&&OPF.isBlank(d)&&OPF.isBlank(a)){c=true}else{if(d==a){if(d.match(/[0-9!@#\$%\^&\*\(\)\-_=\+]+/i)){b.clearInvalid();if(d.length>=6){c=true}else{this.passwordText="Password should have length equal or longer than 6 characters.";c=false}}else{this.passwordText="Passwords must contain at least one number, or valid special character (!@#$%^&*{}-_=+)";c=false}}else{this.passwordText="The passwords entered do not match.";c=false}}}}return c},passwordText:"Passwords must contain at least one number, or valid special character (!@#$%^&*{}-_=+)"});Ext.apply(Ext.form.VTypes,{denyBlank:function(a){return OPF.isNotBlank(a)&&a.replace(/\s/g,"").length>0},denyBlankText:"Only spaces are not allowed.",denyBlankMask:/./});